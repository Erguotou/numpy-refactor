
/*
 *****************************************************************************
 **       This file was autogenerated from a template  DO NOT EDIT!!!!      **
 **       Changes should be made to the original source (.src) file         **
 *****************************************************************************
 */

/* -*- c -*- */

/* TODO: Need to fix setup to produce HAVE_LONG_LONG without including
   Python.h or wherever it was coming from. */
#define HAVE_LONG_LONG 1

#define _MULTIARRAYMODULE
#define NPY_NO_PREFIX
#include <stdlib.h>
#include <memory.h>
#include "numpy_api.h"
#include "npy_object.h"
#include "npy_arrayobject.h"
#include "numpyos.h"
#include "npy_dict.h"
#include "npy_internal.h"

#include "npy_math.h"
#include "noprefix.h"
#include "utils.h"



#define __ALIGNED(obj, sz) ((((size_t) obj) % (sz))==0)

#ifdef Npy_UNICODE_WIDE
#define NpyArray_UCS4_ISSPACE Npy_UNICODE_ISSPACE
#else
#define NpyArray_UCS4_ISSPACE(ch) Npy_STRING_ISSPACE((char)ch)
#endif


/* TODO: Delete this once numpyos is moved into the core. */
double
NumPyOS_ascii_strtod(const char *s, char** endptr);
int
NumPyOS_ascii_ftolf(FILE *fp, double *value);


static npy_bool
Npy_STRING_ISSPACE(char ch);


#define NpyArray_TYPES       NPY_TYPES
#define NpyArray_BOOL        NPY_BOOL
#define NpyArray_BYTE        NPY_BYTE
#define NpyArray_UBYTE       NPY_UBYTE
#define NpyArray_SHORT       NPY_SHORT
#define NpyArray_USHORT      NPY_USHORT
#define NpyArray_INT         NPY_INT
#define NpyArray_UINT        NPY_UINT
#define NpyArray_LONG        NPY_LONG
#define NpyArray_ULONG       NPY_ULONG
#define NpyArray_LONGLONG    NPY_LONGLONG
#define NpyArray_ULONGLONG   NPY_ULONGLONG
#define NpyArray_FLOAT       NPY_FLOAT
#define NpyArray_DOUBLE      NPY_DOUBLE
#define NpyArray_LONGDOUBLE  NPY_LONGDOUBLE
#define NpyArray_CFLOAT      NPY_CFLOAT
#define NpyArray_CDOUBLE     NPY_CDOUBLE
#define NpyArray_CLONGDOUBLE NPY_CLONGDOUBLE
#define NpyArray_OBJECT      NPY_OBJECT
#define NpyArray_STRING      NPY_STRING
#define NpyArray_UNICODE     NPY_UNICODE
#define NpyArray_VOID        NPY_VOID
#define NpyArray_DATETIME    NPY_DATETIME
#define NpyArray_TIMEDELTA   NPY_TIMEDELTA
#define NpyArray_NTYPES      NPY_NTYPES
#define NpyArray_NOTYPE      NPY_NOTYPE
#define NpyArray_CHAR        NPY_CHAR
#define NpyArray_USERDEF     NPY_USERDEF

#define NpyArray_VOID           NPY_VOID
#define NpyArray_TYPECHAR        NPY_TYPECHAR
#define NpyArray_BOOLLTR         NPY_BOOLLTR
#define NpyArray_BYTELTR         NPY_BYTELTR
#define NpyArray_UBYTELTR        NPY_UBYTELTR
#define NpyArray_SHORTLTR        NPY_SHORTLTR
#define NpyArray_USHORTLTR       NPY_USHORTLTR
#define NpyArray_INTLTR          NPY_INTLTR
#define NpyArray_UINTLTR         NPY_UINTLTR
#define NpyArray_LONGLTR         NPY_LONGLTR
#define NpyArray_ULONGLTR        NPY_ULONGLTR
#define NpyArray_LONGLONGLTR     NPY_LONGLONGLTR
#define NpyArray_ULONGLONGLTR    NPY_ULONGLONGLTR
#define NpyArray_FLOATLTR        NPY_FLOATLTR
#define NpyArray_DOUBLELTR       NPY_DOUBLELTR
#define NpyArray_LONGDOUBLELTR   NPY_LONGDOUBLELTR
#define NpyArray_CFLOATLTR       NPY_CFLOATLTR
#define NpyArray_CDOUBLELTR      NPY_CDOUBLELTR
#define NpyArray_CLONGDOUBLELTR  NPY_CLONGDOUBLELTR
#define NpyArray_OBJECTLTR       NPY_OBJECTLTR
#define NpyArray_STRINGLTR       NPY_STRINGLTR
#define NpyArray_STRINGLTR2      NPY_STRINGLTR2
#define NpyArray_UNICODELTR      NPY_UNICODELTR
#define NpyArray_VOIDLTR         NPY_VOIDLTR
#define NpyArray_DATETIMELTR     NPY_DATETIMELTR
#define NpyArray_TIMEDELTALTR    NPY_TIMEDELTALTR
#define NpyArray_CHARLTR         NPY_CHARLTR
#define NpyArray_INTPLTR         NPY_INTPLTR
#define NpyArray_UINTPLTR        NPY_UINTPLTR
#define NpyArray_GENBOOLLTR      NPY_GENBOOLLTR
#define NpyArray_SIGNEDLTR       NPY_SIGNEDLTR
#define NpyArray_UNSIGNEDLTR     NPY_UNSIGNEDLTR
#define NpyArray_FLOATINGLTR     NPY_FLOATINGLTR
#define NpyArray_COMPLEXLTR      NPY_COMPLEXLTR


/* TODO: Find a better way to handle getitem, setitem and other functions
   provided by the interface. */
/* From arraytypes.c.src */




/*
 *****************************************************************************
 **                               SCAN                                      **
 *****************************************************************************
 */


/*
 * The first ignore argument is for backwards compatibility.
 * Should be removed when the API version is bumped up.
 */

int
SHORT_scan(FILE *fp, short *ip, void *NPY_UNUSED(ignore), NpyArray_Descr *NPY_UNUSED(ignored))
{
    return fscanf(fp, "%""hd", ip);
}

int
USHORT_scan(FILE *fp, ushort *ip, void *NPY_UNUSED(ignore), NpyArray_Descr *NPY_UNUSED(ignored))
{
    return fscanf(fp, "%""hu", ip);
}

int
INT_scan(FILE *fp, int *ip, void *NPY_UNUSED(ignore), NpyArray_Descr *NPY_UNUSED(ignored))
{
    return fscanf(fp, "%""d", ip);
}

int
UINT_scan(FILE *fp, uint *ip, void *NPY_UNUSED(ignore), NpyArray_Descr *NPY_UNUSED(ignored))
{
    return fscanf(fp, "%""u", ip);
}

int
LONG_scan(FILE *fp, long *ip, void *NPY_UNUSED(ignore), NpyArray_Descr *NPY_UNUSED(ignored))
{
    return fscanf(fp, "%""ld", ip);
}

int
ULONG_scan(FILE *fp, ulong *ip, void *NPY_UNUSED(ignore), NpyArray_Descr *NPY_UNUSED(ignored))
{
    return fscanf(fp, "%""lu", ip);
}

int
LONGLONG_scan(FILE *fp, longlong *ip, void *NPY_UNUSED(ignore), NpyArray_Descr *NPY_UNUSED(ignored))
{
    return fscanf(fp, "%"LONGLONG_FMT, ip);
}

int
ULONGLONG_scan(FILE *fp, ulonglong *ip, void *NPY_UNUSED(ignore), NpyArray_Descr *NPY_UNUSED(ignored))
{
    return fscanf(fp, "%"ULONGLONG_FMT, ip);
}


int
FLOAT_scan(FILE *fp, float *ip, void *NPY_UNUSED(ignore), NpyArray_Descr *NPY_UNUSED(ignored))
{
    double result;
    int ret;

    ret = NumPyOS_ascii_ftolf(fp, &result);
    *ip = (float) result;
    return ret;
}

int
DOUBLE_scan(FILE *fp, double *ip, void *NPY_UNUSED(ignore), NpyArray_Descr *NPY_UNUSED(ignored))
{
    double result;
    int ret;

    ret = NumPyOS_ascii_ftolf(fp, &result);
    *ip = (double) result;
    return ret;
}

int
LONGDOUBLE_scan(FILE *fp, longdouble *ip, void *NPY_UNUSED(ignore), NpyArray_Descr *NPY_UNUSED(ignored))
{
    double result;
    int ret;

    ret = NumPyOS_ascii_ftolf(fp, &result);
    *ip = (longdouble) result;
    return ret;
}


int
BYTE_scan(FILE *fp, byte *ip, void *NPY_UNUSED(ignore), NpyArray_Descr *NPY_UNUSED(ignore2))
{
    int temp;
    int num;

    num = fscanf(fp, "%""d", &temp);
    *ip = (byte) temp;
    return num;
}

int
UBYTE_scan(FILE *fp, ubyte *ip, void *NPY_UNUSED(ignore), NpyArray_Descr *NPY_UNUSED(ignore2))
{
    uint temp;
    int num;

    num = fscanf(fp, "%""u", &temp);
    *ip = (ubyte) temp;
    return num;
}


int
BOOL_scan(FILE *fp, npy_bool *ip, void *NPY_UNUSED(ignore), NpyArray_Descr *NPY_UNUSED(ignore2))
{
    int temp;
    int num;

    num = fscanf(fp, "%d", &temp);
    *ip = (npy_bool) (temp != 0);
    return num;
}

#define CFLOAT_scan NULL

#define CDOUBLE_scan NULL

#define CLONGDOUBLE_scan NULL

#define STRING_scan NULL

#define UNICODE_scan NULL

#define VOID_scan NULL

#define DATETIME_scan NULL

#define TIMEDELTA_scan NULL



/*
 *****************************************************************************
 **                             FROMSTR                                     **
 *****************************************************************************
 */


int
BYTE_fromstr(char *str, byte *ip, char **endptr, NpyArray_Descr *NPY_UNUSED(ignore))
{
    long result;

    result = NumPyOS_strtol(str, endptr, 10);
    *ip = (byte) result;
    return 0;
}

int
UBYTE_fromstr(char *str, ubyte *ip, char **endptr, NpyArray_Descr *NPY_UNUSED(ignore))
{
    ulong result;

    result = NumPyOS_strtoul(str, endptr, 10);
    *ip = (ubyte) result;
    return 0;
}

int
SHORT_fromstr(char *str, short *ip, char **endptr, NpyArray_Descr *NPY_UNUSED(ignore))
{
    long result;

    result = NumPyOS_strtol(str, endptr, 10);
    *ip = (short) result;
    return 0;
}

int
USHORT_fromstr(char *str, ushort *ip, char **endptr, NpyArray_Descr *NPY_UNUSED(ignore))
{
    ulong result;

    result = NumPyOS_strtoul(str, endptr, 10);
    *ip = (ushort) result;
    return 0;
}

int
INT_fromstr(char *str, int *ip, char **endptr, NpyArray_Descr *NPY_UNUSED(ignore))
{
    long result;

    result = NumPyOS_strtol(str, endptr, 10);
    *ip = (int) result;
    return 0;
}

int
UINT_fromstr(char *str, uint *ip, char **endptr, NpyArray_Descr *NPY_UNUSED(ignore))
{
    ulong result;

    result = NumPyOS_strtoul(str, endptr, 10);
    *ip = (uint) result;
    return 0;
}

int
LONG_fromstr(char *str, long *ip, char **endptr, NpyArray_Descr *NPY_UNUSED(ignore))
{
    long result;

    result = NumPyOS_strtol(str, endptr, 10);
    *ip = (long) result;
    return 0;
}

int
ULONG_fromstr(char *str, ulong *ip, char **endptr, NpyArray_Descr *NPY_UNUSED(ignore))
{
    ulong result;

    result = NumPyOS_strtoul(str, endptr, 10);
    *ip = (ulong) result;
    return 0;
}

int
LONGLONG_fromstr(char *str, longlong *ip, char **endptr, NpyArray_Descr *NPY_UNUSED(ignore))
{
    long result;

    result = NumPyOS_strtol(str, endptr, 10);
    *ip = (longlong) result;
    return 0;
}

int
ULONGLONG_fromstr(char *str, ulonglong *ip, char **endptr, NpyArray_Descr *NPY_UNUSED(ignore))
{
    ulong result;

    result = NumPyOS_strtoul(str, endptr, 10);
    *ip = (ulonglong) result;
    return 0;
}

int
DATETIME_fromstr(char *str, datetime *ip, char **endptr, NpyArray_Descr *NPY_UNUSED(ignore))
{
    long result;

    result = NumPyOS_strtol(str, endptr, 10);
    *ip = (datetime) result;
    return 0;
}

int
TIMEDELTA_fromstr(char *str, timedelta *ip, char **endptr, NpyArray_Descr *NPY_UNUSED(ignore))
{
    long result;

    result = NumPyOS_strtol(str, endptr, 10);
    *ip = (timedelta) result;
    return 0;
}


int
FLOAT_fromstr(char *str, float *ip, char **endptr, NpyArray_Descr *NPY_UNUSED(ignore))
{
    double result;

    result = NumPyOS_ascii_strtod(str, endptr);
    *ip = (float) result;
    return 0;
}

int
DOUBLE_fromstr(char *str, double *ip, char **endptr, NpyArray_Descr *NPY_UNUSED(ignore))
{
    double result;

    result = NumPyOS_ascii_strtod(str, endptr);
    *ip = (double) result;
    return 0;
}

int
LONGDOUBLE_fromstr(char *str, longdouble *ip, char **endptr, NpyArray_Descr *NPY_UNUSED(ignore))
{
    double result;

    result = NumPyOS_ascii_strtod(str, endptr);
    *ip = (longdouble) result;
    return 0;
}




#define BOOL_fromstr NULL

#define CFLOAT_fromstr NULL

#define CDOUBLE_fromstr NULL

#define CLONGDOUBLE_fromstr NULL

#define STRING_fromstr NULL

#define UNICODE_fromstr NULL

#define VOID_fromstr NULL





#define BOOL_fill NULL



#define _NPY_UNUSEDBOOL  NPY_UNUSED
#define _NPY_UNUSEDBYTE  NPY_UNUSED
#define _NPY_UNUSEDUBYTE  NPY_UNUSED
#define _NPY_UNUSEDSHORT  NPY_UNUSED
#define _NPY_UNUSEDUSHORT  NPY_UNUSED
#define _NPY_UNUSEDINT  NPY_UNUSED
#define _NPY_UNUSEDUINT  NPY_UNUSED
#define _NPY_UNUSEDLONG  NPY_UNUSED
#define _NPY_UNUSEDULONG  NPY_UNUSED
#define _NPY_UNUSEDLONGLONG  NPY_UNUSED
#define _NPY_UNUSEDULONGLONG  NPY_UNUSED
#define _NPY_UNUSEDFLOAT  NPY_UNUSED
#define _NPY_UNUSEDDOUBLE  NPY_UNUSED
#define _NPY_UNUSEDLONGDOUBLE  NPY_UNUSED
#define _NPY_UNUSEDCFLOAT  NPY_UNUSED
#define _NPY_UNUSEDCDOUBLE  NPY_UNUSED
#define _NPY_UNUSEDCLONGDOUBLE  NPY_UNUSED
#define _NPY_UNUSEDDATETIME  NPY_UNUSED
#define _NPY_UNUSEDTIMEDELTA  NPY_UNUSED
#define _NPY_UNUSEDSTRING
#define _NPY_UNUSEDVOID
#define _NPY_UNUSEDUNICODE



/*
 *****************************************************************************
 **                       TYPE TO TYPE CONVERSIONS                          **
 *****************************************************************************
 */


/* Assumes contiguous, and aligned, from and to */



static void
BYTE_to_BYTE(byte *ip, byte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (byte)*(ip++);
    }
}

static void
UBYTE_to_BYTE(ubyte *ip, byte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (byte)*(ip++);
    }
}

static void
SHORT_to_BYTE(short *ip, byte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (byte)*(ip++);
    }
}

static void
USHORT_to_BYTE(ushort *ip, byte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (byte)*(ip++);
    }
}

static void
INT_to_BYTE(int *ip, byte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (byte)*(ip++);
    }
}

static void
UINT_to_BYTE(uint *ip, byte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (byte)*(ip++);
    }
}

static void
LONG_to_BYTE(long *ip, byte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (byte)*(ip++);
    }
}

static void
ULONG_to_BYTE(ulong *ip, byte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (byte)*(ip++);
    }
}

static void
LONGLONG_to_BYTE(longlong *ip, byte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (byte)*(ip++);
    }
}

static void
ULONGLONG_to_BYTE(ulonglong *ip, byte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (byte)*(ip++);
    }
}

static void
FLOAT_to_BYTE(float *ip, byte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (byte)*(ip++);
    }
}

static void
DOUBLE_to_BYTE(double *ip, byte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (byte)*(ip++);
    }
}

static void
LONGDOUBLE_to_BYTE(longdouble *ip, byte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (byte)*(ip++);
    }
}

static void
DATETIME_to_BYTE(datetime *ip, byte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (byte)*(ip++);
    }
}

static void
TIMEDELTA_to_BYTE(timedelta *ip, byte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (byte)*(ip++);
    }
}


static void
CFLOAT_to_BYTE(float *ip, byte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (byte)*ip;
        ip += 2;
    }
}

static void
CDOUBLE_to_BYTE(double *ip, byte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (byte)*ip;
        ip += 2;
    }
}

static void
CLONGDOUBLE_to_BYTE(longdouble *ip, byte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (byte)*ip;
        ip += 2;
    }
}




static void
BYTE_to_UBYTE(byte *ip, ubyte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ubyte)*(ip++);
    }
}

static void
UBYTE_to_UBYTE(ubyte *ip, ubyte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ubyte)*(ip++);
    }
}

static void
SHORT_to_UBYTE(short *ip, ubyte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ubyte)*(ip++);
    }
}

static void
USHORT_to_UBYTE(ushort *ip, ubyte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ubyte)*(ip++);
    }
}

static void
INT_to_UBYTE(int *ip, ubyte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ubyte)*(ip++);
    }
}

static void
UINT_to_UBYTE(uint *ip, ubyte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ubyte)*(ip++);
    }
}

static void
LONG_to_UBYTE(long *ip, ubyte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ubyte)*(ip++);
    }
}

static void
ULONG_to_UBYTE(ulong *ip, ubyte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ubyte)*(ip++);
    }
}

static void
LONGLONG_to_UBYTE(longlong *ip, ubyte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ubyte)*(ip++);
    }
}

static void
ULONGLONG_to_UBYTE(ulonglong *ip, ubyte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ubyte)*(ip++);
    }
}

static void
FLOAT_to_UBYTE(float *ip, ubyte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ubyte)*(ip++);
    }
}

static void
DOUBLE_to_UBYTE(double *ip, ubyte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ubyte)*(ip++);
    }
}

static void
LONGDOUBLE_to_UBYTE(longdouble *ip, ubyte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ubyte)*(ip++);
    }
}

static void
DATETIME_to_UBYTE(datetime *ip, ubyte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ubyte)*(ip++);
    }
}

static void
TIMEDELTA_to_UBYTE(timedelta *ip, ubyte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ubyte)*(ip++);
    }
}


static void
CFLOAT_to_UBYTE(float *ip, ubyte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (ubyte)*ip;
        ip += 2;
    }
}

static void
CDOUBLE_to_UBYTE(double *ip, ubyte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (ubyte)*ip;
        ip += 2;
    }
}

static void
CLONGDOUBLE_to_UBYTE(longdouble *ip, ubyte *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (ubyte)*ip;
        ip += 2;
    }
}




static void
BYTE_to_SHORT(byte *ip, short *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (short)*(ip++);
    }
}

static void
UBYTE_to_SHORT(ubyte *ip, short *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (short)*(ip++);
    }
}

static void
SHORT_to_SHORT(short *ip, short *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (short)*(ip++);
    }
}

static void
USHORT_to_SHORT(ushort *ip, short *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (short)*(ip++);
    }
}

static void
INT_to_SHORT(int *ip, short *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (short)*(ip++);
    }
}

static void
UINT_to_SHORT(uint *ip, short *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (short)*(ip++);
    }
}

static void
LONG_to_SHORT(long *ip, short *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (short)*(ip++);
    }
}

static void
ULONG_to_SHORT(ulong *ip, short *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (short)*(ip++);
    }
}

static void
LONGLONG_to_SHORT(longlong *ip, short *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (short)*(ip++);
    }
}

static void
ULONGLONG_to_SHORT(ulonglong *ip, short *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (short)*(ip++);
    }
}

static void
FLOAT_to_SHORT(float *ip, short *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (short)*(ip++);
    }
}

static void
DOUBLE_to_SHORT(double *ip, short *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (short)*(ip++);
    }
}

static void
LONGDOUBLE_to_SHORT(longdouble *ip, short *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (short)*(ip++);
    }
}

static void
DATETIME_to_SHORT(datetime *ip, short *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (short)*(ip++);
    }
}

static void
TIMEDELTA_to_SHORT(timedelta *ip, short *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (short)*(ip++);
    }
}


static void
CFLOAT_to_SHORT(float *ip, short *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (short)*ip;
        ip += 2;
    }
}

static void
CDOUBLE_to_SHORT(double *ip, short *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (short)*ip;
        ip += 2;
    }
}

static void
CLONGDOUBLE_to_SHORT(longdouble *ip, short *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (short)*ip;
        ip += 2;
    }
}




static void
BYTE_to_USHORT(byte *ip, ushort *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ushort)*(ip++);
    }
}

static void
UBYTE_to_USHORT(ubyte *ip, ushort *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ushort)*(ip++);
    }
}

static void
SHORT_to_USHORT(short *ip, ushort *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ushort)*(ip++);
    }
}

static void
USHORT_to_USHORT(ushort *ip, ushort *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ushort)*(ip++);
    }
}

static void
INT_to_USHORT(int *ip, ushort *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ushort)*(ip++);
    }
}

static void
UINT_to_USHORT(uint *ip, ushort *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ushort)*(ip++);
    }
}

static void
LONG_to_USHORT(long *ip, ushort *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ushort)*(ip++);
    }
}

static void
ULONG_to_USHORT(ulong *ip, ushort *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ushort)*(ip++);
    }
}

static void
LONGLONG_to_USHORT(longlong *ip, ushort *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ushort)*(ip++);
    }
}

static void
ULONGLONG_to_USHORT(ulonglong *ip, ushort *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ushort)*(ip++);
    }
}

static void
FLOAT_to_USHORT(float *ip, ushort *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ushort)*(ip++);
    }
}

static void
DOUBLE_to_USHORT(double *ip, ushort *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ushort)*(ip++);
    }
}

static void
LONGDOUBLE_to_USHORT(longdouble *ip, ushort *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ushort)*(ip++);
    }
}

static void
DATETIME_to_USHORT(datetime *ip, ushort *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ushort)*(ip++);
    }
}

static void
TIMEDELTA_to_USHORT(timedelta *ip, ushort *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ushort)*(ip++);
    }
}


static void
CFLOAT_to_USHORT(float *ip, ushort *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (ushort)*ip;
        ip += 2;
    }
}

static void
CDOUBLE_to_USHORT(double *ip, ushort *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (ushort)*ip;
        ip += 2;
    }
}

static void
CLONGDOUBLE_to_USHORT(longdouble *ip, ushort *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (ushort)*ip;
        ip += 2;
    }
}




static void
BYTE_to_INT(byte *ip, int *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (int)*(ip++);
    }
}

static void
UBYTE_to_INT(ubyte *ip, int *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (int)*(ip++);
    }
}

static void
SHORT_to_INT(short *ip, int *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (int)*(ip++);
    }
}

static void
USHORT_to_INT(ushort *ip, int *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (int)*(ip++);
    }
}

static void
INT_to_INT(int *ip, int *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (int)*(ip++);
    }
}

static void
UINT_to_INT(uint *ip, int *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (int)*(ip++);
    }
}

static void
LONG_to_INT(long *ip, int *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (int)*(ip++);
    }
}

static void
ULONG_to_INT(ulong *ip, int *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (int)*(ip++);
    }
}

static void
LONGLONG_to_INT(longlong *ip, int *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (int)*(ip++);
    }
}

static void
ULONGLONG_to_INT(ulonglong *ip, int *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (int)*(ip++);
    }
}

static void
FLOAT_to_INT(float *ip, int *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (int)*(ip++);
    }
}

static void
DOUBLE_to_INT(double *ip, int *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (int)*(ip++);
    }
}

static void
LONGDOUBLE_to_INT(longdouble *ip, int *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (int)*(ip++);
    }
}

static void
DATETIME_to_INT(datetime *ip, int *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (int)*(ip++);
    }
}

static void
TIMEDELTA_to_INT(timedelta *ip, int *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (int)*(ip++);
    }
}


static void
CFLOAT_to_INT(float *ip, int *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (int)*ip;
        ip += 2;
    }
}

static void
CDOUBLE_to_INT(double *ip, int *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (int)*ip;
        ip += 2;
    }
}

static void
CLONGDOUBLE_to_INT(longdouble *ip, int *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (int)*ip;
        ip += 2;
    }
}




static void
BYTE_to_UINT(byte *ip, uint *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (uint)*(ip++);
    }
}

static void
UBYTE_to_UINT(ubyte *ip, uint *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (uint)*(ip++);
    }
}

static void
SHORT_to_UINT(short *ip, uint *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (uint)*(ip++);
    }
}

static void
USHORT_to_UINT(ushort *ip, uint *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (uint)*(ip++);
    }
}

static void
INT_to_UINT(int *ip, uint *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (uint)*(ip++);
    }
}

static void
UINT_to_UINT(uint *ip, uint *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (uint)*(ip++);
    }
}

static void
LONG_to_UINT(long *ip, uint *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (uint)*(ip++);
    }
}

static void
ULONG_to_UINT(ulong *ip, uint *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (uint)*(ip++);
    }
}

static void
LONGLONG_to_UINT(longlong *ip, uint *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (uint)*(ip++);
    }
}

static void
ULONGLONG_to_UINT(ulonglong *ip, uint *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (uint)*(ip++);
    }
}

static void
FLOAT_to_UINT(float *ip, uint *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (uint)*(ip++);
    }
}

static void
DOUBLE_to_UINT(double *ip, uint *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (uint)*(ip++);
    }
}

static void
LONGDOUBLE_to_UINT(longdouble *ip, uint *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (uint)*(ip++);
    }
}

static void
DATETIME_to_UINT(datetime *ip, uint *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (uint)*(ip++);
    }
}

static void
TIMEDELTA_to_UINT(timedelta *ip, uint *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (uint)*(ip++);
    }
}


static void
CFLOAT_to_UINT(float *ip, uint *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (uint)*ip;
        ip += 2;
    }
}

static void
CDOUBLE_to_UINT(double *ip, uint *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (uint)*ip;
        ip += 2;
    }
}

static void
CLONGDOUBLE_to_UINT(longdouble *ip, uint *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (uint)*ip;
        ip += 2;
    }
}




static void
BYTE_to_LONG(byte *ip, long *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (long)*(ip++);
    }
}

static void
UBYTE_to_LONG(ubyte *ip, long *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (long)*(ip++);
    }
}

static void
SHORT_to_LONG(short *ip, long *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (long)*(ip++);
    }
}

static void
USHORT_to_LONG(ushort *ip, long *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (long)*(ip++);
    }
}

static void
INT_to_LONG(int *ip, long *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (long)*(ip++);
    }
}

static void
UINT_to_LONG(uint *ip, long *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (long)*(ip++);
    }
}

static void
LONG_to_LONG(long *ip, long *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (long)*(ip++);
    }
}

static void
ULONG_to_LONG(ulong *ip, long *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (long)*(ip++);
    }
}

static void
LONGLONG_to_LONG(longlong *ip, long *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (long)*(ip++);
    }
}

static void
ULONGLONG_to_LONG(ulonglong *ip, long *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (long)*(ip++);
    }
}

static void
FLOAT_to_LONG(float *ip, long *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (long)*(ip++);
    }
}

static void
DOUBLE_to_LONG(double *ip, long *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (long)*(ip++);
    }
}

static void
LONGDOUBLE_to_LONG(longdouble *ip, long *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (long)*(ip++);
    }
}

static void
DATETIME_to_LONG(datetime *ip, long *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (long)*(ip++);
    }
}

static void
TIMEDELTA_to_LONG(timedelta *ip, long *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (long)*(ip++);
    }
}


static void
CFLOAT_to_LONG(float *ip, long *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (long)*ip;
        ip += 2;
    }
}

static void
CDOUBLE_to_LONG(double *ip, long *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (long)*ip;
        ip += 2;
    }
}

static void
CLONGDOUBLE_to_LONG(longdouble *ip, long *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (long)*ip;
        ip += 2;
    }
}




static void
BYTE_to_ULONG(byte *ip, ulong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ulong)*(ip++);
    }
}

static void
UBYTE_to_ULONG(ubyte *ip, ulong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ulong)*(ip++);
    }
}

static void
SHORT_to_ULONG(short *ip, ulong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ulong)*(ip++);
    }
}

static void
USHORT_to_ULONG(ushort *ip, ulong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ulong)*(ip++);
    }
}

static void
INT_to_ULONG(int *ip, ulong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ulong)*(ip++);
    }
}

static void
UINT_to_ULONG(uint *ip, ulong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ulong)*(ip++);
    }
}

static void
LONG_to_ULONG(long *ip, ulong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ulong)*(ip++);
    }
}

static void
ULONG_to_ULONG(ulong *ip, ulong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ulong)*(ip++);
    }
}

static void
LONGLONG_to_ULONG(longlong *ip, ulong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ulong)*(ip++);
    }
}

static void
ULONGLONG_to_ULONG(ulonglong *ip, ulong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ulong)*(ip++);
    }
}

static void
FLOAT_to_ULONG(float *ip, ulong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ulong)*(ip++);
    }
}

static void
DOUBLE_to_ULONG(double *ip, ulong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ulong)*(ip++);
    }
}

static void
LONGDOUBLE_to_ULONG(longdouble *ip, ulong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ulong)*(ip++);
    }
}

static void
DATETIME_to_ULONG(datetime *ip, ulong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ulong)*(ip++);
    }
}

static void
TIMEDELTA_to_ULONG(timedelta *ip, ulong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ulong)*(ip++);
    }
}


static void
CFLOAT_to_ULONG(float *ip, ulong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (ulong)*ip;
        ip += 2;
    }
}

static void
CDOUBLE_to_ULONG(double *ip, ulong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (ulong)*ip;
        ip += 2;
    }
}

static void
CLONGDOUBLE_to_ULONG(longdouble *ip, ulong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (ulong)*ip;
        ip += 2;
    }
}




static void
BYTE_to_LONGLONG(byte *ip, longlong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (longlong)*(ip++);
    }
}

static void
UBYTE_to_LONGLONG(ubyte *ip, longlong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (longlong)*(ip++);
    }
}

static void
SHORT_to_LONGLONG(short *ip, longlong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (longlong)*(ip++);
    }
}

static void
USHORT_to_LONGLONG(ushort *ip, longlong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (longlong)*(ip++);
    }
}

static void
INT_to_LONGLONG(int *ip, longlong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (longlong)*(ip++);
    }
}

static void
UINT_to_LONGLONG(uint *ip, longlong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (longlong)*(ip++);
    }
}

static void
LONG_to_LONGLONG(long *ip, longlong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (longlong)*(ip++);
    }
}

static void
ULONG_to_LONGLONG(ulong *ip, longlong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (longlong)*(ip++);
    }
}

static void
LONGLONG_to_LONGLONG(longlong *ip, longlong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (longlong)*(ip++);
    }
}

static void
ULONGLONG_to_LONGLONG(ulonglong *ip, longlong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (longlong)*(ip++);
    }
}

static void
FLOAT_to_LONGLONG(float *ip, longlong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (longlong)*(ip++);
    }
}

static void
DOUBLE_to_LONGLONG(double *ip, longlong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (longlong)*(ip++);
    }
}

static void
LONGDOUBLE_to_LONGLONG(longdouble *ip, longlong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (longlong)*(ip++);
    }
}

static void
DATETIME_to_LONGLONG(datetime *ip, longlong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (longlong)*(ip++);
    }
}

static void
TIMEDELTA_to_LONGLONG(timedelta *ip, longlong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (longlong)*(ip++);
    }
}


static void
CFLOAT_to_LONGLONG(float *ip, longlong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (longlong)*ip;
        ip += 2;
    }
}

static void
CDOUBLE_to_LONGLONG(double *ip, longlong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (longlong)*ip;
        ip += 2;
    }
}

static void
CLONGDOUBLE_to_LONGLONG(longdouble *ip, longlong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (longlong)*ip;
        ip += 2;
    }
}




static void
BYTE_to_ULONGLONG(byte *ip, ulonglong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ulonglong)*(ip++);
    }
}

static void
UBYTE_to_ULONGLONG(ubyte *ip, ulonglong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ulonglong)*(ip++);
    }
}

static void
SHORT_to_ULONGLONG(short *ip, ulonglong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ulonglong)*(ip++);
    }
}

static void
USHORT_to_ULONGLONG(ushort *ip, ulonglong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ulonglong)*(ip++);
    }
}

static void
INT_to_ULONGLONG(int *ip, ulonglong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ulonglong)*(ip++);
    }
}

static void
UINT_to_ULONGLONG(uint *ip, ulonglong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ulonglong)*(ip++);
    }
}

static void
LONG_to_ULONGLONG(long *ip, ulonglong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ulonglong)*(ip++);
    }
}

static void
ULONG_to_ULONGLONG(ulong *ip, ulonglong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ulonglong)*(ip++);
    }
}

static void
LONGLONG_to_ULONGLONG(longlong *ip, ulonglong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ulonglong)*(ip++);
    }
}

static void
ULONGLONG_to_ULONGLONG(ulonglong *ip, ulonglong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ulonglong)*(ip++);
    }
}

static void
FLOAT_to_ULONGLONG(float *ip, ulonglong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ulonglong)*(ip++);
    }
}

static void
DOUBLE_to_ULONGLONG(double *ip, ulonglong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ulonglong)*(ip++);
    }
}

static void
LONGDOUBLE_to_ULONGLONG(longdouble *ip, ulonglong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ulonglong)*(ip++);
    }
}

static void
DATETIME_to_ULONGLONG(datetime *ip, ulonglong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ulonglong)*(ip++);
    }
}

static void
TIMEDELTA_to_ULONGLONG(timedelta *ip, ulonglong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (ulonglong)*(ip++);
    }
}


static void
CFLOAT_to_ULONGLONG(float *ip, ulonglong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (ulonglong)*ip;
        ip += 2;
    }
}

static void
CDOUBLE_to_ULONGLONG(double *ip, ulonglong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (ulonglong)*ip;
        ip += 2;
    }
}

static void
CLONGDOUBLE_to_ULONGLONG(longdouble *ip, ulonglong *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (ulonglong)*ip;
        ip += 2;
    }
}




static void
BYTE_to_FLOAT(byte *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (float)*(ip++);
    }
}

static void
UBYTE_to_FLOAT(ubyte *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (float)*(ip++);
    }
}

static void
SHORT_to_FLOAT(short *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (float)*(ip++);
    }
}

static void
USHORT_to_FLOAT(ushort *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (float)*(ip++);
    }
}

static void
INT_to_FLOAT(int *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (float)*(ip++);
    }
}

static void
UINT_to_FLOAT(uint *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (float)*(ip++);
    }
}

static void
LONG_to_FLOAT(long *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (float)*(ip++);
    }
}

static void
ULONG_to_FLOAT(ulong *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (float)*(ip++);
    }
}

static void
LONGLONG_to_FLOAT(longlong *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (float)*(ip++);
    }
}

static void
ULONGLONG_to_FLOAT(ulonglong *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (float)*(ip++);
    }
}

static void
FLOAT_to_FLOAT(float *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (float)*(ip++);
    }
}

static void
DOUBLE_to_FLOAT(double *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (float)*(ip++);
    }
}

static void
LONGDOUBLE_to_FLOAT(longdouble *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (float)*(ip++);
    }
}

static void
DATETIME_to_FLOAT(datetime *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (float)*(ip++);
    }
}

static void
TIMEDELTA_to_FLOAT(timedelta *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (float)*(ip++);
    }
}


static void
CFLOAT_to_FLOAT(float *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (float)*ip;
        ip += 2;
    }
}

static void
CDOUBLE_to_FLOAT(double *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (float)*ip;
        ip += 2;
    }
}

static void
CLONGDOUBLE_to_FLOAT(longdouble *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (float)*ip;
        ip += 2;
    }
}




static void
BYTE_to_DOUBLE(byte *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (double)*(ip++);
    }
}

static void
UBYTE_to_DOUBLE(ubyte *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (double)*(ip++);
    }
}

static void
SHORT_to_DOUBLE(short *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (double)*(ip++);
    }
}

static void
USHORT_to_DOUBLE(ushort *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (double)*(ip++);
    }
}

static void
INT_to_DOUBLE(int *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (double)*(ip++);
    }
}

static void
UINT_to_DOUBLE(uint *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (double)*(ip++);
    }
}

static void
LONG_to_DOUBLE(long *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (double)*(ip++);
    }
}

static void
ULONG_to_DOUBLE(ulong *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (double)*(ip++);
    }
}

static void
LONGLONG_to_DOUBLE(longlong *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (double)*(ip++);
    }
}

static void
ULONGLONG_to_DOUBLE(ulonglong *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (double)*(ip++);
    }
}

static void
FLOAT_to_DOUBLE(float *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (double)*(ip++);
    }
}

static void
DOUBLE_to_DOUBLE(double *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (double)*(ip++);
    }
}

static void
LONGDOUBLE_to_DOUBLE(longdouble *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (double)*(ip++);
    }
}

static void
DATETIME_to_DOUBLE(datetime *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (double)*(ip++);
    }
}

static void
TIMEDELTA_to_DOUBLE(timedelta *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (double)*(ip++);
    }
}


static void
CFLOAT_to_DOUBLE(float *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (double)*ip;
        ip += 2;
    }
}

static void
CDOUBLE_to_DOUBLE(double *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (double)*ip;
        ip += 2;
    }
}

static void
CLONGDOUBLE_to_DOUBLE(longdouble *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (double)*ip;
        ip += 2;
    }
}




static void
BYTE_to_LONGDOUBLE(byte *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (longdouble)*(ip++);
    }
}

static void
UBYTE_to_LONGDOUBLE(ubyte *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (longdouble)*(ip++);
    }
}

static void
SHORT_to_LONGDOUBLE(short *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (longdouble)*(ip++);
    }
}

static void
USHORT_to_LONGDOUBLE(ushort *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (longdouble)*(ip++);
    }
}

static void
INT_to_LONGDOUBLE(int *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (longdouble)*(ip++);
    }
}

static void
UINT_to_LONGDOUBLE(uint *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (longdouble)*(ip++);
    }
}

static void
LONG_to_LONGDOUBLE(long *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (longdouble)*(ip++);
    }
}

static void
ULONG_to_LONGDOUBLE(ulong *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (longdouble)*(ip++);
    }
}

static void
LONGLONG_to_LONGDOUBLE(longlong *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (longdouble)*(ip++);
    }
}

static void
ULONGLONG_to_LONGDOUBLE(ulonglong *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (longdouble)*(ip++);
    }
}

static void
FLOAT_to_LONGDOUBLE(float *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (longdouble)*(ip++);
    }
}

static void
DOUBLE_to_LONGDOUBLE(double *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (longdouble)*(ip++);
    }
}

static void
LONGDOUBLE_to_LONGDOUBLE(longdouble *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (longdouble)*(ip++);
    }
}

static void
DATETIME_to_LONGDOUBLE(datetime *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (longdouble)*(ip++);
    }
}

static void
TIMEDELTA_to_LONGDOUBLE(timedelta *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (longdouble)*(ip++);
    }
}


static void
CFLOAT_to_LONGDOUBLE(float *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (longdouble)*ip;
        ip += 2;
    }
}

static void
CDOUBLE_to_LONGDOUBLE(double *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (longdouble)*ip;
        ip += 2;
    }
}

static void
CLONGDOUBLE_to_LONGDOUBLE(longdouble *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (longdouble)*ip;
        ip += 2;
    }
}




static void
BYTE_to_DATETIME(byte *ip, datetime *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (datetime)*(ip++);
    }
}

static void
UBYTE_to_DATETIME(ubyte *ip, datetime *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (datetime)*(ip++);
    }
}

static void
SHORT_to_DATETIME(short *ip, datetime *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (datetime)*(ip++);
    }
}

static void
USHORT_to_DATETIME(ushort *ip, datetime *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (datetime)*(ip++);
    }
}

static void
INT_to_DATETIME(int *ip, datetime *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (datetime)*(ip++);
    }
}

static void
UINT_to_DATETIME(uint *ip, datetime *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (datetime)*(ip++);
    }
}

static void
LONG_to_DATETIME(long *ip, datetime *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (datetime)*(ip++);
    }
}

static void
ULONG_to_DATETIME(ulong *ip, datetime *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (datetime)*(ip++);
    }
}

static void
LONGLONG_to_DATETIME(longlong *ip, datetime *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (datetime)*(ip++);
    }
}

static void
ULONGLONG_to_DATETIME(ulonglong *ip, datetime *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (datetime)*(ip++);
    }
}

static void
FLOAT_to_DATETIME(float *ip, datetime *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (datetime)*(ip++);
    }
}

static void
DOUBLE_to_DATETIME(double *ip, datetime *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (datetime)*(ip++);
    }
}

static void
LONGDOUBLE_to_DATETIME(longdouble *ip, datetime *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (datetime)*(ip++);
    }
}

static void
DATETIME_to_DATETIME(datetime *ip, datetime *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (datetime)*(ip++);
    }
}

static void
TIMEDELTA_to_DATETIME(timedelta *ip, datetime *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (datetime)*(ip++);
    }
}


static void
CFLOAT_to_DATETIME(float *ip, datetime *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (datetime)*ip;
        ip += 2;
    }
}

static void
CDOUBLE_to_DATETIME(double *ip, datetime *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (datetime)*ip;
        ip += 2;
    }
}

static void
CLONGDOUBLE_to_DATETIME(longdouble *ip, datetime *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (datetime)*ip;
        ip += 2;
    }
}




static void
BYTE_to_TIMEDELTA(byte *ip, timedelta *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (timedelta)*(ip++);
    }
}

static void
UBYTE_to_TIMEDELTA(ubyte *ip, timedelta *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (timedelta)*(ip++);
    }
}

static void
SHORT_to_TIMEDELTA(short *ip, timedelta *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (timedelta)*(ip++);
    }
}

static void
USHORT_to_TIMEDELTA(ushort *ip, timedelta *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (timedelta)*(ip++);
    }
}

static void
INT_to_TIMEDELTA(int *ip, timedelta *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (timedelta)*(ip++);
    }
}

static void
UINT_to_TIMEDELTA(uint *ip, timedelta *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (timedelta)*(ip++);
    }
}

static void
LONG_to_TIMEDELTA(long *ip, timedelta *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (timedelta)*(ip++);
    }
}

static void
ULONG_to_TIMEDELTA(ulong *ip, timedelta *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (timedelta)*(ip++);
    }
}

static void
LONGLONG_to_TIMEDELTA(longlong *ip, timedelta *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (timedelta)*(ip++);
    }
}

static void
ULONGLONG_to_TIMEDELTA(ulonglong *ip, timedelta *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (timedelta)*(ip++);
    }
}

static void
FLOAT_to_TIMEDELTA(float *ip, timedelta *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (timedelta)*(ip++);
    }
}

static void
DOUBLE_to_TIMEDELTA(double *ip, timedelta *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (timedelta)*(ip++);
    }
}

static void
LONGDOUBLE_to_TIMEDELTA(longdouble *ip, timedelta *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (timedelta)*(ip++);
    }
}

static void
DATETIME_to_TIMEDELTA(datetime *ip, timedelta *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (timedelta)*(ip++);
    }
}

static void
TIMEDELTA_to_TIMEDELTA(timedelta *ip, timedelta *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *(op++) = (timedelta)*(ip++);
    }
}


static void
CFLOAT_to_TIMEDELTA(float *ip, timedelta *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (timedelta)*ip;
        ip += 2;
    }
}

static void
CDOUBLE_to_TIMEDELTA(double *ip, timedelta *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (timedelta)*ip;
        ip += 2;
    }
}

static void
CLONGDOUBLE_to_TIMEDELTA(longdouble *ip, timedelta *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (timedelta)*ip;
        ip += 2;
    }
}





static void
BOOL_to_BOOL(Bool *ip, Bool *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (Bool)(*ip++ != FALSE);
    }
}

static void
BYTE_to_BOOL(byte *ip, Bool *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (Bool)(*ip++ != FALSE);
    }
}

static void
UBYTE_to_BOOL(ubyte *ip, Bool *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (Bool)(*ip++ != FALSE);
    }
}

static void
SHORT_to_BOOL(short *ip, Bool *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (Bool)(*ip++ != FALSE);
    }
}

static void
USHORT_to_BOOL(ushort *ip, Bool *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (Bool)(*ip++ != FALSE);
    }
}

static void
INT_to_BOOL(int *ip, Bool *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (Bool)(*ip++ != FALSE);
    }
}

static void
UINT_to_BOOL(uint *ip, Bool *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (Bool)(*ip++ != FALSE);
    }
}

static void
LONG_to_BOOL(long *ip, Bool *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (Bool)(*ip++ != FALSE);
    }
}

static void
ULONG_to_BOOL(ulong *ip, Bool *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (Bool)(*ip++ != FALSE);
    }
}

static void
LONGLONG_to_BOOL(longlong *ip, Bool *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (Bool)(*ip++ != FALSE);
    }
}

static void
ULONGLONG_to_BOOL(ulonglong *ip, Bool *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (Bool)(*ip++ != FALSE);
    }
}

static void
FLOAT_to_BOOL(float *ip, Bool *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (Bool)(*ip++ != FALSE);
    }
}

static void
DOUBLE_to_BOOL(double *ip, Bool *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (Bool)(*ip++ != FALSE);
    }
}

static void
LONGDOUBLE_to_BOOL(longdouble *ip, Bool *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (Bool)(*ip++ != FALSE);
    }
}

static void
DATETIME_to_BOOL(datetime *ip, Bool *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (Bool)(*ip++ != FALSE);
    }
}

static void
TIMEDELTA_to_BOOL(timedelta *ip, Bool *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (Bool)(*ip++ != FALSE);
    }
}


static void
CFLOAT_to_BOOL(cfloat *ip, Bool *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op = (Bool)(((*ip).real != FALSE) || ((*ip).imag != FALSE));
        op++;
        ip++;
    }
}

static void
CDOUBLE_to_BOOL(cdouble *ip, Bool *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op = (Bool)(((*ip).real != FALSE) || ((*ip).imag != FALSE));
        op++;
        ip++;
    }
}

static void
CLONGDOUBLE_to_BOOL(clongdouble *ip, Bool *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op = (Bool)(((*ip).real != FALSE) || ((*ip).imag != FALSE));
        op++;
        ip++;
    }
}


static void
BOOL_to_BYTE(Bool *ip, byte *op, npy_intp n,
             NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (byte)(*ip++ != FALSE);
    }
}

static void
BOOL_to_UBYTE(Bool *ip, ubyte *op, npy_intp n,
             NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (ubyte)(*ip++ != FALSE);
    }
}

static void
BOOL_to_SHORT(Bool *ip, short *op, npy_intp n,
             NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (short)(*ip++ != FALSE);
    }
}

static void
BOOL_to_USHORT(Bool *ip, ushort *op, npy_intp n,
             NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (ushort)(*ip++ != FALSE);
    }
}

static void
BOOL_to_INT(Bool *ip, int *op, npy_intp n,
             NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (int)(*ip++ != FALSE);
    }
}

static void
BOOL_to_UINT(Bool *ip, uint *op, npy_intp n,
             NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (uint)(*ip++ != FALSE);
    }
}

static void
BOOL_to_LONG(Bool *ip, long *op, npy_intp n,
             NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (long)(*ip++ != FALSE);
    }
}

static void
BOOL_to_ULONG(Bool *ip, ulong *op, npy_intp n,
             NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (ulong)(*ip++ != FALSE);
    }
}

static void
BOOL_to_LONGLONG(Bool *ip, longlong *op, npy_intp n,
             NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (longlong)(*ip++ != FALSE);
    }
}

static void
BOOL_to_ULONGLONG(Bool *ip, ulonglong *op, npy_intp n,
             NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (ulonglong)(*ip++ != FALSE);
    }
}

static void
BOOL_to_FLOAT(Bool *ip, float *op, npy_intp n,
             NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (float)(*ip++ != FALSE);
    }
}

static void
BOOL_to_DOUBLE(Bool *ip, double *op, npy_intp n,
             NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (double)(*ip++ != FALSE);
    }
}

static void
BOOL_to_LONGDOUBLE(Bool *ip, longdouble *op, npy_intp n,
             NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (longdouble)(*ip++ != FALSE);
    }
}

static void
BOOL_to_DATETIME(Bool *ip, datetime *op, npy_intp n,
             NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (datetime)(*ip++ != FALSE);
    }
}

static void
BOOL_to_TIMEDELTA(Bool *ip, timedelta *op, npy_intp n,
             NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (timedelta)(*ip++ != FALSE);
    }
}



static void
BOOL_to_CFLOAT(Bool *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (float)*ip++;
        *op++ = 0.0;
    }

}

static void
BYTE_to_CFLOAT(byte *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (float)*ip++;
        *op++ = 0.0;
    }

}

static void
UBYTE_to_CFLOAT(ubyte *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (float)*ip++;
        *op++ = 0.0;
    }

}

static void
SHORT_to_CFLOAT(short *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (float)*ip++;
        *op++ = 0.0;
    }

}

static void
USHORT_to_CFLOAT(ushort *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (float)*ip++;
        *op++ = 0.0;
    }

}

static void
INT_to_CFLOAT(int *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (float)*ip++;
        *op++ = 0.0;
    }

}

static void
UINT_to_CFLOAT(uint *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (float)*ip++;
        *op++ = 0.0;
    }

}

static void
LONG_to_CFLOAT(long *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (float)*ip++;
        *op++ = 0.0;
    }

}

static void
ULONG_to_CFLOAT(ulong *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (float)*ip++;
        *op++ = 0.0;
    }

}

static void
LONGLONG_to_CFLOAT(longlong *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (float)*ip++;
        *op++ = 0.0;
    }

}

static void
ULONGLONG_to_CFLOAT(ulonglong *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (float)*ip++;
        *op++ = 0.0;
    }

}

static void
FLOAT_to_CFLOAT(float *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (float)*ip++;
        *op++ = 0.0;
    }

}

static void
DOUBLE_to_CFLOAT(double *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (float)*ip++;
        *op++ = 0.0;
    }

}

static void
LONGDOUBLE_to_CFLOAT(longdouble *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (float)*ip++;
        *op++ = 0.0;
    }

}

static void
DATETIME_to_CFLOAT(datetime *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (float)*ip++;
        *op++ = 0.0;
    }

}

static void
TIMEDELTA_to_CFLOAT(timedelta *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (float)*ip++;
        *op++ = 0.0;
    }

}



static void
BOOL_to_CDOUBLE(Bool *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (double)*ip++;
        *op++ = 0.0;
    }

}

static void
BYTE_to_CDOUBLE(byte *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (double)*ip++;
        *op++ = 0.0;
    }

}

static void
UBYTE_to_CDOUBLE(ubyte *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (double)*ip++;
        *op++ = 0.0;
    }

}

static void
SHORT_to_CDOUBLE(short *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (double)*ip++;
        *op++ = 0.0;
    }

}

static void
USHORT_to_CDOUBLE(ushort *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (double)*ip++;
        *op++ = 0.0;
    }

}

static void
INT_to_CDOUBLE(int *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (double)*ip++;
        *op++ = 0.0;
    }

}

static void
UINT_to_CDOUBLE(uint *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (double)*ip++;
        *op++ = 0.0;
    }

}

static void
LONG_to_CDOUBLE(long *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (double)*ip++;
        *op++ = 0.0;
    }

}

static void
ULONG_to_CDOUBLE(ulong *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (double)*ip++;
        *op++ = 0.0;
    }

}

static void
LONGLONG_to_CDOUBLE(longlong *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (double)*ip++;
        *op++ = 0.0;
    }

}

static void
ULONGLONG_to_CDOUBLE(ulonglong *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (double)*ip++;
        *op++ = 0.0;
    }

}

static void
FLOAT_to_CDOUBLE(float *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (double)*ip++;
        *op++ = 0.0;
    }

}

static void
DOUBLE_to_CDOUBLE(double *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (double)*ip++;
        *op++ = 0.0;
    }

}

static void
LONGDOUBLE_to_CDOUBLE(longdouble *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (double)*ip++;
        *op++ = 0.0;
    }

}

static void
DATETIME_to_CDOUBLE(datetime *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (double)*ip++;
        *op++ = 0.0;
    }

}

static void
TIMEDELTA_to_CDOUBLE(timedelta *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (double)*ip++;
        *op++ = 0.0;
    }

}



static void
BOOL_to_CLONGDOUBLE(Bool *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (longdouble)*ip++;
        *op++ = 0.0;
    }

}

static void
BYTE_to_CLONGDOUBLE(byte *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (longdouble)*ip++;
        *op++ = 0.0;
    }

}

static void
UBYTE_to_CLONGDOUBLE(ubyte *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (longdouble)*ip++;
        *op++ = 0.0;
    }

}

static void
SHORT_to_CLONGDOUBLE(short *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (longdouble)*ip++;
        *op++ = 0.0;
    }

}

static void
USHORT_to_CLONGDOUBLE(ushort *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (longdouble)*ip++;
        *op++ = 0.0;
    }

}

static void
INT_to_CLONGDOUBLE(int *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (longdouble)*ip++;
        *op++ = 0.0;
    }

}

static void
UINT_to_CLONGDOUBLE(uint *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (longdouble)*ip++;
        *op++ = 0.0;
    }

}

static void
LONG_to_CLONGDOUBLE(long *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (longdouble)*ip++;
        *op++ = 0.0;
    }

}

static void
ULONG_to_CLONGDOUBLE(ulong *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (longdouble)*ip++;
        *op++ = 0.0;
    }

}

static void
LONGLONG_to_CLONGDOUBLE(longlong *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (longdouble)*ip++;
        *op++ = 0.0;
    }

}

static void
ULONGLONG_to_CLONGDOUBLE(ulonglong *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (longdouble)*ip++;
        *op++ = 0.0;
    }

}

static void
FLOAT_to_CLONGDOUBLE(float *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (longdouble)*ip++;
        *op++ = 0.0;
    }

}

static void
DOUBLE_to_CLONGDOUBLE(double *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (longdouble)*ip++;
        *op++ = 0.0;
    }

}

static void
LONGDOUBLE_to_CLONGDOUBLE(longdouble *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (longdouble)*ip++;
        *op++ = 0.0;
    }

}

static void
DATETIME_to_CLONGDOUBLE(datetime *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (longdouble)*ip++;
        *op++ = 0.0;
    }

}

static void
TIMEDELTA_to_CLONGDOUBLE(timedelta *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    while (n--) {
        *op++ = (longdouble)*ip++;
        *op++ = 0.0;
    }

}




static void
CFLOAT_to_CFLOAT(float *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    n <<= 1;
    while (n--) {
        *op++ = (float)*ip++;
    }
}


static void
CDOUBLE_to_CFLOAT(double *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    n <<= 1;
    while (n--) {
        *op++ = (float)*ip++;
    }
}


static void
CLONGDOUBLE_to_CFLOAT(longdouble *ip, float *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    n <<= 1;
    while (n--) {
        *op++ = (float)*ip++;
    }
}




static void
CFLOAT_to_CDOUBLE(float *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    n <<= 1;
    while (n--) {
        *op++ = (double)*ip++;
    }
}


static void
CDOUBLE_to_CDOUBLE(double *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    n <<= 1;
    while (n--) {
        *op++ = (double)*ip++;
    }
}


static void
CLONGDOUBLE_to_CDOUBLE(longdouble *ip, double *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    n <<= 1;
    while (n--) {
        *op++ = (double)*ip++;
    }
}




static void
CFLOAT_to_CLONGDOUBLE(float *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    n <<= 1;
    while (n--) {
        *op++ = (longdouble)*ip++;
    }
}


static void
CDOUBLE_to_CLONGDOUBLE(double *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    n <<= 1;
    while (n--) {
        *op++ = (longdouble)*ip++;
    }
}


static void
CLONGDOUBLE_to_CLONGDOUBLE(longdouble *ip, longdouble *op, npy_intp n,
               NpyArray *NPY_UNUSED(aip), NpyArray *NPY_UNUSED(aop))
{
    n <<= 1;
    while (n--) {
        *op++ = (longdouble)*ip++;
    }
}





/*
 *****************************************************************************
 **                            COPYSWAPN                                    **
 *****************************************************************************
 */


static void
SHORT_copyswapn (void *dst, npy_intp dstride, void *src, npy_intp sstride,
                   npy_intp n, int swap, void *NPY_UNUSED(arr))
{
    if (src != NULL) {
        if (sstride == sizeof(short) && dstride == sizeof(short)) {
            memcpy(dst, src, n*sizeof(short));
        }
        else {
            _unaligned_strided_byte_copy(dst, dstride, src, sstride,
                    n, sizeof(short));
        }
    }
    if (swap) {
        _strided_byte_swap(dst, dstride, n, sizeof(short));
    }
}

static void
SHORT_copyswap (void *dst, void *src, int swap, void *NPY_UNUSED(arr))
{

    if (src != NULL) {
        /* copy first if needed */
        memcpy(dst, src, sizeof(short));
    }
    if (swap) {
        char *a, *b, c;

        a = (char *)dst;
#if SIZEOF_SHORT == 2
        b = a + 1;
        c = *a; *a++ = *b; *b = c;
#elif SIZEOF_SHORT == 4
        b = a + 3;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_SHORT == 8
        b = a + 7;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_SHORT == 10
        b = a + 9;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_SHORT == 12
        b = a + 11;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_SHORT == 16
        b = a + 15;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#else
        {
            int i, nn;

            b = a + (NPY_SIZEOF_SHORT-1);
            nn = NPY_SIZEOF_SHORT / 2;
            for (i = 0; i < nn; i++) {
                c = *a;
                *a++ = *b;
                *b-- = c;
            }
        }
#endif
    }
}


static void
USHORT_copyswapn (void *dst, npy_intp dstride, void *src, npy_intp sstride,
                   npy_intp n, int swap, void *NPY_UNUSED(arr))
{
    if (src != NULL) {
        if (sstride == sizeof(ushort) && dstride == sizeof(ushort)) {
            memcpy(dst, src, n*sizeof(ushort));
        }
        else {
            _unaligned_strided_byte_copy(dst, dstride, src, sstride,
                    n, sizeof(ushort));
        }
    }
    if (swap) {
        _strided_byte_swap(dst, dstride, n, sizeof(ushort));
    }
}

static void
USHORT_copyswap (void *dst, void *src, int swap, void *NPY_UNUSED(arr))
{

    if (src != NULL) {
        /* copy first if needed */
        memcpy(dst, src, sizeof(ushort));
    }
    if (swap) {
        char *a, *b, c;

        a = (char *)dst;
#if SIZEOF_SHORT == 2
        b = a + 1;
        c = *a; *a++ = *b; *b = c;
#elif SIZEOF_SHORT == 4
        b = a + 3;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_SHORT == 8
        b = a + 7;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_SHORT == 10
        b = a + 9;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_SHORT == 12
        b = a + 11;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_SHORT == 16
        b = a + 15;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#else
        {
            int i, nn;

            b = a + (NPY_SIZEOF_SHORT-1);
            nn = NPY_SIZEOF_SHORT / 2;
            for (i = 0; i < nn; i++) {
                c = *a;
                *a++ = *b;
                *b-- = c;
            }
        }
#endif
    }
}


static void
INT_copyswapn (void *dst, npy_intp dstride, void *src, npy_intp sstride,
                   npy_intp n, int swap, void *NPY_UNUSED(arr))
{
    if (src != NULL) {
        if (sstride == sizeof(int) && dstride == sizeof(int)) {
            memcpy(dst, src, n*sizeof(int));
        }
        else {
            _unaligned_strided_byte_copy(dst, dstride, src, sstride,
                    n, sizeof(int));
        }
    }
    if (swap) {
        _strided_byte_swap(dst, dstride, n, sizeof(int));
    }
}

static void
INT_copyswap (void *dst, void *src, int swap, void *NPY_UNUSED(arr))
{

    if (src != NULL) {
        /* copy first if needed */
        memcpy(dst, src, sizeof(int));
    }
    if (swap) {
        char *a, *b, c;

        a = (char *)dst;
#if SIZEOF_INT == 2
        b = a + 1;
        c = *a; *a++ = *b; *b = c;
#elif SIZEOF_INT == 4
        b = a + 3;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_INT == 8
        b = a + 7;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_INT == 10
        b = a + 9;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_INT == 12
        b = a + 11;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_INT == 16
        b = a + 15;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#else
        {
            int i, nn;

            b = a + (NPY_SIZEOF_INT-1);
            nn = NPY_SIZEOF_INT / 2;
            for (i = 0; i < nn; i++) {
                c = *a;
                *a++ = *b;
                *b-- = c;
            }
        }
#endif
    }
}


static void
UINT_copyswapn (void *dst, npy_intp dstride, void *src, npy_intp sstride,
                   npy_intp n, int swap, void *NPY_UNUSED(arr))
{
    if (src != NULL) {
        if (sstride == sizeof(uint) && dstride == sizeof(uint)) {
            memcpy(dst, src, n*sizeof(uint));
        }
        else {
            _unaligned_strided_byte_copy(dst, dstride, src, sstride,
                    n, sizeof(uint));
        }
    }
    if (swap) {
        _strided_byte_swap(dst, dstride, n, sizeof(uint));
    }
}

static void
UINT_copyswap (void *dst, void *src, int swap, void *NPY_UNUSED(arr))
{

    if (src != NULL) {
        /* copy first if needed */
        memcpy(dst, src, sizeof(uint));
    }
    if (swap) {
        char *a, *b, c;

        a = (char *)dst;
#if SIZEOF_INT == 2
        b = a + 1;
        c = *a; *a++ = *b; *b = c;
#elif SIZEOF_INT == 4
        b = a + 3;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_INT == 8
        b = a + 7;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_INT == 10
        b = a + 9;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_INT == 12
        b = a + 11;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_INT == 16
        b = a + 15;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#else
        {
            int i, nn;

            b = a + (NPY_SIZEOF_INT-1);
            nn = NPY_SIZEOF_INT / 2;
            for (i = 0; i < nn; i++) {
                c = *a;
                *a++ = *b;
                *b-- = c;
            }
        }
#endif
    }
}


static void
LONG_copyswapn (void *dst, npy_intp dstride, void *src, npy_intp sstride,
                   npy_intp n, int swap, void *NPY_UNUSED(arr))
{
    if (src != NULL) {
        if (sstride == sizeof(long) && dstride == sizeof(long)) {
            memcpy(dst, src, n*sizeof(long));
        }
        else {
            _unaligned_strided_byte_copy(dst, dstride, src, sstride,
                    n, sizeof(long));
        }
    }
    if (swap) {
        _strided_byte_swap(dst, dstride, n, sizeof(long));
    }
}

static void
LONG_copyswap (void *dst, void *src, int swap, void *NPY_UNUSED(arr))
{

    if (src != NULL) {
        /* copy first if needed */
        memcpy(dst, src, sizeof(long));
    }
    if (swap) {
        char *a, *b, c;

        a = (char *)dst;
#if SIZEOF_LONG == 2
        b = a + 1;
        c = *a; *a++ = *b; *b = c;
#elif SIZEOF_LONG == 4
        b = a + 3;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_LONG == 8
        b = a + 7;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_LONG == 10
        b = a + 9;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_LONG == 12
        b = a + 11;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_LONG == 16
        b = a + 15;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#else
        {
            int i, nn;

            b = a + (NPY_SIZEOF_LONG-1);
            nn = NPY_SIZEOF_LONG / 2;
            for (i = 0; i < nn; i++) {
                c = *a;
                *a++ = *b;
                *b-- = c;
            }
        }
#endif
    }
}


static void
ULONG_copyswapn (void *dst, npy_intp dstride, void *src, npy_intp sstride,
                   npy_intp n, int swap, void *NPY_UNUSED(arr))
{
    if (src != NULL) {
        if (sstride == sizeof(ulong) && dstride == sizeof(ulong)) {
            memcpy(dst, src, n*sizeof(ulong));
        }
        else {
            _unaligned_strided_byte_copy(dst, dstride, src, sstride,
                    n, sizeof(ulong));
        }
    }
    if (swap) {
        _strided_byte_swap(dst, dstride, n, sizeof(ulong));
    }
}

static void
ULONG_copyswap (void *dst, void *src, int swap, void *NPY_UNUSED(arr))
{

    if (src != NULL) {
        /* copy first if needed */
        memcpy(dst, src, sizeof(ulong));
    }
    if (swap) {
        char *a, *b, c;

        a = (char *)dst;
#if SIZEOF_LONG == 2
        b = a + 1;
        c = *a; *a++ = *b; *b = c;
#elif SIZEOF_LONG == 4
        b = a + 3;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_LONG == 8
        b = a + 7;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_LONG == 10
        b = a + 9;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_LONG == 12
        b = a + 11;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_LONG == 16
        b = a + 15;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#else
        {
            int i, nn;

            b = a + (NPY_SIZEOF_LONG-1);
            nn = NPY_SIZEOF_LONG / 2;
            for (i = 0; i < nn; i++) {
                c = *a;
                *a++ = *b;
                *b-- = c;
            }
        }
#endif
    }
}


static void
LONGLONG_copyswapn (void *dst, npy_intp dstride, void *src, npy_intp sstride,
                   npy_intp n, int swap, void *NPY_UNUSED(arr))
{
    if (src != NULL) {
        if (sstride == sizeof(longlong) && dstride == sizeof(longlong)) {
            memcpy(dst, src, n*sizeof(longlong));
        }
        else {
            _unaligned_strided_byte_copy(dst, dstride, src, sstride,
                    n, sizeof(longlong));
        }
    }
    if (swap) {
        _strided_byte_swap(dst, dstride, n, sizeof(longlong));
    }
}

static void
LONGLONG_copyswap (void *dst, void *src, int swap, void *NPY_UNUSED(arr))
{

    if (src != NULL) {
        /* copy first if needed */
        memcpy(dst, src, sizeof(longlong));
    }
    if (swap) {
        char *a, *b, c;

        a = (char *)dst;
#if SIZEOF_LONGLONG == 2
        b = a + 1;
        c = *a; *a++ = *b; *b = c;
#elif SIZEOF_LONGLONG == 4
        b = a + 3;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_LONGLONG == 8
        b = a + 7;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_LONGLONG == 10
        b = a + 9;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_LONGLONG == 12
        b = a + 11;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_LONGLONG == 16
        b = a + 15;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#else
        {
            int i, nn;

            b = a + (NPY_SIZEOF_LONGLONG-1);
            nn = NPY_SIZEOF_LONGLONG / 2;
            for (i = 0; i < nn; i++) {
                c = *a;
                *a++ = *b;
                *b-- = c;
            }
        }
#endif
    }
}


static void
ULONGLONG_copyswapn (void *dst, npy_intp dstride, void *src, npy_intp sstride,
                   npy_intp n, int swap, void *NPY_UNUSED(arr))
{
    if (src != NULL) {
        if (sstride == sizeof(ulonglong) && dstride == sizeof(ulonglong)) {
            memcpy(dst, src, n*sizeof(ulonglong));
        }
        else {
            _unaligned_strided_byte_copy(dst, dstride, src, sstride,
                    n, sizeof(ulonglong));
        }
    }
    if (swap) {
        _strided_byte_swap(dst, dstride, n, sizeof(ulonglong));
    }
}

static void
ULONGLONG_copyswap (void *dst, void *src, int swap, void *NPY_UNUSED(arr))
{

    if (src != NULL) {
        /* copy first if needed */
        memcpy(dst, src, sizeof(ulonglong));
    }
    if (swap) {
        char *a, *b, c;

        a = (char *)dst;
#if SIZEOF_LONGLONG == 2
        b = a + 1;
        c = *a; *a++ = *b; *b = c;
#elif SIZEOF_LONGLONG == 4
        b = a + 3;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_LONGLONG == 8
        b = a + 7;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_LONGLONG == 10
        b = a + 9;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_LONGLONG == 12
        b = a + 11;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_LONGLONG == 16
        b = a + 15;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#else
        {
            int i, nn;

            b = a + (NPY_SIZEOF_LONGLONG-1);
            nn = NPY_SIZEOF_LONGLONG / 2;
            for (i = 0; i < nn; i++) {
                c = *a;
                *a++ = *b;
                *b-- = c;
            }
        }
#endif
    }
}


static void
FLOAT_copyswapn (void *dst, npy_intp dstride, void *src, npy_intp sstride,
                   npy_intp n, int swap, void *NPY_UNUSED(arr))
{
    if (src != NULL) {
        if (sstride == sizeof(float) && dstride == sizeof(float)) {
            memcpy(dst, src, n*sizeof(float));
        }
        else {
            _unaligned_strided_byte_copy(dst, dstride, src, sstride,
                    n, sizeof(float));
        }
    }
    if (swap) {
        _strided_byte_swap(dst, dstride, n, sizeof(float));
    }
}

static void
FLOAT_copyswap (void *dst, void *src, int swap, void *NPY_UNUSED(arr))
{

    if (src != NULL) {
        /* copy first if needed */
        memcpy(dst, src, sizeof(float));
    }
    if (swap) {
        char *a, *b, c;

        a = (char *)dst;
#if SIZEOF_FLOAT == 2
        b = a + 1;
        c = *a; *a++ = *b; *b = c;
#elif SIZEOF_FLOAT == 4
        b = a + 3;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_FLOAT == 8
        b = a + 7;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_FLOAT == 10
        b = a + 9;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_FLOAT == 12
        b = a + 11;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_FLOAT == 16
        b = a + 15;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#else
        {
            int i, nn;

            b = a + (NPY_SIZEOF_FLOAT-1);
            nn = NPY_SIZEOF_FLOAT / 2;
            for (i = 0; i < nn; i++) {
                c = *a;
                *a++ = *b;
                *b-- = c;
            }
        }
#endif
    }
}


static void
DOUBLE_copyswapn (void *dst, npy_intp dstride, void *src, npy_intp sstride,
                   npy_intp n, int swap, void *NPY_UNUSED(arr))
{
    if (src != NULL) {
        if (sstride == sizeof(double) && dstride == sizeof(double)) {
            memcpy(dst, src, n*sizeof(double));
        }
        else {
            _unaligned_strided_byte_copy(dst, dstride, src, sstride,
                    n, sizeof(double));
        }
    }
    if (swap) {
        _strided_byte_swap(dst, dstride, n, sizeof(double));
    }
}

static void
DOUBLE_copyswap (void *dst, void *src, int swap, void *NPY_UNUSED(arr))
{

    if (src != NULL) {
        /* copy first if needed */
        memcpy(dst, src, sizeof(double));
    }
    if (swap) {
        char *a, *b, c;

        a = (char *)dst;
#if SIZEOF_DOUBLE == 2
        b = a + 1;
        c = *a; *a++ = *b; *b = c;
#elif SIZEOF_DOUBLE == 4
        b = a + 3;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_DOUBLE == 8
        b = a + 7;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_DOUBLE == 10
        b = a + 9;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_DOUBLE == 12
        b = a + 11;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_DOUBLE == 16
        b = a + 15;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#else
        {
            int i, nn;

            b = a + (NPY_SIZEOF_DOUBLE-1);
            nn = NPY_SIZEOF_DOUBLE / 2;
            for (i = 0; i < nn; i++) {
                c = *a;
                *a++ = *b;
                *b-- = c;
            }
        }
#endif
    }
}


static void
LONGDOUBLE_copyswapn (void *dst, npy_intp dstride, void *src, npy_intp sstride,
                   npy_intp n, int swap, void *NPY_UNUSED(arr))
{
    if (src != NULL) {
        if (sstride == sizeof(longdouble) && dstride == sizeof(longdouble)) {
            memcpy(dst, src, n*sizeof(longdouble));
        }
        else {
            _unaligned_strided_byte_copy(dst, dstride, src, sstride,
                    n, sizeof(longdouble));
        }
    }
    if (swap) {
        _strided_byte_swap(dst, dstride, n, sizeof(longdouble));
    }
}

static void
LONGDOUBLE_copyswap (void *dst, void *src, int swap, void *NPY_UNUSED(arr))
{

    if (src != NULL) {
        /* copy first if needed */
        memcpy(dst, src, sizeof(longdouble));
    }
    if (swap) {
        char *a, *b, c;

        a = (char *)dst;
#if SIZEOF_LONGDOUBLE == 2
        b = a + 1;
        c = *a; *a++ = *b; *b = c;
#elif SIZEOF_LONGDOUBLE == 4
        b = a + 3;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_LONGDOUBLE == 8
        b = a + 7;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_LONGDOUBLE == 10
        b = a + 9;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_LONGDOUBLE == 12
        b = a + 11;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_LONGDOUBLE == 16
        b = a + 15;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#else
        {
            int i, nn;

            b = a + (NPY_SIZEOF_LONGDOUBLE-1);
            nn = NPY_SIZEOF_LONGDOUBLE / 2;
            for (i = 0; i < nn; i++) {
                c = *a;
                *a++ = *b;
                *b-- = c;
            }
        }
#endif
    }
}


static void
DATETIME_copyswapn (void *dst, npy_intp dstride, void *src, npy_intp sstride,
                   npy_intp n, int swap, void *NPY_UNUSED(arr))
{
    if (src != NULL) {
        if (sstride == sizeof(datetime) && dstride == sizeof(datetime)) {
            memcpy(dst, src, n*sizeof(datetime));
        }
        else {
            _unaligned_strided_byte_copy(dst, dstride, src, sstride,
                    n, sizeof(datetime));
        }
    }
    if (swap) {
        _strided_byte_swap(dst, dstride, n, sizeof(datetime));
    }
}

static void
DATETIME_copyswap (void *dst, void *src, int swap, void *NPY_UNUSED(arr))
{

    if (src != NULL) {
        /* copy first if needed */
        memcpy(dst, src, sizeof(datetime));
    }
    if (swap) {
        char *a, *b, c;

        a = (char *)dst;
#if SIZEOF_DATETIME == 2
        b = a + 1;
        c = *a; *a++ = *b; *b = c;
#elif SIZEOF_DATETIME == 4
        b = a + 3;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_DATETIME == 8
        b = a + 7;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_DATETIME == 10
        b = a + 9;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_DATETIME == 12
        b = a + 11;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_DATETIME == 16
        b = a + 15;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#else
        {
            int i, nn;

            b = a + (NPY_SIZEOF_DATETIME-1);
            nn = NPY_SIZEOF_DATETIME / 2;
            for (i = 0; i < nn; i++) {
                c = *a;
                *a++ = *b;
                *b-- = c;
            }
        }
#endif
    }
}


static void
TIMEDELTA_copyswapn (void *dst, npy_intp dstride, void *src, npy_intp sstride,
                   npy_intp n, int swap, void *NPY_UNUSED(arr))
{
    if (src != NULL) {
        if (sstride == sizeof(timedelta) && dstride == sizeof(timedelta)) {
            memcpy(dst, src, n*sizeof(timedelta));
        }
        else {
            _unaligned_strided_byte_copy(dst, dstride, src, sstride,
                    n, sizeof(timedelta));
        }
    }
    if (swap) {
        _strided_byte_swap(dst, dstride, n, sizeof(timedelta));
    }
}

static void
TIMEDELTA_copyswap (void *dst, void *src, int swap, void *NPY_UNUSED(arr))
{

    if (src != NULL) {
        /* copy first if needed */
        memcpy(dst, src, sizeof(timedelta));
    }
    if (swap) {
        char *a, *b, c;

        a = (char *)dst;
#if SIZEOF_TIMEDELTA == 2
        b = a + 1;
        c = *a; *a++ = *b; *b = c;
#elif SIZEOF_TIMEDELTA == 4
        b = a + 3;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_TIMEDELTA == 8
        b = a + 7;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_TIMEDELTA == 10
        b = a + 9;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_TIMEDELTA == 12
        b = a + 11;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_TIMEDELTA == 16
        b = a + 15;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#else
        {
            int i, nn;

            b = a + (NPY_SIZEOF_TIMEDELTA-1);
            nn = NPY_SIZEOF_TIMEDELTA / 2;
            for (i = 0; i < nn; i++) {
                c = *a;
                *a++ = *b;
                *b-- = c;
            }
        }
#endif
    }
}



static void
BOOL_copyswapn (void *dst, npy_intp dstride, void *src, npy_intp sstride, npy_intp n,
                   int NPY_UNUSED(swap), void *NPY_UNUSED(arr))
{
    if (src != NULL) {
        if (sstride == sizeof(Bool) && dstride == sizeof(Bool)) {
            memcpy(dst, src, n*sizeof(Bool));
        }
        else {
            _unaligned_strided_byte_copy(dst, dstride, src, sstride,
                    n, sizeof(Bool));
        }
    }
    /* ignore swap */
}

static void
BOOL_copyswap (void *dst, void *src, int NPY_UNUSED(swap), void *NPY_UNUSED(arr))
{
    if (src != NULL) {
        /* copy first if needed */
        memcpy(dst, src, sizeof(Bool));
    }
    /* ignore swap */
}


static void
BYTE_copyswapn (void *dst, npy_intp dstride, void *src, npy_intp sstride, npy_intp n,
                   int NPY_UNUSED(swap), void *NPY_UNUSED(arr))
{
    if (src != NULL) {
        if (sstride == sizeof(byte) && dstride == sizeof(byte)) {
            memcpy(dst, src, n*sizeof(byte));
        }
        else {
            _unaligned_strided_byte_copy(dst, dstride, src, sstride,
                    n, sizeof(byte));
        }
    }
    /* ignore swap */
}

static void
BYTE_copyswap (void *dst, void *src, int NPY_UNUSED(swap), void *NPY_UNUSED(arr))
{
    if (src != NULL) {
        /* copy first if needed */
        memcpy(dst, src, sizeof(byte));
    }
    /* ignore swap */
}


static void
UBYTE_copyswapn (void *dst, npy_intp dstride, void *src, npy_intp sstride, npy_intp n,
                   int NPY_UNUSED(swap), void *NPY_UNUSED(arr))
{
    if (src != NULL) {
        if (sstride == sizeof(ubyte) && dstride == sizeof(ubyte)) {
            memcpy(dst, src, n*sizeof(ubyte));
        }
        else {
            _unaligned_strided_byte_copy(dst, dstride, src, sstride,
                    n, sizeof(ubyte));
        }
    }
    /* ignore swap */
}

static void
UBYTE_copyswap (void *dst, void *src, int NPY_UNUSED(swap), void *NPY_UNUSED(arr))
{
    if (src != NULL) {
        /* copy first if needed */
        memcpy(dst, src, sizeof(ubyte));
    }
    /* ignore swap */
}





static void
CFLOAT_copyswapn (void *dst, npy_intp dstride, void *src, npy_intp sstride, npy_intp n,
                   int swap, void *NPY_UNUSED(arr))
{

    if (src != NULL) {
        /* copy first if needed */
        if (sstride == sizeof(cfloat) && dstride == sizeof(cfloat)) {
            memcpy(dst, src, n*sizeof(cfloat));
        }
        else {
            _unaligned_strided_byte_copy(dst, dstride, src, sstride, n,
                    sizeof(cfloat));
        }
    }

    if (swap) {
        _strided_byte_swap(dst, dstride, n, NPY_SIZEOF_FLOAT);
        _strided_byte_swap(((char *)dst + NPY_SIZEOF_FLOAT), dstride,
                n, NPY_SIZEOF_FLOAT);
    }
}

static void
CFLOAT_copyswap (void *dst, void *src, int swap, void *NPY_UNUSED(arr))
{
    if (src != NULL) /* copy first if needed */
        memcpy(dst, src, sizeof(cfloat));

    if (swap) {
        char *a, *b, c;
        a = (char *)dst;
#if SIZEOF_FLOAT == 4
        b = a + 3;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
        a += 2;
        b = a + 3;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_FLOAT == 8
        b = a + 7;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
        a += 4;
        b = a + 7;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_FLOAT == 10
        b = a + 9;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
        a += 5;
        b = a + 9;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_FLOAT == 12
        b = a + 11;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
        a += 6;
        b = a + 11;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_FLOAT == 16
        b = a + 15;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
        a += 8;
        b = a + 15;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#else
        {
            int i, nn;

            b = a + (NPY_SIZEOF_FLOAT - 1);
            nn = NPY_SIZEOF_FLOAT / 2;
            for (i = 0; i < nn; i++) {
                c = *a;
                *a++ = *b;
                *b-- = c;
            }
            a += nn / 2;
            b = a + (NPY_SIZEOF_FLOAT - 1);
            nn = NPY_SIZEOF_FLOAT / 2;
            for (i = 0; i < nn; i++) {
                c = *a;
                *a++ = *b;
                *b-- = c;
            }
        }
#endif
    }
}


static void
CDOUBLE_copyswapn (void *dst, npy_intp dstride, void *src, npy_intp sstride, npy_intp n,
                   int swap, void *NPY_UNUSED(arr))
{

    if (src != NULL) {
        /* copy first if needed */
        if (sstride == sizeof(cdouble) && dstride == sizeof(cdouble)) {
            memcpy(dst, src, n*sizeof(cdouble));
        }
        else {
            _unaligned_strided_byte_copy(dst, dstride, src, sstride, n,
                    sizeof(cdouble));
        }
    }

    if (swap) {
        _strided_byte_swap(dst, dstride, n, NPY_SIZEOF_DOUBLE);
        _strided_byte_swap(((char *)dst + NPY_SIZEOF_DOUBLE), dstride,
                n, NPY_SIZEOF_DOUBLE);
    }
}

static void
CDOUBLE_copyswap (void *dst, void *src, int swap, void *NPY_UNUSED(arr))
{
    if (src != NULL) /* copy first if needed */
        memcpy(dst, src, sizeof(cdouble));

    if (swap) {
        char *a, *b, c;
        a = (char *)dst;
#if SIZEOF_DOUBLE == 4
        b = a + 3;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
        a += 2;
        b = a + 3;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_DOUBLE == 8
        b = a + 7;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
        a += 4;
        b = a + 7;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_DOUBLE == 10
        b = a + 9;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
        a += 5;
        b = a + 9;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_DOUBLE == 12
        b = a + 11;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
        a += 6;
        b = a + 11;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_DOUBLE == 16
        b = a + 15;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
        a += 8;
        b = a + 15;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#else
        {
            int i, nn;

            b = a + (NPY_SIZEOF_DOUBLE - 1);
            nn = NPY_SIZEOF_DOUBLE / 2;
            for (i = 0; i < nn; i++) {
                c = *a;
                *a++ = *b;
                *b-- = c;
            }
            a += nn / 2;
            b = a + (NPY_SIZEOF_DOUBLE - 1);
            nn = NPY_SIZEOF_DOUBLE / 2;
            for (i = 0; i < nn; i++) {
                c = *a;
                *a++ = *b;
                *b-- = c;
            }
        }
#endif
    }
}


static void
CLONGDOUBLE_copyswapn (void *dst, npy_intp dstride, void *src, npy_intp sstride, npy_intp n,
                   int swap, void *NPY_UNUSED(arr))
{

    if (src != NULL) {
        /* copy first if needed */
        if (sstride == sizeof(clongdouble) && dstride == sizeof(clongdouble)) {
            memcpy(dst, src, n*sizeof(clongdouble));
        }
        else {
            _unaligned_strided_byte_copy(dst, dstride, src, sstride, n,
                    sizeof(clongdouble));
        }
    }

    if (swap) {
        _strided_byte_swap(dst, dstride, n, NPY_SIZEOF_LONGDOUBLE);
        _strided_byte_swap(((char *)dst + NPY_SIZEOF_LONGDOUBLE), dstride,
                n, NPY_SIZEOF_LONGDOUBLE);
    }
}

static void
CLONGDOUBLE_copyswap (void *dst, void *src, int swap, void *NPY_UNUSED(arr))
{
    if (src != NULL) /* copy first if needed */
        memcpy(dst, src, sizeof(clongdouble));

    if (swap) {
        char *a, *b, c;
        a = (char *)dst;
#if SIZEOF_LONGDOUBLE == 4
        b = a + 3;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
        a += 2;
        b = a + 3;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_LONGDOUBLE == 8
        b = a + 7;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
        a += 4;
        b = a + 7;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_LONGDOUBLE == 10
        b = a + 9;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
        a += 5;
        b = a + 9;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_LONGDOUBLE == 12
        b = a + 11;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
        a += 6;
        b = a + 11;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#elif SIZEOF_LONGDOUBLE == 16
        b = a + 15;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
        a += 8;
        b = a + 15;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b-- = c;
        c = *a; *a++ = *b; *b   = c;
#else
        {
            int i, nn;

            b = a + (NPY_SIZEOF_LONGDOUBLE - 1);
            nn = NPY_SIZEOF_LONGDOUBLE / 2;
            for (i = 0; i < nn; i++) {
                c = *a;
                *a++ = *b;
                *b-- = c;
            }
            a += nn / 2;
            b = a + (NPY_SIZEOF_LONGDOUBLE - 1);
            nn = NPY_SIZEOF_LONGDOUBLE / 2;
            for (i = 0; i < nn; i++) {
                c = *a;
                *a++ = *b;
                *b-- = c;
            }
        }
#endif
    }
}




/* ignore swap */
static void
STRING_copyswapn (char *dst, npy_intp dstride, char *src, npy_intp sstride,
                  npy_intp n, int NPY_UNUSED(swap), NpyArray *arr)
{
    if (src != NULL && arr != NULL) {
        int itemsize = arr->descr->elsize;

        if (dstride == itemsize && sstride == itemsize) {
            memcpy(dst, src, itemsize * n);
        }
        else {
            _unaligned_strided_byte_copy(dst, dstride, src, sstride, n,
                    itemsize);
        }
    }
    return;
}

/* */
static void
VOID_copyswapn (char *dst, npy_intp dstride, char *src, npy_intp sstride,
                npy_intp n, int swap, NpyArray *arr)
{
    if (arr == NULL) {
        return;
    }
    if (NpyArray_HASFIELDS(arr)) {
        const char *key;
        NpyArray_Descr *descr;
        NpyArray_DescrField *value;
        NpyDict_Iter pos;

        descr = arr->descr;
        NpyDict_IterInit(&pos);
        while (NpyDict_IterNext(descr->fields, &pos, (void **)&key, (void **)&value)) {
            if (NULL != value->title && !strcmp(value->title, key)) {
                continue;
            }
            arr->descr = value->descr;
            value->descr->f->copyswapn(dst + value->offset, dstride,
                    (src != NULL ? src + value->offset : NULL),
                    sstride, n, swap, arr);
        }
        arr->descr = descr;
        return;
    }
    if (swap && arr->descr->subarray != NULL) {
        NpyArray_Descr *descr, *new;
        npy_intp num;
        npy_intp i;
        int subitemsize;
        char *dstptr, *srcptr;

        descr = arr->descr;
        new = descr->subarray->base;
        arr->descr = new;
        dstptr = dst;
        srcptr = src;
        subitemsize = new->elsize;
        num = descr->elsize / subitemsize;
        for (i = 0; i < n; i++) {
            new->f->copyswapn(dstptr, subitemsize, srcptr,
                    subitemsize, num, swap, arr);
            dstptr += dstride;
            if (srcptr) {
                srcptr += sstride;
            }
        }
        arr->descr = descr;
        return;
    }
    if (src != NULL) {
        memcpy(dst, src, arr->descr->elsize * n);
    }
    return;
}

static void
VOID_copyswap (char *dst, char *src, int swap, NpyArray *arr)
{
    if (arr == NULL) {
        return;
    }
    if (NpyArray_HASFIELDS(arr)) {
        const char *key;
        NpyArray_Descr *descr;
        NpyArray_DescrField *value;
        NpyDict_Iter pos;

        descr = arr->descr;
        NpyDict_IterInit(&pos);
        while (NpyDict_IterNext(descr->fields, &pos, (void **)&key, (void **)&value)) {
            if (NULL != value->title && !strcmp(value->title, key)) {
                continue;
            }
            arr->descr = value->descr;
            value->descr->f->copyswap(dst + value->offset,
                    (src != NULL ? src + value->offset : NULL),
                    swap, arr);
        }
        arr->descr = descr;
        return;
    }
    if (swap && arr->descr->subarray != NULL) {
        NpyArray_Descr *descr, *new;
        npy_intp num;
        int itemsize;

        descr = arr->descr;
        new = descr->subarray->base;
        arr->descr = new;
        itemsize = new->elsize;
        num = descr->elsize / itemsize;
        new->f->copyswapn(dst, itemsize, src,
                itemsize, num, swap, arr);
        arr->descr = descr;
        return;
    }
    if (src != NULL) {
        memcpy(dst, src, arr->descr->elsize);
    }
    return;
}


static void
UNICODE_copyswapn (char *dst, npy_intp dstride, char *src, npy_intp sstride,
                   npy_intp n, int swap, NpyArray *arr)
{
    int itemsize;

    if (arr == NULL) {
        return;
    }
    itemsize = arr->descr->elsize;
    if (src != NULL) {
        if (dstride == itemsize && sstride == itemsize) {
            memcpy(dst, src, n * itemsize);
        }
        else {
            _unaligned_strided_byte_copy(dst, dstride, src,
                    sstride, n, itemsize);
        }
    }

    n *= itemsize;
    if (swap) {
        char *a, *b, c;

        /* n is the number of unicode characters to swap */
        n >>= 2;
        for (a = (char *)dst; n > 0; n--) {
            b = a + 3;
            c = *a;
            *a++ = *b;
            *b-- = c;
            c = *a;
            *a++ = *b;
            *b-- = c;
            a += 2;
        }
    }
}


static void
STRING_copyswap(char *dst, char *src, int NPY_UNUSED(swap), NpyArray *arr)
{
    if (src != NULL && arr != NULL) {
        memcpy(dst, src, arr->descr->elsize);
    }
}

static void
UNICODE_copyswap (char *dst, char *src, int swap, NpyArray *arr)
{
    int itemsize;

    if (arr == NULL) {
        return;
    }
    itemsize = arr->descr->elsize;
    if (src != NULL) {
        memcpy(dst, src, itemsize);
    }

    if (swap) {
        char *a, *b, c;
        itemsize >>= 2;
        for (a = (char *)dst; itemsize>0; itemsize--) {
            b = a + 3;
            c = *a;
            *a++ = *b;
            *b-- = c;
            c = *a;
            *a++ = *b;
            *b-- = c;
            a += 2;
        }
    }
}



/*
 *****************************************************************************
 **                                 NONZERO                                 **
 *****************************************************************************
 */

static Bool
BOOL_nonzero (char *ip, NpyArray *ap)
{
    if (ap == NULL || NpyArray_ISBEHAVED_RO(ap)) {
        Bool *ptmp = (Bool *)ip;
        return (Bool) (*ptmp != 0);
    }
    else {
        /*
         * don't worry about swap, since we are just testing
         * whether or not equal to 0
         */
        Bool tmp;
        memcpy(&tmp, ip, sizeof(Bool));
        return (Bool) (tmp != 0);
    }
}

static Bool
BYTE_nonzero (char *ip, NpyArray *ap)
{
    if (ap == NULL || NpyArray_ISBEHAVED_RO(ap)) {
        byte *ptmp = (byte *)ip;
        return (Bool) (*ptmp != 0);
    }
    else {
        /*
         * don't worry about swap, since we are just testing
         * whether or not equal to 0
         */
        byte tmp;
        memcpy(&tmp, ip, sizeof(byte));
        return (Bool) (tmp != 0);
    }
}

static Bool
UBYTE_nonzero (char *ip, NpyArray *ap)
{
    if (ap == NULL || NpyArray_ISBEHAVED_RO(ap)) {
        ubyte *ptmp = (ubyte *)ip;
        return (Bool) (*ptmp != 0);
    }
    else {
        /*
         * don't worry about swap, since we are just testing
         * whether or not equal to 0
         */
        ubyte tmp;
        memcpy(&tmp, ip, sizeof(ubyte));
        return (Bool) (tmp != 0);
    }
}

static Bool
SHORT_nonzero (char *ip, NpyArray *ap)
{
    if (ap == NULL || NpyArray_ISBEHAVED_RO(ap)) {
        short *ptmp = (short *)ip;
        return (Bool) (*ptmp != 0);
    }
    else {
        /*
         * don't worry about swap, since we are just testing
         * whether or not equal to 0
         */
        short tmp;
        memcpy(&tmp, ip, sizeof(short));
        return (Bool) (tmp != 0);
    }
}

static Bool
USHORT_nonzero (char *ip, NpyArray *ap)
{
    if (ap == NULL || NpyArray_ISBEHAVED_RO(ap)) {
        ushort *ptmp = (ushort *)ip;
        return (Bool) (*ptmp != 0);
    }
    else {
        /*
         * don't worry about swap, since we are just testing
         * whether or not equal to 0
         */
        ushort tmp;
        memcpy(&tmp, ip, sizeof(ushort));
        return (Bool) (tmp != 0);
    }
}

static Bool
INT_nonzero (char *ip, NpyArray *ap)
{
    if (ap == NULL || NpyArray_ISBEHAVED_RO(ap)) {
        int *ptmp = (int *)ip;
        return (Bool) (*ptmp != 0);
    }
    else {
        /*
         * don't worry about swap, since we are just testing
         * whether or not equal to 0
         */
        int tmp;
        memcpy(&tmp, ip, sizeof(int));
        return (Bool) (tmp != 0);
    }
}

static Bool
UINT_nonzero (char *ip, NpyArray *ap)
{
    if (ap == NULL || NpyArray_ISBEHAVED_RO(ap)) {
        uint *ptmp = (uint *)ip;
        return (Bool) (*ptmp != 0);
    }
    else {
        /*
         * don't worry about swap, since we are just testing
         * whether or not equal to 0
         */
        uint tmp;
        memcpy(&tmp, ip, sizeof(uint));
        return (Bool) (tmp != 0);
    }
}

static Bool
LONG_nonzero (char *ip, NpyArray *ap)
{
    if (ap == NULL || NpyArray_ISBEHAVED_RO(ap)) {
        long *ptmp = (long *)ip;
        return (Bool) (*ptmp != 0);
    }
    else {
        /*
         * don't worry about swap, since we are just testing
         * whether or not equal to 0
         */
        long tmp;
        memcpy(&tmp, ip, sizeof(long));
        return (Bool) (tmp != 0);
    }
}

static Bool
ULONG_nonzero (char *ip, NpyArray *ap)
{
    if (ap == NULL || NpyArray_ISBEHAVED_RO(ap)) {
        ulong *ptmp = (ulong *)ip;
        return (Bool) (*ptmp != 0);
    }
    else {
        /*
         * don't worry about swap, since we are just testing
         * whether or not equal to 0
         */
        ulong tmp;
        memcpy(&tmp, ip, sizeof(ulong));
        return (Bool) (tmp != 0);
    }
}

static Bool
LONGLONG_nonzero (char *ip, NpyArray *ap)
{
    if (ap == NULL || NpyArray_ISBEHAVED_RO(ap)) {
        longlong *ptmp = (longlong *)ip;
        return (Bool) (*ptmp != 0);
    }
    else {
        /*
         * don't worry about swap, since we are just testing
         * whether or not equal to 0
         */
        longlong tmp;
        memcpy(&tmp, ip, sizeof(longlong));
        return (Bool) (tmp != 0);
    }
}

static Bool
ULONGLONG_nonzero (char *ip, NpyArray *ap)
{
    if (ap == NULL || NpyArray_ISBEHAVED_RO(ap)) {
        ulonglong *ptmp = (ulonglong *)ip;
        return (Bool) (*ptmp != 0);
    }
    else {
        /*
         * don't worry about swap, since we are just testing
         * whether or not equal to 0
         */
        ulonglong tmp;
        memcpy(&tmp, ip, sizeof(ulonglong));
        return (Bool) (tmp != 0);
    }
}

static Bool
FLOAT_nonzero (char *ip, NpyArray *ap)
{
    if (ap == NULL || NpyArray_ISBEHAVED_RO(ap)) {
        float *ptmp = (float *)ip;
        return (Bool) (*ptmp != 0);
    }
    else {
        /*
         * don't worry about swap, since we are just testing
         * whether or not equal to 0
         */
        float tmp;
        memcpy(&tmp, ip, sizeof(float));
        return (Bool) (tmp != 0);
    }
}

static Bool
DOUBLE_nonzero (char *ip, NpyArray *ap)
{
    if (ap == NULL || NpyArray_ISBEHAVED_RO(ap)) {
        double *ptmp = (double *)ip;
        return (Bool) (*ptmp != 0);
    }
    else {
        /*
         * don't worry about swap, since we are just testing
         * whether or not equal to 0
         */
        double tmp;
        memcpy(&tmp, ip, sizeof(double));
        return (Bool) (tmp != 0);
    }
}

static Bool
LONGDOUBLE_nonzero (char *ip, NpyArray *ap)
{
    if (ap == NULL || NpyArray_ISBEHAVED_RO(ap)) {
        longdouble *ptmp = (longdouble *)ip;
        return (Bool) (*ptmp != 0);
    }
    else {
        /*
         * don't worry about swap, since we are just testing
         * whether or not equal to 0
         */
        longdouble tmp;
        memcpy(&tmp, ip, sizeof(longdouble));
        return (Bool) (tmp != 0);
    }
}

static Bool
DATETIME_nonzero (char *ip, NpyArray *ap)
{
    if (ap == NULL || NpyArray_ISBEHAVED_RO(ap)) {
        datetime *ptmp = (datetime *)ip;
        return (Bool) (*ptmp != 0);
    }
    else {
        /*
         * don't worry about swap, since we are just testing
         * whether or not equal to 0
         */
        datetime tmp;
        memcpy(&tmp, ip, sizeof(datetime));
        return (Bool) (tmp != 0);
    }
}

static Bool
TIMEDELTA_nonzero (char *ip, NpyArray *ap)
{
    if (ap == NULL || NpyArray_ISBEHAVED_RO(ap)) {
        timedelta *ptmp = (timedelta *)ip;
        return (Bool) (*ptmp != 0);
    }
    else {
        /*
         * don't worry about swap, since we are just testing
         * whether or not equal to 0
         */
        timedelta tmp;
        memcpy(&tmp, ip, sizeof(timedelta));
        return (Bool) (tmp != 0);
    }
}


static Bool
CFLOAT_nonzero (char *ip, NpyArray *ap)
{
    if (ap == NULL || NpyArray_ISBEHAVED_RO(ap)) {
        cfloat *ptmp = (cfloat *)ip;
        return (Bool) ((ptmp->real != 0) || (ptmp->imag != 0));
    }
    else {
        /*
         * don't worry about swap, since we are just testing
         * whether or not equal to 0
         */
        cfloat tmp;
        memcpy(&tmp, ip, sizeof(cfloat));
        return (Bool) ((tmp.real != 0) || (tmp.imag != 0));
    }
}

static Bool
CDOUBLE_nonzero (char *ip, NpyArray *ap)
{
    if (ap == NULL || NpyArray_ISBEHAVED_RO(ap)) {
        cdouble *ptmp = (cdouble *)ip;
        return (Bool) ((ptmp->real != 0) || (ptmp->imag != 0));
    }
    else {
        /*
         * don't worry about swap, since we are just testing
         * whether or not equal to 0
         */
        cdouble tmp;
        memcpy(&tmp, ip, sizeof(cdouble));
        return (Bool) ((tmp.real != 0) || (tmp.imag != 0));
    }
}

static Bool
CLONGDOUBLE_nonzero (char *ip, NpyArray *ap)
{
    if (ap == NULL || NpyArray_ISBEHAVED_RO(ap)) {
        clongdouble *ptmp = (clongdouble *)ip;
        return (Bool) ((ptmp->real != 0) || (ptmp->imag != 0));
    }
    else {
        /*
         * don't worry about swap, since we are just testing
         * whether or not equal to 0
         */
        clongdouble tmp;
        memcpy(&tmp, ip, sizeof(clongdouble));
        return (Bool) ((tmp.real != 0) || (tmp.imag != 0));
    }
}



#define WHITESPACE " \t\n\r\v\f"
#define WHITELEN 6

static Bool
Npy_STRING_ISSPACE(char ch)
{
    char white[] = WHITESPACE;
    int j;
    Bool space = FALSE;

    for (j = 0; j < WHITELEN; j++) {
        if (ch == white[j]) {
            space = TRUE;
            break;
        }
    }
    return space;
}

static Bool
STRING_nonzero (char *ip, NpyArray *ap)
{
    int len = ap->descr->elsize;
    int i;
    Bool nonz = FALSE;

    for (i = 0; i < len; i++) {
        if (!Npy_STRING_ISSPACE(*ip)) {
            nonz = TRUE;
            break;
        }
        ip++;
    }
    return nonz;
}


static Bool
UNICODE_nonzero (npy_ucs4 *ip, NpyArray *ap)
{
    int len = ap->descr->elsize >> 2;
    int i;
    Bool nonz = FALSE;
    char *buffer = NULL;

    if ((!NpyArray_ISNOTSWAPPED(ap)) || (!NpyArray_ISALIGNED(ap))) {
        buffer = NpyArray_malloc(ap->descr->elsize);
        if (buffer == NULL) {
            return nonz;
        }
        memcpy(buffer, ip, ap->descr->elsize);
        if (!NpyArray_ISNOTSWAPPED(ap)) {
            byte_swap_vector(buffer, len, 4);
        }
        ip = (npy_ucs4 *)buffer;
    }

    for (i = 0; i < len; i++) {
        if (!NpyArray_UCS4_ISSPACE(*ip)) {
            nonz = TRUE;
            break;
        }
        ip++;
    }
    NpyArray_free(buffer);
    return nonz;
}



/*
 * if we have fields, then nonzero only if all sub-fields are nonzero.
 */
static Bool
VOID_nonzero (char *ip, NpyArray *ap)
{
    int i;
    int len;
    Bool nonz = FALSE;

    if (NpyArray_HASFIELDS(ap)) {
        NpyArray_Descr *descr, *new;
        const char *key;
        NpyArray_DescrField *value;
        int savedflags;
        NpyDict_Iter pos;

        descr = ap->descr;
        savedflags = ap->flags;
        NpyDict_IterInit(&pos);
        while (NpyDict_IterNext(descr->fields, &pos, (void **)&key, (void **)&value)) {
            if (NULL != value->title && !strcmp(value->title, key)) {
                continue;
            }
            new = value->descr;
            ap->descr = new;
            ap->flags = savedflags;
            if ((new->alignment > 1) && !__ALIGNED(ip + value->offset, new->alignment)) {
                ap->flags &= ~ALIGNED;
            }
            else {
                ap->flags |= ALIGNED;
            }
            if (new->f->nonzero(ip + value->offset, ap)) {
                nonz = TRUE;
                break;
            }
        }
        ap->descr = descr;
        ap->flags = savedflags;
        return nonz;
    }
    len = ap->descr->elsize;
    for (i = 0; i < len; i++) {
        if (*ip != '\0') {
            nonz = TRUE;
            break;
        }
        ip++;
    }
    return nonz;
}

#undef __ALIGNED


/*
 *****************************************************************************
 **                                 COMPARE                                 **
 *****************************************************************************
 */


/* boolean type */

static int
BOOL_compare(Bool *ip1, Bool *ip2, NpyArray *NPY_UNUSED(ap))
{
    return (*ip1 ? (*ip2 ? 0 : 1) : (*ip2 ? -1 : 0));
}


/* integer types */


static int
BYTE_compare (byte *pa, byte *pb, NpyArray *NPY_UNUSED(ap))
{
    const byte a = *pa;
    const byte b = *pb;

    return a < b ? -1 : a == b ? 0 : 1;
}



static int
UBYTE_compare (ubyte *pa, ubyte *pb, NpyArray *NPY_UNUSED(ap))
{
    const ubyte a = *pa;
    const ubyte b = *pb;

    return a < b ? -1 : a == b ? 0 : 1;
}



static int
SHORT_compare (short *pa, short *pb, NpyArray *NPY_UNUSED(ap))
{
    const short a = *pa;
    const short b = *pb;

    return a < b ? -1 : a == b ? 0 : 1;
}



static int
USHORT_compare (ushort *pa, ushort *pb, NpyArray *NPY_UNUSED(ap))
{
    const ushort a = *pa;
    const ushort b = *pb;

    return a < b ? -1 : a == b ? 0 : 1;
}



static int
INT_compare (int *pa, int *pb, NpyArray *NPY_UNUSED(ap))
{
    const int a = *pa;
    const int b = *pb;

    return a < b ? -1 : a == b ? 0 : 1;
}



static int
UINT_compare (uint *pa, uint *pb, NpyArray *NPY_UNUSED(ap))
{
    const uint a = *pa;
    const uint b = *pb;

    return a < b ? -1 : a == b ? 0 : 1;
}



static int
LONG_compare (long *pa, long *pb, NpyArray *NPY_UNUSED(ap))
{
    const long a = *pa;
    const long b = *pb;

    return a < b ? -1 : a == b ? 0 : 1;
}



static int
ULONG_compare (ulong *pa, ulong *pb, NpyArray *NPY_UNUSED(ap))
{
    const ulong a = *pa;
    const ulong b = *pb;

    return a < b ? -1 : a == b ? 0 : 1;
}



static int
LONGLONG_compare (longlong *pa, longlong *pb, NpyArray *NPY_UNUSED(ap))
{
    const longlong a = *pa;
    const longlong b = *pb;

    return a < b ? -1 : a == b ? 0 : 1;
}



static int
ULONGLONG_compare (ulonglong *pa, ulonglong *pb, NpyArray *NPY_UNUSED(ap))
{
    const ulonglong a = *pa;
    const ulonglong b = *pb;

    return a < b ? -1 : a == b ? 0 : 1;
}



static int
DATETIME_compare (datetime *pa, datetime *pb, NpyArray *NPY_UNUSED(ap))
{
    const datetime a = *pa;
    const datetime b = *pb;

    return a < b ? -1 : a == b ? 0 : 1;
}



static int
TIMEDELTA_compare (timedelta *pa, timedelta *pb, NpyArray *NPY_UNUSED(ap))
{
    const timedelta a = *pa;
    const timedelta b = *pb;

    return a < b ? -1 : a == b ? 0 : 1;
}




/* float types */

/*
 * The real/complex comparison functions are compatible with the new sort
 * order for nans introduced in numpy 1.4.0. All nan values now compare
 * larger than non-nan values and are sorted to the end. The comparison
 * order is:
 *
 *      Real: [R, nan]
 *      Complex: [R + Rj, R + nanj, nan + Rj, nan + nanj]
 *
 *  where complex values with the same nan placements are sorted according
 *  to the non-nan part if it exists. If both the real and imaginary parts
 *  of complex types are non-nan the order is the same as the real parts
 *  unless they happen to be equal, in which case the order is that of the
 *  imaginary parts.
 */


#define LT(a,b) ((a) < (b) || ((b) != (b) && (a) ==(a)))

static int
FLOAT_compare(float *pa, float *pb)
{
    const float a = *pa;
    const float b = *pb;
    int ret;

    if (LT(a,b)) {
        ret = -1;
    }
    else if (LT(b,a)) {
        ret = 1;
    }
    else {
        ret = 0;
    }
    return ret;
}


static int
CFLOAT_compare(float *pa, float *pb)
{
    const float ar = pa[0];
    const float ai = pa[1];
    const float br = pb[0];
    const float bi = pb[1];
    int ret;

    if (ar < br) {
        if (ai == ai || bi != bi) {
            ret = -1;
        }
        else {
            ret = 1;
        }
    }
    else if (br < ar) {
        if (bi == bi || ai != ai) {
            ret = 1;
        }
        else {
            ret = -1;
        }
    }
    else if (ar == br || (ar != ar && br != br)) {
        if (LT(ai,bi)) {
            ret = -1;
        }
        else if (LT(bi,ai)) {
            ret = 1;
        }
        else {
            ret = 0;
        }
    }
    else if (ar == ar) {
        ret = -1;
    }
    else {
        ret = 1;
    }

    return ret;
}

#undef LT



#define LT(a,b) ((a) < (b) || ((b) != (b) && (a) ==(a)))

static int
DOUBLE_compare(double *pa, double *pb)
{
    const double a = *pa;
    const double b = *pb;
    int ret;

    if (LT(a,b)) {
        ret = -1;
    }
    else if (LT(b,a)) {
        ret = 1;
    }
    else {
        ret = 0;
    }
    return ret;
}


static int
CDOUBLE_compare(double *pa, double *pb)
{
    const double ar = pa[0];
    const double ai = pa[1];
    const double br = pb[0];
    const double bi = pb[1];
    int ret;

    if (ar < br) {
        if (ai == ai || bi != bi) {
            ret = -1;
        }
        else {
            ret = 1;
        }
    }
    else if (br < ar) {
        if (bi == bi || ai != ai) {
            ret = 1;
        }
        else {
            ret = -1;
        }
    }
    else if (ar == br || (ar != ar && br != br)) {
        if (LT(ai,bi)) {
            ret = -1;
        }
        else if (LT(bi,ai)) {
            ret = 1;
        }
        else {
            ret = 0;
        }
    }
    else if (ar == ar) {
        ret = -1;
    }
    else {
        ret = 1;
    }

    return ret;
}

#undef LT



#define LT(a,b) ((a) < (b) || ((b) != (b) && (a) ==(a)))

static int
LONGDOUBLE_compare(longdouble *pa, longdouble *pb)
{
    const longdouble a = *pa;
    const longdouble b = *pb;
    int ret;

    if (LT(a,b)) {
        ret = -1;
    }
    else if (LT(b,a)) {
        ret = 1;
    }
    else {
        ret = 0;
    }
    return ret;
}


static int
CLONGDOUBLE_compare(longdouble *pa, longdouble *pb)
{
    const longdouble ar = pa[0];
    const longdouble ai = pa[1];
    const longdouble br = pb[0];
    const longdouble bi = pb[1];
    int ret;

    if (ar < br) {
        if (ai == ai || bi != bi) {
            ret = -1;
        }
        else {
            ret = 1;
        }
    }
    else if (br < ar) {
        if (bi == bi || ai != ai) {
            ret = 1;
        }
        else {
            ret = -1;
        }
    }
    else if (ar == br || (ar != ar && br != br)) {
        if (LT(ai,bi)) {
            ret = -1;
        }
        else if (LT(bi,ai)) {
            ret = 1;
        }
        else {
            ret = 0;
        }
    }
    else if (ar == ar) {
        ret = -1;
    }
    else {
        ret = 1;
    }

    return ret;
}

#undef LT




/* string type */

static int
STRING_compare(char *ip1, char *ip2, NpyArray *ap)
{
    const unsigned char *c1 = (unsigned char *)ip1;
    const unsigned char *c2 = (unsigned char *)ip2;
    const size_t len = ap->descr->elsize;
    size_t i;

    for(i = 0; i < len; ++i) {
        if (c1[i] != c2[i]) {
            return (c1[i] > c2[i]) ? 1 : -1;
        }
    }
    return 0;
}


/* unicode type */

static int
UNICODE_compare(npy_ucs4 *ip1, npy_ucs4 *ip2,
                NpyArray *ap)
{
    int itemsize = ap->descr->elsize/sizeof(PyArray_UCS4);

    if (itemsize < 0) {
        return 0;
    }
    while (itemsize-- > 0) {
        PyArray_UCS4 c1 = *ip1++;
        PyArray_UCS4 c2 = *ip2++;
        if (c1 != c2) {
            return (c1 < c2) ? -1 : 1;
        }
    }
    return 0;
}


/* void type */

/*
 * If fields are defined, then compare on first field and if equal
 * compare on second field.  Continue until done or comparison results
 * in not_equal.
 *
 * Must align data passed on to sub-comparisons.
 * Also must swap data based on to sub-comparisons.
 */
static int
VOID_compare(char *ip1, char *ip2, NpyArray *ap)
{
    NpyArray_Descr *descr, *new;
    char **names;
    NpyArray_DescrField *value;
    char *nip1, *nip2;
    int i, offset, res = 0, swap=0;

    if (!NpyArray_HASFIELDS(ap)) {
        return STRING_compare(ip1, ip2, ap);
    }
    descr = ap->descr;
    /*
     * Compare on the first-field.  If equal, then
     * compare on the second-field, etc.
     */
    names = descr->names;
    for (i = 0; NULL != names[i]; i++) {
        value = NpyDict_Get(descr->fields, names[i]);
        new = value->descr;
        offset = value->offset;

        ap->descr = new;
        swap = NpyArray_ISBYTESWAPPED(ap);
        nip1 = ip1+offset;
        nip2 = ip2+offset;
        if ((swap) || (new->alignment > 1)) {
            if ((swap) || (((intp)(nip1) % new->alignment) != 0)) {
                /* create buffer and copy */
                nip1 = NpyArray_malloc(new->elsize);
                if (nip1 == NULL) {
                    goto finish;
                }
                memcpy(nip1, ip1+offset, new->elsize);
                if (swap)
                    new->f->copyswap(nip1, NULL, swap, ap);
            }
            if ((swap) || (((intp)(nip2) % new->alignment) != 0)) {
                /* copy data to a buffer */
                nip2 = NpyArray_malloc(new->elsize);
                if (nip2 == NULL) {
                    if (nip1 != ip1+offset) {
                        NpyArray_free(nip1);
                    }
                    goto finish;
                }
                memcpy(nip2, ip2+offset, new->elsize);
                if (swap)
                    new->f->copyswap(nip2, NULL, swap, ap);
            }
        }
        res = new->f->compare(nip1, nip2, ap);
        if ((swap) || (new->alignment > 1)) {
            if (nip1 != ip1+offset) {
                NpyArray_free(nip1);
            }
            if (nip2 != ip2+offset) {
                NpyArray_free(nip2);
            }
        }
        if (res != 0) {
            break;
        }
    }

finish:
    ap->descr = descr;
    return res;
}


/*
 *****************************************************************************
 **                                 ARGFUNC                                 **
 *****************************************************************************
 */


static int
BOOL_argmax(Bool *ip, npy_intp n, npy_intp *max_ind, NpyArray *NPY_UNUSED(aip))
{
    npy_intp i;
    Bool mp = *ip;

    *max_ind = 0;
    for (i = 1; i < n; i++) {
        ip++;
        if (*ip > mp) {
            mp = *ip;
            *max_ind = i;
        }
    }
    return 0;
}


static int
BYTE_argmax(byte *ip, npy_intp n, npy_intp *max_ind, NpyArray *NPY_UNUSED(aip))
{
    npy_intp i;
    byte mp = *ip;

    *max_ind = 0;
    for (i = 1; i < n; i++) {
        ip++;
        if (*ip > mp) {
            mp = *ip;
            *max_ind = i;
        }
    }
    return 0;
}


static int
UBYTE_argmax(ubyte *ip, npy_intp n, npy_intp *max_ind, NpyArray *NPY_UNUSED(aip))
{
    npy_intp i;
    ubyte mp = *ip;

    *max_ind = 0;
    for (i = 1; i < n; i++) {
        ip++;
        if (*ip > mp) {
            mp = *ip;
            *max_ind = i;
        }
    }
    return 0;
}


static int
SHORT_argmax(short *ip, npy_intp n, npy_intp *max_ind, NpyArray *NPY_UNUSED(aip))
{
    npy_intp i;
    short mp = *ip;

    *max_ind = 0;
    for (i = 1; i < n; i++) {
        ip++;
        if (*ip > mp) {
            mp = *ip;
            *max_ind = i;
        }
    }
    return 0;
}


static int
USHORT_argmax(ushort *ip, npy_intp n, npy_intp *max_ind, NpyArray *NPY_UNUSED(aip))
{
    npy_intp i;
    ushort mp = *ip;

    *max_ind = 0;
    for (i = 1; i < n; i++) {
        ip++;
        if (*ip > mp) {
            mp = *ip;
            *max_ind = i;
        }
    }
    return 0;
}


static int
INT_argmax(int *ip, npy_intp n, npy_intp *max_ind, NpyArray *NPY_UNUSED(aip))
{
    npy_intp i;
    int mp = *ip;

    *max_ind = 0;
    for (i = 1; i < n; i++) {
        ip++;
        if (*ip > mp) {
            mp = *ip;
            *max_ind = i;
        }
    }
    return 0;
}


static int
UINT_argmax(uint *ip, npy_intp n, npy_intp *max_ind, NpyArray *NPY_UNUSED(aip))
{
    npy_intp i;
    uint mp = *ip;

    *max_ind = 0;
    for (i = 1; i < n; i++) {
        ip++;
        if (*ip > mp) {
            mp = *ip;
            *max_ind = i;
        }
    }
    return 0;
}


static int
LONG_argmax(long *ip, npy_intp n, npy_intp *max_ind, NpyArray *NPY_UNUSED(aip))
{
    npy_intp i;
    long mp = *ip;

    *max_ind = 0;
    for (i = 1; i < n; i++) {
        ip++;
        if (*ip > mp) {
            mp = *ip;
            *max_ind = i;
        }
    }
    return 0;
}


static int
ULONG_argmax(ulong *ip, npy_intp n, npy_intp *max_ind, NpyArray *NPY_UNUSED(aip))
{
    npy_intp i;
    ulong mp = *ip;

    *max_ind = 0;
    for (i = 1; i < n; i++) {
        ip++;
        if (*ip > mp) {
            mp = *ip;
            *max_ind = i;
        }
    }
    return 0;
}


static int
LONGLONG_argmax(longlong *ip, npy_intp n, npy_intp *max_ind, NpyArray *NPY_UNUSED(aip))
{
    npy_intp i;
    longlong mp = *ip;

    *max_ind = 0;
    for (i = 1; i < n; i++) {
        ip++;
        if (*ip > mp) {
            mp = *ip;
            *max_ind = i;
        }
    }
    return 0;
}


static int
ULONGLONG_argmax(ulonglong *ip, npy_intp n, npy_intp *max_ind, NpyArray *NPY_UNUSED(aip))
{
    npy_intp i;
    ulonglong mp = *ip;

    *max_ind = 0;
    for (i = 1; i < n; i++) {
        ip++;
        if (*ip > mp) {
            mp = *ip;
            *max_ind = i;
        }
    }
    return 0;
}


static int
FLOAT_argmax(float *ip, npy_intp n, npy_intp *max_ind, NpyArray *NPY_UNUSED(aip))
{
    npy_intp i;
    float mp = *ip;

    *max_ind = 0;
    for (i = 1; i < n; i++) {
        ip++;
        if (*ip > mp) {
            mp = *ip;
            *max_ind = i;
        }
    }
    return 0;
}


static int
DOUBLE_argmax(double *ip, npy_intp n, npy_intp *max_ind, NpyArray *NPY_UNUSED(aip))
{
    npy_intp i;
    double mp = *ip;

    *max_ind = 0;
    for (i = 1; i < n; i++) {
        ip++;
        if (*ip > mp) {
            mp = *ip;
            *max_ind = i;
        }
    }
    return 0;
}


static int
LONGDOUBLE_argmax(longdouble *ip, npy_intp n, npy_intp *max_ind, NpyArray *NPY_UNUSED(aip))
{
    npy_intp i;
    longdouble mp = *ip;

    *max_ind = 0;
    for (i = 1; i < n; i++) {
        ip++;
        if (*ip > mp) {
            mp = *ip;
            *max_ind = i;
        }
    }
    return 0;
}


static int
CFLOAT_argmax(float *ip, npy_intp n, npy_intp *max_ind, NpyArray *NPY_UNUSED(aip))
{
    npy_intp i;
    float mp = *ip;

    *max_ind = 0;
    for (i = 1; i < n; i++) {
        ip+=2;
        if (*ip > mp) {
            mp = *ip;
            *max_ind = i;
        }
    }
    return 0;
}


static int
CDOUBLE_argmax(double *ip, npy_intp n, npy_intp *max_ind, NpyArray *NPY_UNUSED(aip))
{
    npy_intp i;
    double mp = *ip;

    *max_ind = 0;
    for (i = 1; i < n; i++) {
        ip+=2;
        if (*ip > mp) {
            mp = *ip;
            *max_ind = i;
        }
    }
    return 0;
}


static int
CLONGDOUBLE_argmax(longdouble *ip, npy_intp n, npy_intp *max_ind, NpyArray *NPY_UNUSED(aip))
{
    npy_intp i;
    longdouble mp = *ip;

    *max_ind = 0;
    for (i = 1; i < n; i++) {
        ip+=2;
        if (*ip > mp) {
            mp = *ip;
            *max_ind = i;
        }
    }
    return 0;
}


static int
DATETIME_argmax(datetime *ip, npy_intp n, npy_intp *max_ind, NpyArray *NPY_UNUSED(aip))
{
    npy_intp i;
    datetime mp = *ip;

    *max_ind = 0;
    for (i = 1; i < n; i++) {
        ip++;
        if (*ip > mp) {
            mp = *ip;
            *max_ind = i;
        }
    }
    return 0;
}


static int
TIMEDELTA_argmax(timedelta *ip, npy_intp n, npy_intp *max_ind, NpyArray *NPY_UNUSED(aip))
{
    npy_intp i;
    timedelta mp = *ip;

    *max_ind = 0;
    for (i = 1; i < n; i++) {
        ip++;
        if (*ip > mp) {
            mp = *ip;
            *max_ind = i;
        }
    }
    return 0;
}




static int
STRING_argmax(char *ip, npy_intp n, npy_intp *max_ind, NpyArray *aip)
{
    npy_intp i;
    int elsize = aip->descr->elsize;
    char *mp = (char *)NpyArray_malloc(elsize);

    if (mp==NULL) return 0;
    memcpy(mp, ip, elsize);
    *max_ind = 0;
    for(i=1; i<n; i++) {
        ip += elsize/sizeof(char);
        if (STRING_compare(ip,mp,aip) > 0) {
            memcpy(mp, ip, elsize);
            *max_ind=i;
        }
    }
    NpyArray_free(mp);
    return 0;
}


static int
UNICODE_argmax(PyArray_UCS4 *ip, npy_intp n, npy_intp *max_ind, NpyArray *aip)
{
    npy_intp i;
    int elsize = aip->descr->elsize;
    PyArray_UCS4 *mp = (PyArray_UCS4 *)NpyArray_malloc(elsize);

    if (mp==NULL) return 0;
    memcpy(mp, ip, elsize);
    *max_ind = 0;
    for(i=1; i<n; i++) {
        ip += elsize/sizeof(PyArray_UCS4);
        if (UNICODE_compare(ip,mp,aip) > 0) {
            memcpy(mp, ip, elsize);
            *max_ind=i;
        }
    }
    NpyArray_free(mp);
    return 0;
}



#define VOID_argmax NULL


/*
 *****************************************************************************
 **                                  DOT                                    **
 *****************************************************************************
 */

/*
 * dot means inner product
 */

static void
BOOL_dot(char *ip1, npy_intp is1, char *ip2, npy_intp is2, char *op, npy_intp n,
         void *NPY_UNUSED(ignore))
{
    Bool tmp = FALSE;
    npy_intp i;

    for (i = 0; i < n; i++, ip1 += is1, ip2 += is2) {
        if ((*((Bool *)ip1) != 0) && (*((Bool *)ip2) != 0)) {
            tmp = TRUE;
            break;
        }
    }
    *((Bool *)op) = tmp;
}

static void
BYTE_dot(char *ip1, npy_intp is1, char *ip2, npy_intp is2, char *op, npy_intp n,
           void *NPY_UNUSED(ignore))
{
    long tmp = (long)0;
    npy_intp i;

    for (i = 0; i < n; i++, ip1 += is1, ip2 += is2) {
        tmp += (long)(*((byte *)ip1)) *
               (long)(*((byte *)ip2));
    }
    *((byte *)op) = (byte) tmp;
}

static void
UBYTE_dot(char *ip1, npy_intp is1, char *ip2, npy_intp is2, char *op, npy_intp n,
           void *NPY_UNUSED(ignore))
{
    ulong tmp = (ulong)0;
    npy_intp i;

    for (i = 0; i < n; i++, ip1 += is1, ip2 += is2) {
        tmp += (ulong)(*((ubyte *)ip1)) *
               (ulong)(*((ubyte *)ip2));
    }
    *((ubyte *)op) = (ubyte) tmp;
}

static void
SHORT_dot(char *ip1, npy_intp is1, char *ip2, npy_intp is2, char *op, npy_intp n,
           void *NPY_UNUSED(ignore))
{
    long tmp = (long)0;
    npy_intp i;

    for (i = 0; i < n; i++, ip1 += is1, ip2 += is2) {
        tmp += (long)(*((short *)ip1)) *
               (long)(*((short *)ip2));
    }
    *((short *)op) = (short) tmp;
}

static void
USHORT_dot(char *ip1, npy_intp is1, char *ip2, npy_intp is2, char *op, npy_intp n,
           void *NPY_UNUSED(ignore))
{
    ulong tmp = (ulong)0;
    npy_intp i;

    for (i = 0; i < n; i++, ip1 += is1, ip2 += is2) {
        tmp += (ulong)(*((ushort *)ip1)) *
               (ulong)(*((ushort *)ip2));
    }
    *((ushort *)op) = (ushort) tmp;
}

static void
INT_dot(char *ip1, npy_intp is1, char *ip2, npy_intp is2, char *op, npy_intp n,
           void *NPY_UNUSED(ignore))
{
    long tmp = (long)0;
    npy_intp i;

    for (i = 0; i < n; i++, ip1 += is1, ip2 += is2) {
        tmp += (long)(*((int *)ip1)) *
               (long)(*((int *)ip2));
    }
    *((int *)op) = (int) tmp;
}

static void
UINT_dot(char *ip1, npy_intp is1, char *ip2, npy_intp is2, char *op, npy_intp n,
           void *NPY_UNUSED(ignore))
{
    ulong tmp = (ulong)0;
    npy_intp i;

    for (i = 0; i < n; i++, ip1 += is1, ip2 += is2) {
        tmp += (ulong)(*((uint *)ip1)) *
               (ulong)(*((uint *)ip2));
    }
    *((uint *)op) = (uint) tmp;
}

static void
LONG_dot(char *ip1, npy_intp is1, char *ip2, npy_intp is2, char *op, npy_intp n,
           void *NPY_UNUSED(ignore))
{
    long tmp = (long)0;
    npy_intp i;

    for (i = 0; i < n; i++, ip1 += is1, ip2 += is2) {
        tmp += (long)(*((long *)ip1)) *
               (long)(*((long *)ip2));
    }
    *((long *)op) = (long) tmp;
}

static void
ULONG_dot(char *ip1, npy_intp is1, char *ip2, npy_intp is2, char *op, npy_intp n,
           void *NPY_UNUSED(ignore))
{
    ulong tmp = (ulong)0;
    npy_intp i;

    for (i = 0; i < n; i++, ip1 += is1, ip2 += is2) {
        tmp += (ulong)(*((ulong *)ip1)) *
               (ulong)(*((ulong *)ip2));
    }
    *((ulong *)op) = (ulong) tmp;
}

static void
LONGLONG_dot(char *ip1, npy_intp is1, char *ip2, npy_intp is2, char *op, npy_intp n,
           void *NPY_UNUSED(ignore))
{
    longlong tmp = (longlong)0;
    npy_intp i;

    for (i = 0; i < n; i++, ip1 += is1, ip2 += is2) {
        tmp += (longlong)(*((longlong *)ip1)) *
               (longlong)(*((longlong *)ip2));
    }
    *((longlong *)op) = (longlong) tmp;
}

static void
ULONGLONG_dot(char *ip1, npy_intp is1, char *ip2, npy_intp is2, char *op, npy_intp n,
           void *NPY_UNUSED(ignore))
{
    ulonglong tmp = (ulonglong)0;
    npy_intp i;

    for (i = 0; i < n; i++, ip1 += is1, ip2 += is2) {
        tmp += (ulonglong)(*((ulonglong *)ip1)) *
               (ulonglong)(*((ulonglong *)ip2));
    }
    *((ulonglong *)op) = (ulonglong) tmp;
}

static void
FLOAT_dot(char *ip1, npy_intp is1, char *ip2, npy_intp is2, char *op, npy_intp n,
           void *NPY_UNUSED(ignore))
{
    float tmp = (float)0;
    npy_intp i;

    for (i = 0; i < n; i++, ip1 += is1, ip2 += is2) {
        tmp += (float)(*((float *)ip1)) *
               (float)(*((float *)ip2));
    }
    *((float *)op) = (float) tmp;
}

static void
DOUBLE_dot(char *ip1, npy_intp is1, char *ip2, npy_intp is2, char *op, npy_intp n,
           void *NPY_UNUSED(ignore))
{
    double tmp = (double)0;
    npy_intp i;

    for (i = 0; i < n; i++, ip1 += is1, ip2 += is2) {
        tmp += (double)(*((double *)ip1)) *
               (double)(*((double *)ip2));
    }
    *((double *)op) = (double) tmp;
}

static void
LONGDOUBLE_dot(char *ip1, npy_intp is1, char *ip2, npy_intp is2, char *op, npy_intp n,
           void *NPY_UNUSED(ignore))
{
    longdouble tmp = (longdouble)0;
    npy_intp i;

    for (i = 0; i < n; i++, ip1 += is1, ip2 += is2) {
        tmp += (longdouble)(*((longdouble *)ip1)) *
               (longdouble)(*((longdouble *)ip2));
    }
    *((longdouble *)op) = (longdouble) tmp;
}

static void
DATETIME_dot(char *ip1, npy_intp is1, char *ip2, npy_intp is2, char *op, npy_intp n,
           void *NPY_UNUSED(ignore))
{
    datetime tmp = (datetime)0;
    npy_intp i;

    for (i = 0; i < n; i++, ip1 += is1, ip2 += is2) {
        tmp += (datetime)(*((datetime *)ip1)) *
               (datetime)(*((datetime *)ip2));
    }
    *((datetime *)op) = (datetime) tmp;
}

static void
TIMEDELTA_dot(char *ip1, npy_intp is1, char *ip2, npy_intp is2, char *op, npy_intp n,
           void *NPY_UNUSED(ignore))
{
    timedelta tmp = (timedelta)0;
    npy_intp i;

    for (i = 0; i < n; i++, ip1 += is1, ip2 += is2) {
        tmp += (timedelta)(*((timedelta *)ip1)) *
               (timedelta)(*((timedelta *)ip2));
    }
    *((timedelta *)op) = (timedelta) tmp;
}



static void CFLOAT_dot(char *ip1, npy_intp is1, char *ip2, npy_intp is2,
                       char *op, npy_intp n, void *NPY_UNUSED(ignore))
{
    float tmpr = (float)0.0, tmpi=(float)0.0;
    npy_intp i;

    for (i = 0; i < n; i++, ip1 += is1, ip2 += is2) {
        tmpr += ((float *)ip1)[0] * ((float *)ip2)[0]
                - ((float *)ip1)[1] * ((float *)ip2)[1];
        tmpi += ((float *)ip1)[1] * ((float *)ip2)[0]
                + ((float *)ip1)[0] * ((float *)ip2)[1];
    }
    ((float *)op)[0] = tmpr; ((float *)op)[1] = tmpi;
}


static void CDOUBLE_dot(char *ip1, npy_intp is1, char *ip2, npy_intp is2,
                       char *op, npy_intp n, void *NPY_UNUSED(ignore))
{
    double tmpr = (double)0.0, tmpi=(double)0.0;
    npy_intp i;

    for (i = 0; i < n; i++, ip1 += is1, ip2 += is2) {
        tmpr += ((double *)ip1)[0] * ((double *)ip2)[0]
                - ((double *)ip1)[1] * ((double *)ip2)[1];
        tmpi += ((double *)ip1)[1] * ((double *)ip2)[0]
                + ((double *)ip1)[0] * ((double *)ip2)[1];
    }
    ((double *)op)[0] = tmpr; ((double *)op)[1] = tmpi;
}


static void CLONGDOUBLE_dot(char *ip1, npy_intp is1, char *ip2, npy_intp is2,
                       char *op, npy_intp n, void *NPY_UNUSED(ignore))
{
    longdouble tmpr = (longdouble)0.0, tmpi=(longdouble)0.0;
    npy_intp i;

    for (i = 0; i < n; i++, ip1 += is1, ip2 += is2) {
        tmpr += ((longdouble *)ip1)[0] * ((longdouble *)ip2)[0]
                - ((longdouble *)ip1)[1] * ((longdouble *)ip2)[1];
        tmpi += ((longdouble *)ip1)[1] * ((longdouble *)ip2)[0]
                + ((longdouble *)ip1)[0] * ((longdouble *)ip2)[1];
    }
    ((longdouble *)op)[0] = tmpr; ((longdouble *)op)[1] = tmpi;
}




/*
 *****************************************************************************
 **                                 FILL                                    **
 *****************************************************************************
 */

static void
BYTE_fill(byte *buffer, npy_intp length, void *NPY_UNUSED(ignored))
{
    npy_intp i;
    byte start = buffer[0];
    byte delta = buffer[1];

    delta -= start;
    for (i = 2; i < length; ++i) {
        buffer[i] = start + i*delta;
    }
}

static void
UBYTE_fill(ubyte *buffer, npy_intp length, void *NPY_UNUSED(ignored))
{
    npy_intp i;
    ubyte start = buffer[0];
    ubyte delta = buffer[1];

    delta -= start;
    for (i = 2; i < length; ++i) {
        buffer[i] = start + i*delta;
    }
}

static void
SHORT_fill(short *buffer, npy_intp length, void *NPY_UNUSED(ignored))
{
    npy_intp i;
    short start = buffer[0];
    short delta = buffer[1];

    delta -= start;
    for (i = 2; i < length; ++i) {
        buffer[i] = start + i*delta;
    }
}

static void
USHORT_fill(ushort *buffer, npy_intp length, void *NPY_UNUSED(ignored))
{
    npy_intp i;
    ushort start = buffer[0];
    ushort delta = buffer[1];

    delta -= start;
    for (i = 2; i < length; ++i) {
        buffer[i] = start + i*delta;
    }
}

static void
INT_fill(int *buffer, npy_intp length, void *NPY_UNUSED(ignored))
{
    npy_intp i;
    int start = buffer[0];
    int delta = buffer[1];

    delta -= start;
    for (i = 2; i < length; ++i) {
        buffer[i] = start + i*delta;
    }
}

static void
UINT_fill(uint *buffer, npy_intp length, void *NPY_UNUSED(ignored))
{
    npy_intp i;
    uint start = buffer[0];
    uint delta = buffer[1];

    delta -= start;
    for (i = 2; i < length; ++i) {
        buffer[i] = start + i*delta;
    }
}

static void
LONG_fill(long *buffer, npy_intp length, void *NPY_UNUSED(ignored))
{
    npy_intp i;
    long start = buffer[0];
    long delta = buffer[1];

    delta -= start;
    for (i = 2; i < length; ++i) {
        buffer[i] = start + i*delta;
    }
}

static void
ULONG_fill(ulong *buffer, npy_intp length, void *NPY_UNUSED(ignored))
{
    npy_intp i;
    ulong start = buffer[0];
    ulong delta = buffer[1];

    delta -= start;
    for (i = 2; i < length; ++i) {
        buffer[i] = start + i*delta;
    }
}

static void
LONGLONG_fill(longlong *buffer, npy_intp length, void *NPY_UNUSED(ignored))
{
    npy_intp i;
    longlong start = buffer[0];
    longlong delta = buffer[1];

    delta -= start;
    for (i = 2; i < length; ++i) {
        buffer[i] = start + i*delta;
    }
}

static void
ULONGLONG_fill(ulonglong *buffer, npy_intp length, void *NPY_UNUSED(ignored))
{
    npy_intp i;
    ulonglong start = buffer[0];
    ulonglong delta = buffer[1];

    delta -= start;
    for (i = 2; i < length; ++i) {
        buffer[i] = start + i*delta;
    }
}

static void
FLOAT_fill(float *buffer, npy_intp length, void *NPY_UNUSED(ignored))
{
    npy_intp i;
    float start = buffer[0];
    float delta = buffer[1];

    delta -= start;
    for (i = 2; i < length; ++i) {
        buffer[i] = start + i*delta;
    }
}

static void
DOUBLE_fill(double *buffer, npy_intp length, void *NPY_UNUSED(ignored))
{
    npy_intp i;
    double start = buffer[0];
    double delta = buffer[1];

    delta -= start;
    for (i = 2; i < length; ++i) {
        buffer[i] = start + i*delta;
    }
}

static void
LONGDOUBLE_fill(longdouble *buffer, npy_intp length, void *NPY_UNUSED(ignored))
{
    npy_intp i;
    longdouble start = buffer[0];
    longdouble delta = buffer[1];

    delta -= start;
    for (i = 2; i < length; ++i) {
        buffer[i] = start + i*delta;
    }
}

static void
DATETIME_fill(datetime *buffer, npy_intp length, void *NPY_UNUSED(ignored))
{
    npy_intp i;
    datetime start = buffer[0];
    datetime delta = buffer[1];

    delta -= start;
    for (i = 2; i < length; ++i) {
        buffer[i] = start + i*delta;
    }
}

static void
TIMEDELTA_fill(timedelta *buffer, npy_intp length, void *NPY_UNUSED(ignored))
{
    npy_intp i;
    timedelta start = buffer[0];
    timedelta delta = buffer[1];

    delta -= start;
    for (i = 2; i < length; ++i) {
        buffer[i] = start + i*delta;
    }
}


static void
CFLOAT_fill(cfloat *buffer, npy_intp length, void *NPY_UNUSED(ignore))
{
    npy_intp i;
    cfloat start;
    cfloat delta;

    start.real = buffer->real;
    start.imag = buffer->imag;
    delta.real = buffer[1].real;
    delta.imag = buffer[1].imag;
    delta.real -= start.real;
    delta.imag -= start.imag;
    buffer += 2;
    for (i = 2; i < length; i++, buffer++) {
        buffer->real = start.real + i*delta.real;
        buffer->imag = start.imag + i*delta.imag;
    }
}

static void
CDOUBLE_fill(cdouble *buffer, npy_intp length, void *NPY_UNUSED(ignore))
{
    npy_intp i;
    cdouble start;
    cdouble delta;

    start.real = buffer->real;
    start.imag = buffer->imag;
    delta.real = buffer[1].real;
    delta.imag = buffer[1].imag;
    delta.real -= start.real;
    delta.imag -= start.imag;
    buffer += 2;
    for (i = 2; i < length; i++, buffer++) {
        buffer->real = start.real + i*delta.real;
        buffer->imag = start.imag + i*delta.imag;
    }
}

static void
CLONGDOUBLE_fill(clongdouble *buffer, npy_intp length, void *NPY_UNUSED(ignore))
{
    npy_intp i;
    clongdouble start;
    clongdouble delta;

    start.real = buffer->real;
    start.imag = buffer->imag;
    delta.real = buffer[1].real;
    delta.imag = buffer[1].imag;
    delta.real -= start.real;
    delta.imag -= start.imag;
    buffer += 2;
    for (i = 2; i < length; i++, buffer++) {
        buffer->real = start.real + i*delta.real;
        buffer->imag = start.imag + i*delta.imag;
    }
}



static void
BOOL_fillwithscalar(Bool *buffer, npy_intp length, Bool *value, void *NPY_UNUSED(ignored))
{
    memset(buffer, *value, length);
}

static void
BYTE_fillwithscalar(byte *buffer, npy_intp length, byte *value, void *NPY_UNUSED(ignored))
{
    memset(buffer, *value, length);
}

static void
UBYTE_fillwithscalar(ubyte *buffer, npy_intp length, ubyte *value, void *NPY_UNUSED(ignored))
{
    memset(buffer, *value, length);
}


static void
SHORT_fillwithscalar(short *buffer, npy_intp length, short *value, void *NPY_UNUSED(ignored))
{
    npy_intp i;
    short val = *value;

    for (i = 0; i < length; ++i) {
        buffer[i] = val;
    }
}

static void
USHORT_fillwithscalar(ushort *buffer, npy_intp length, ushort *value, void *NPY_UNUSED(ignored))
{
    npy_intp i;
    ushort val = *value;

    for (i = 0; i < length; ++i) {
        buffer[i] = val;
    }
}

static void
INT_fillwithscalar(int *buffer, npy_intp length, int *value, void *NPY_UNUSED(ignored))
{
    npy_intp i;
    int val = *value;

    for (i = 0; i < length; ++i) {
        buffer[i] = val;
    }
}

static void
UINT_fillwithscalar(uint *buffer, npy_intp length, uint *value, void *NPY_UNUSED(ignored))
{
    npy_intp i;
    uint val = *value;

    for (i = 0; i < length; ++i) {
        buffer[i] = val;
    }
}

static void
LONG_fillwithscalar(long *buffer, npy_intp length, long *value, void *NPY_UNUSED(ignored))
{
    npy_intp i;
    long val = *value;

    for (i = 0; i < length; ++i) {
        buffer[i] = val;
    }
}

static void
ULONG_fillwithscalar(ulong *buffer, npy_intp length, ulong *value, void *NPY_UNUSED(ignored))
{
    npy_intp i;
    ulong val = *value;

    for (i = 0; i < length; ++i) {
        buffer[i] = val;
    }
}

static void
LONGLONG_fillwithscalar(longlong *buffer, npy_intp length, longlong *value, void *NPY_UNUSED(ignored))
{
    npy_intp i;
    longlong val = *value;

    for (i = 0; i < length; ++i) {
        buffer[i] = val;
    }
}

static void
ULONGLONG_fillwithscalar(ulonglong *buffer, npy_intp length, ulonglong *value, void *NPY_UNUSED(ignored))
{
    npy_intp i;
    ulonglong val = *value;

    for (i = 0; i < length; ++i) {
        buffer[i] = val;
    }
}

static void
FLOAT_fillwithscalar(float *buffer, npy_intp length, float *value, void *NPY_UNUSED(ignored))
{
    npy_intp i;
    float val = *value;

    for (i = 0; i < length; ++i) {
        buffer[i] = val;
    }
}

static void
DOUBLE_fillwithscalar(double *buffer, npy_intp length, double *value, void *NPY_UNUSED(ignored))
{
    npy_intp i;
    double val = *value;

    for (i = 0; i < length; ++i) {
        buffer[i] = val;
    }
}

static void
LONGDOUBLE_fillwithscalar(longdouble *buffer, npy_intp length, longdouble *value, void *NPY_UNUSED(ignored))
{
    npy_intp i;
    longdouble val = *value;

    for (i = 0; i < length; ++i) {
        buffer[i] = val;
    }
}

static void
CFLOAT_fillwithscalar(cfloat *buffer, npy_intp length, cfloat *value, void *NPY_UNUSED(ignored))
{
    npy_intp i;
    cfloat val = *value;

    for (i = 0; i < length; ++i) {
        buffer[i] = val;
    }
}

static void
CDOUBLE_fillwithscalar(cdouble *buffer, npy_intp length, cdouble *value, void *NPY_UNUSED(ignored))
{
    npy_intp i;
    cdouble val = *value;

    for (i = 0; i < length; ++i) {
        buffer[i] = val;
    }
}

static void
CLONGDOUBLE_fillwithscalar(clongdouble *buffer, npy_intp length, clongdouble *value, void *NPY_UNUSED(ignored))
{
    npy_intp i;
    clongdouble val = *value;

    for (i = 0; i < length; ++i) {
        buffer[i] = val;
    }
}

static void
DATETIME_fillwithscalar(datetime *buffer, npy_intp length, datetime *value, void *NPY_UNUSED(ignored))
{
    npy_intp i;
    datetime val = *value;

    for (i = 0; i < length; ++i) {
        buffer[i] = val;
    }
}

static void
TIMEDELTA_fillwithscalar(timedelta *buffer, npy_intp length, timedelta *value, void *NPY_UNUSED(ignored))
{
    npy_intp i;
    timedelta val = *value;

    for (i = 0; i < length; ++i) {
        buffer[i] = val;
    }
}



/*
 *****************************************************************************
 **                               FASTCLIP                                  **
 *****************************************************************************
 */


static void
BOOL_fastclip(Bool *in, npy_intp ni, Bool *min, Bool *max, Bool *out)
{
    npy_intp i;
    Bool max_val = 0, min_val = 0;

    if (max != NULL) {
        max_val = *max;
    }
    if (min != NULL) {
        min_val = *min;
    }
    if (max == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i] = min_val;
            }
        }
    }
    else if (min == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] > max_val) {
                out[i] = max_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i]   = min_val;
            }
            else if (in[i] > max_val) {
                out[i]   = max_val;
            }
        }
    }
}

static void
BYTE_fastclip(byte *in, npy_intp ni, byte *min, byte *max, byte *out)
{
    npy_intp i;
    byte max_val = 0, min_val = 0;

    if (max != NULL) {
        max_val = *max;
    }
    if (min != NULL) {
        min_val = *min;
    }
    if (max == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i] = min_val;
            }
        }
    }
    else if (min == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] > max_val) {
                out[i] = max_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i]   = min_val;
            }
            else if (in[i] > max_val) {
                out[i]   = max_val;
            }
        }
    }
}

static void
UBYTE_fastclip(ubyte *in, npy_intp ni, ubyte *min, ubyte *max, ubyte *out)
{
    npy_intp i;
    ubyte max_val = 0, min_val = 0;

    if (max != NULL) {
        max_val = *max;
    }
    if (min != NULL) {
        min_val = *min;
    }
    if (max == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i] = min_val;
            }
        }
    }
    else if (min == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] > max_val) {
                out[i] = max_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i]   = min_val;
            }
            else if (in[i] > max_val) {
                out[i]   = max_val;
            }
        }
    }
}

static void
SHORT_fastclip(short *in, npy_intp ni, short *min, short *max, short *out)
{
    npy_intp i;
    short max_val = 0, min_val = 0;

    if (max != NULL) {
        max_val = *max;
    }
    if (min != NULL) {
        min_val = *min;
    }
    if (max == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i] = min_val;
            }
        }
    }
    else if (min == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] > max_val) {
                out[i] = max_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i]   = min_val;
            }
            else if (in[i] > max_val) {
                out[i]   = max_val;
            }
        }
    }
}

static void
USHORT_fastclip(ushort *in, npy_intp ni, ushort *min, ushort *max, ushort *out)
{
    npy_intp i;
    ushort max_val = 0, min_val = 0;

    if (max != NULL) {
        max_val = *max;
    }
    if (min != NULL) {
        min_val = *min;
    }
    if (max == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i] = min_val;
            }
        }
    }
    else if (min == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] > max_val) {
                out[i] = max_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i]   = min_val;
            }
            else if (in[i] > max_val) {
                out[i]   = max_val;
            }
        }
    }
}

static void
INT_fastclip(int *in, npy_intp ni, int *min, int *max, int *out)
{
    npy_intp i;
    int max_val = 0, min_val = 0;

    if (max != NULL) {
        max_val = *max;
    }
    if (min != NULL) {
        min_val = *min;
    }
    if (max == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i] = min_val;
            }
        }
    }
    else if (min == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] > max_val) {
                out[i] = max_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i]   = min_val;
            }
            else if (in[i] > max_val) {
                out[i]   = max_val;
            }
        }
    }
}

static void
UINT_fastclip(uint *in, npy_intp ni, uint *min, uint *max, uint *out)
{
    npy_intp i;
    uint max_val = 0, min_val = 0;

    if (max != NULL) {
        max_val = *max;
    }
    if (min != NULL) {
        min_val = *min;
    }
    if (max == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i] = min_val;
            }
        }
    }
    else if (min == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] > max_val) {
                out[i] = max_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i]   = min_val;
            }
            else if (in[i] > max_val) {
                out[i]   = max_val;
            }
        }
    }
}

static void
LONG_fastclip(long *in, npy_intp ni, long *min, long *max, long *out)
{
    npy_intp i;
    long max_val = 0, min_val = 0;

    if (max != NULL) {
        max_val = *max;
    }
    if (min != NULL) {
        min_val = *min;
    }
    if (max == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i] = min_val;
            }
        }
    }
    else if (min == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] > max_val) {
                out[i] = max_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i]   = min_val;
            }
            else if (in[i] > max_val) {
                out[i]   = max_val;
            }
        }
    }
}

static void
ULONG_fastclip(ulong *in, npy_intp ni, ulong *min, ulong *max, ulong *out)
{
    npy_intp i;
    ulong max_val = 0, min_val = 0;

    if (max != NULL) {
        max_val = *max;
    }
    if (min != NULL) {
        min_val = *min;
    }
    if (max == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i] = min_val;
            }
        }
    }
    else if (min == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] > max_val) {
                out[i] = max_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i]   = min_val;
            }
            else if (in[i] > max_val) {
                out[i]   = max_val;
            }
        }
    }
}

static void
LONGLONG_fastclip(longlong *in, npy_intp ni, longlong *min, longlong *max, longlong *out)
{
    npy_intp i;
    longlong max_val = 0, min_val = 0;

    if (max != NULL) {
        max_val = *max;
    }
    if (min != NULL) {
        min_val = *min;
    }
    if (max == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i] = min_val;
            }
        }
    }
    else if (min == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] > max_val) {
                out[i] = max_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i]   = min_val;
            }
            else if (in[i] > max_val) {
                out[i]   = max_val;
            }
        }
    }
}

static void
ULONGLONG_fastclip(ulonglong *in, npy_intp ni, ulonglong *min, ulonglong *max, ulonglong *out)
{
    npy_intp i;
    ulonglong max_val = 0, min_val = 0;

    if (max != NULL) {
        max_val = *max;
    }
    if (min != NULL) {
        min_val = *min;
    }
    if (max == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i] = min_val;
            }
        }
    }
    else if (min == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] > max_val) {
                out[i] = max_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i]   = min_val;
            }
            else if (in[i] > max_val) {
                out[i]   = max_val;
            }
        }
    }
}

static void
FLOAT_fastclip(float *in, npy_intp ni, float *min, float *max, float *out)
{
    npy_intp i;
    float max_val = 0, min_val = 0;

    if (max != NULL) {
        max_val = *max;
    }
    if (min != NULL) {
        min_val = *min;
    }
    if (max == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i] = min_val;
            }
        }
    }
    else if (min == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] > max_val) {
                out[i] = max_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i]   = min_val;
            }
            else if (in[i] > max_val) {
                out[i]   = max_val;
            }
        }
    }
}

static void
DOUBLE_fastclip(double *in, npy_intp ni, double *min, double *max, double *out)
{
    npy_intp i;
    double max_val = 0, min_val = 0;

    if (max != NULL) {
        max_val = *max;
    }
    if (min != NULL) {
        min_val = *min;
    }
    if (max == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i] = min_val;
            }
        }
    }
    else if (min == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] > max_val) {
                out[i] = max_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i]   = min_val;
            }
            else if (in[i] > max_val) {
                out[i]   = max_val;
            }
        }
    }
}

static void
LONGDOUBLE_fastclip(longdouble *in, npy_intp ni, longdouble *min, longdouble *max, longdouble *out)
{
    npy_intp i;
    longdouble max_val = 0, min_val = 0;

    if (max != NULL) {
        max_val = *max;
    }
    if (min != NULL) {
        min_val = *min;
    }
    if (max == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i] = min_val;
            }
        }
    }
    else if (min == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] > max_val) {
                out[i] = max_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i]   = min_val;
            }
            else if (in[i] > max_val) {
                out[i]   = max_val;
            }
        }
    }
}

static void
DATETIME_fastclip(datetime *in, npy_intp ni, datetime *min, datetime *max, datetime *out)
{
    npy_intp i;
    datetime max_val = 0, min_val = 0;

    if (max != NULL) {
        max_val = *max;
    }
    if (min != NULL) {
        min_val = *min;
    }
    if (max == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i] = min_val;
            }
        }
    }
    else if (min == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] > max_val) {
                out[i] = max_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i]   = min_val;
            }
            else if (in[i] > max_val) {
                out[i]   = max_val;
            }
        }
    }
}

static void
TIMEDELTA_fastclip(timedelta *in, npy_intp ni, timedelta *min, timedelta *max, timedelta *out)
{
    npy_intp i;
    timedelta max_val = 0, min_val = 0;

    if (max != NULL) {
        max_val = *max;
    }
    if (min != NULL) {
        min_val = *min;
    }
    if (max == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i] = min_val;
            }
        }
    }
    else if (min == NULL) {
        for (i = 0; i < ni; i++) {
            if (in[i] > max_val) {
                out[i] = max_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (in[i] < min_val) {
                out[i]   = min_val;
            }
            else if (in[i] > max_val) {
                out[i]   = max_val;
            }
        }
    }
}


static void
CFLOAT_fastclip(cfloat *in, npy_intp ni, cfloat *min, cfloat *max, cfloat *out)
{
    npy_intp i;
    cfloat max_val, min_val;

    min_val = *min;
    max_val = *max;
    if (max != NULL) {
        max_val = *max;
    }
    if (min != NULL) {
        min_val = *min;
    }
    if (max == NULL) {
        for (i = 0; i < ni; i++) {
            if (NpyArray_CLT(in[i],min_val)) {
                out[i] = min_val;
            }
        }
    }
    else if (min == NULL) {
        for (i = 0; i < ni; i++) {
            if (NpyArray_CGT(in[i], max_val)) {
                out[i] = max_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (NpyArray_CLT(in[i], min_val)) {
                out[i] = min_val;
            }
            else if (NpyArray_CGT(in[i], max_val)) {
                out[i] = max_val;
            }
        }
    }
}


static void
CDOUBLE_fastclip(cdouble *in, npy_intp ni, cdouble *min, cdouble *max, cdouble *out)
{
    npy_intp i;
    cdouble max_val, min_val;

    min_val = *min;
    max_val = *max;
    if (max != NULL) {
        max_val = *max;
    }
    if (min != NULL) {
        min_val = *min;
    }
    if (max == NULL) {
        for (i = 0; i < ni; i++) {
            if (NpyArray_CLT(in[i],min_val)) {
                out[i] = min_val;
            }
        }
    }
    else if (min == NULL) {
        for (i = 0; i < ni; i++) {
            if (NpyArray_CGT(in[i], max_val)) {
                out[i] = max_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (NpyArray_CLT(in[i], min_val)) {
                out[i] = min_val;
            }
            else if (NpyArray_CGT(in[i], max_val)) {
                out[i] = max_val;
            }
        }
    }
}


static void
CLONGDOUBLE_fastclip(clongdouble *in, npy_intp ni, clongdouble *min, clongdouble *max, clongdouble *out)
{
    npy_intp i;
    clongdouble max_val, min_val;

    min_val = *min;
    max_val = *max;
    if (max != NULL) {
        max_val = *max;
    }
    if (min != NULL) {
        min_val = *min;
    }
    if (max == NULL) {
        for (i = 0; i < ni; i++) {
            if (NpyArray_CLT(in[i],min_val)) {
                out[i] = min_val;
            }
        }
    }
    else if (min == NULL) {
        for (i = 0; i < ni; i++) {
            if (NpyArray_CGT(in[i], max_val)) {
                out[i] = max_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (NpyArray_CLT(in[i], min_val)) {
                out[i] = min_val;
            }
            else if (NpyArray_CGT(in[i], max_val)) {
                out[i] = max_val;
            }
        }
    }
}





/*
 *****************************************************************************
 **                              FASTPUTMASK                                **
 *****************************************************************************
 */


static void
BOOL_fastputmask(Bool *in, Bool *mask, npy_intp ni, Bool *vals, npy_intp nv)
{
    npy_intp i;
    Bool s_val;

    if (nv == 1) {
        s_val = *vals;
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = s_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = vals[i%nv];
            }
        }
    }
    return;
}

static void
BYTE_fastputmask(byte *in, Bool *mask, npy_intp ni, byte *vals, npy_intp nv)
{
    npy_intp i;
    byte s_val;

    if (nv == 1) {
        s_val = *vals;
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = s_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = vals[i%nv];
            }
        }
    }
    return;
}

static void
UBYTE_fastputmask(ubyte *in, Bool *mask, npy_intp ni, ubyte *vals, npy_intp nv)
{
    npy_intp i;
    ubyte s_val;

    if (nv == 1) {
        s_val = *vals;
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = s_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = vals[i%nv];
            }
        }
    }
    return;
}

static void
SHORT_fastputmask(short *in, Bool *mask, npy_intp ni, short *vals, npy_intp nv)
{
    npy_intp i;
    short s_val;

    if (nv == 1) {
        s_val = *vals;
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = s_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = vals[i%nv];
            }
        }
    }
    return;
}

static void
USHORT_fastputmask(ushort *in, Bool *mask, npy_intp ni, ushort *vals, npy_intp nv)
{
    npy_intp i;
    ushort s_val;

    if (nv == 1) {
        s_val = *vals;
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = s_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = vals[i%nv];
            }
        }
    }
    return;
}

static void
INT_fastputmask(int *in, Bool *mask, npy_intp ni, int *vals, npy_intp nv)
{
    npy_intp i;
    int s_val;

    if (nv == 1) {
        s_val = *vals;
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = s_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = vals[i%nv];
            }
        }
    }
    return;
}

static void
UINT_fastputmask(uint *in, Bool *mask, npy_intp ni, uint *vals, npy_intp nv)
{
    npy_intp i;
    uint s_val;

    if (nv == 1) {
        s_val = *vals;
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = s_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = vals[i%nv];
            }
        }
    }
    return;
}

static void
LONG_fastputmask(long *in, Bool *mask, npy_intp ni, long *vals, npy_intp nv)
{
    npy_intp i;
    long s_val;

    if (nv == 1) {
        s_val = *vals;
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = s_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = vals[i%nv];
            }
        }
    }
    return;
}

static void
ULONG_fastputmask(ulong *in, Bool *mask, npy_intp ni, ulong *vals, npy_intp nv)
{
    npy_intp i;
    ulong s_val;

    if (nv == 1) {
        s_val = *vals;
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = s_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = vals[i%nv];
            }
        }
    }
    return;
}

static void
LONGLONG_fastputmask(longlong *in, Bool *mask, npy_intp ni, longlong *vals, npy_intp nv)
{
    npy_intp i;
    longlong s_val;

    if (nv == 1) {
        s_val = *vals;
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = s_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = vals[i%nv];
            }
        }
    }
    return;
}

static void
ULONGLONG_fastputmask(ulonglong *in, Bool *mask, npy_intp ni, ulonglong *vals, npy_intp nv)
{
    npy_intp i;
    ulonglong s_val;

    if (nv == 1) {
        s_val = *vals;
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = s_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = vals[i%nv];
            }
        }
    }
    return;
}

static void
FLOAT_fastputmask(float *in, Bool *mask, npy_intp ni, float *vals, npy_intp nv)
{
    npy_intp i;
    float s_val;

    if (nv == 1) {
        s_val = *vals;
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = s_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = vals[i%nv];
            }
        }
    }
    return;
}

static void
DOUBLE_fastputmask(double *in, Bool *mask, npy_intp ni, double *vals, npy_intp nv)
{
    npy_intp i;
    double s_val;

    if (nv == 1) {
        s_val = *vals;
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = s_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = vals[i%nv];
            }
        }
    }
    return;
}

static void
LONGDOUBLE_fastputmask(longdouble *in, Bool *mask, npy_intp ni, longdouble *vals, npy_intp nv)
{
    npy_intp i;
    longdouble s_val;

    if (nv == 1) {
        s_val = *vals;
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = s_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = vals[i%nv];
            }
        }
    }
    return;
}

static void
CFLOAT_fastputmask(cfloat *in, Bool *mask, npy_intp ni, cfloat *vals, npy_intp nv)
{
    npy_intp i;
    cfloat s_val;

    if (nv == 1) {
        s_val = *vals;
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = s_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = vals[i%nv];
            }
        }
    }
    return;
}

static void
CDOUBLE_fastputmask(cdouble *in, Bool *mask, npy_intp ni, cdouble *vals, npy_intp nv)
{
    npy_intp i;
    cdouble s_val;

    if (nv == 1) {
        s_val = *vals;
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = s_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = vals[i%nv];
            }
        }
    }
    return;
}

static void
CLONGDOUBLE_fastputmask(clongdouble *in, Bool *mask, npy_intp ni, clongdouble *vals, npy_intp nv)
{
    npy_intp i;
    clongdouble s_val;

    if (nv == 1) {
        s_val = *vals;
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = s_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = vals[i%nv];
            }
        }
    }
    return;
}

static void
DATETIME_fastputmask(datetime *in, Bool *mask, npy_intp ni, datetime *vals, npy_intp nv)
{
    npy_intp i;
    datetime s_val;

    if (nv == 1) {
        s_val = *vals;
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = s_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = vals[i%nv];
            }
        }
    }
    return;
}

static void
TIMEDELTA_fastputmask(timedelta *in, Bool *mask, npy_intp ni, timedelta *vals, npy_intp nv)
{
    npy_intp i;
    timedelta s_val;

    if (nv == 1) {
        s_val = *vals;
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = s_val;
            }
        }
    }
    else {
        for (i = 0; i < ni; i++) {
            if (mask[i]) {
                in[i] = vals[i%nv];
            }
        }
    }
    return;
}




/*
 *****************************************************************************
 **                                FASTTAKE                                 **
 *****************************************************************************
 */


static int
BOOL_fasttake(Bool *dest, Bool *src, npy_intp *indarray,
                    npy_intp nindarray, npy_intp n_outer,
                    npy_intp m_middle, npy_intp nelem,
                    NPY_CLIPMODE clipmode)
{
    npy_intp i, j, k, tmp;

    switch(clipmode) {
    case NPY_RAISE:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = tmp+nindarray;
                }
                if ((tmp < 0) || (tmp >= nindarray)) {
                    NpyErr_SetString(NpyExc_IndexError,
                                     "index out of range for array");
                    return 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_WRAP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    while (tmp < 0) {
                        tmp += nindarray;
                    }
                }
                else if (tmp >= nindarray) {
                    while (tmp >= nindarray) {
                        tmp -= nindarray;
                    }
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src+tmp*nelem+k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_CLIP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = 0;
                }
                else if (tmp >= nindarray) {
                    tmp = nindarray - 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    }
    return 0;
}

static int
BYTE_fasttake(byte *dest, byte *src, npy_intp *indarray,
                    npy_intp nindarray, npy_intp n_outer,
                    npy_intp m_middle, npy_intp nelem,
                    NPY_CLIPMODE clipmode)
{
    npy_intp i, j, k, tmp;

    switch(clipmode) {
    case NPY_RAISE:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = tmp+nindarray;
                }
                if ((tmp < 0) || (tmp >= nindarray)) {
                    NpyErr_SetString(NpyExc_IndexError,
                                     "index out of range for array");
                    return 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_WRAP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    while (tmp < 0) {
                        tmp += nindarray;
                    }
                }
                else if (tmp >= nindarray) {
                    while (tmp >= nindarray) {
                        tmp -= nindarray;
                    }
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src+tmp*nelem+k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_CLIP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = 0;
                }
                else if (tmp >= nindarray) {
                    tmp = nindarray - 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    }
    return 0;
}

static int
UBYTE_fasttake(ubyte *dest, ubyte *src, npy_intp *indarray,
                    npy_intp nindarray, npy_intp n_outer,
                    npy_intp m_middle, npy_intp nelem,
                    NPY_CLIPMODE clipmode)
{
    npy_intp i, j, k, tmp;

    switch(clipmode) {
    case NPY_RAISE:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = tmp+nindarray;
                }
                if ((tmp < 0) || (tmp >= nindarray)) {
                    NpyErr_SetString(NpyExc_IndexError,
                                     "index out of range for array");
                    return 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_WRAP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    while (tmp < 0) {
                        tmp += nindarray;
                    }
                }
                else if (tmp >= nindarray) {
                    while (tmp >= nindarray) {
                        tmp -= nindarray;
                    }
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src+tmp*nelem+k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_CLIP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = 0;
                }
                else if (tmp >= nindarray) {
                    tmp = nindarray - 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    }
    return 0;
}

static int
SHORT_fasttake(short *dest, short *src, npy_intp *indarray,
                    npy_intp nindarray, npy_intp n_outer,
                    npy_intp m_middle, npy_intp nelem,
                    NPY_CLIPMODE clipmode)
{
    npy_intp i, j, k, tmp;

    switch(clipmode) {
    case NPY_RAISE:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = tmp+nindarray;
                }
                if ((tmp < 0) || (tmp >= nindarray)) {
                    NpyErr_SetString(NpyExc_IndexError,
                                     "index out of range for array");
                    return 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_WRAP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    while (tmp < 0) {
                        tmp += nindarray;
                    }
                }
                else if (tmp >= nindarray) {
                    while (tmp >= nindarray) {
                        tmp -= nindarray;
                    }
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src+tmp*nelem+k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_CLIP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = 0;
                }
                else if (tmp >= nindarray) {
                    tmp = nindarray - 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    }
    return 0;
}

static int
USHORT_fasttake(ushort *dest, ushort *src, npy_intp *indarray,
                    npy_intp nindarray, npy_intp n_outer,
                    npy_intp m_middle, npy_intp nelem,
                    NPY_CLIPMODE clipmode)
{
    npy_intp i, j, k, tmp;

    switch(clipmode) {
    case NPY_RAISE:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = tmp+nindarray;
                }
                if ((tmp < 0) || (tmp >= nindarray)) {
                    NpyErr_SetString(NpyExc_IndexError,
                                     "index out of range for array");
                    return 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_WRAP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    while (tmp < 0) {
                        tmp += nindarray;
                    }
                }
                else if (tmp >= nindarray) {
                    while (tmp >= nindarray) {
                        tmp -= nindarray;
                    }
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src+tmp*nelem+k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_CLIP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = 0;
                }
                else if (tmp >= nindarray) {
                    tmp = nindarray - 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    }
    return 0;
}

static int
INT_fasttake(int *dest, int *src, npy_intp *indarray,
                    npy_intp nindarray, npy_intp n_outer,
                    npy_intp m_middle, npy_intp nelem,
                    NPY_CLIPMODE clipmode)
{
    npy_intp i, j, k, tmp;

    switch(clipmode) {
    case NPY_RAISE:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = tmp+nindarray;
                }
                if ((tmp < 0) || (tmp >= nindarray)) {
                    NpyErr_SetString(NpyExc_IndexError,
                                     "index out of range for array");
                    return 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_WRAP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    while (tmp < 0) {
                        tmp += nindarray;
                    }
                }
                else if (tmp >= nindarray) {
                    while (tmp >= nindarray) {
                        tmp -= nindarray;
                    }
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src+tmp*nelem+k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_CLIP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = 0;
                }
                else if (tmp >= nindarray) {
                    tmp = nindarray - 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    }
    return 0;
}

static int
UINT_fasttake(uint *dest, uint *src, npy_intp *indarray,
                    npy_intp nindarray, npy_intp n_outer,
                    npy_intp m_middle, npy_intp nelem,
                    NPY_CLIPMODE clipmode)
{
    npy_intp i, j, k, tmp;

    switch(clipmode) {
    case NPY_RAISE:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = tmp+nindarray;
                }
                if ((tmp < 0) || (tmp >= nindarray)) {
                    NpyErr_SetString(NpyExc_IndexError,
                                     "index out of range for array");
                    return 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_WRAP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    while (tmp < 0) {
                        tmp += nindarray;
                    }
                }
                else if (tmp >= nindarray) {
                    while (tmp >= nindarray) {
                        tmp -= nindarray;
                    }
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src+tmp*nelem+k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_CLIP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = 0;
                }
                else if (tmp >= nindarray) {
                    tmp = nindarray - 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    }
    return 0;
}

static int
LONG_fasttake(long *dest, long *src, npy_intp *indarray,
                    npy_intp nindarray, npy_intp n_outer,
                    npy_intp m_middle, npy_intp nelem,
                    NPY_CLIPMODE clipmode)
{
    npy_intp i, j, k, tmp;

    switch(clipmode) {
    case NPY_RAISE:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = tmp+nindarray;
                }
                if ((tmp < 0) || (tmp >= nindarray)) {
                    NpyErr_SetString(NpyExc_IndexError,
                                     "index out of range for array");
                    return 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_WRAP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    while (tmp < 0) {
                        tmp += nindarray;
                    }
                }
                else if (tmp >= nindarray) {
                    while (tmp >= nindarray) {
                        tmp -= nindarray;
                    }
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src+tmp*nelem+k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_CLIP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = 0;
                }
                else if (tmp >= nindarray) {
                    tmp = nindarray - 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    }
    return 0;
}

static int
ULONG_fasttake(ulong *dest, ulong *src, npy_intp *indarray,
                    npy_intp nindarray, npy_intp n_outer,
                    npy_intp m_middle, npy_intp nelem,
                    NPY_CLIPMODE clipmode)
{
    npy_intp i, j, k, tmp;

    switch(clipmode) {
    case NPY_RAISE:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = tmp+nindarray;
                }
                if ((tmp < 0) || (tmp >= nindarray)) {
                    NpyErr_SetString(NpyExc_IndexError,
                                     "index out of range for array");
                    return 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_WRAP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    while (tmp < 0) {
                        tmp += nindarray;
                    }
                }
                else if (tmp >= nindarray) {
                    while (tmp >= nindarray) {
                        tmp -= nindarray;
                    }
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src+tmp*nelem+k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_CLIP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = 0;
                }
                else if (tmp >= nindarray) {
                    tmp = nindarray - 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    }
    return 0;
}

static int
LONGLONG_fasttake(longlong *dest, longlong *src, npy_intp *indarray,
                    npy_intp nindarray, npy_intp n_outer,
                    npy_intp m_middle, npy_intp nelem,
                    NPY_CLIPMODE clipmode)
{
    npy_intp i, j, k, tmp;

    switch(clipmode) {
    case NPY_RAISE:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = tmp+nindarray;
                }
                if ((tmp < 0) || (tmp >= nindarray)) {
                    NpyErr_SetString(NpyExc_IndexError,
                                     "index out of range for array");
                    return 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_WRAP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    while (tmp < 0) {
                        tmp += nindarray;
                    }
                }
                else if (tmp >= nindarray) {
                    while (tmp >= nindarray) {
                        tmp -= nindarray;
                    }
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src+tmp*nelem+k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_CLIP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = 0;
                }
                else if (tmp >= nindarray) {
                    tmp = nindarray - 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    }
    return 0;
}

static int
ULONGLONG_fasttake(ulonglong *dest, ulonglong *src, npy_intp *indarray,
                    npy_intp nindarray, npy_intp n_outer,
                    npy_intp m_middle, npy_intp nelem,
                    NPY_CLIPMODE clipmode)
{
    npy_intp i, j, k, tmp;

    switch(clipmode) {
    case NPY_RAISE:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = tmp+nindarray;
                }
                if ((tmp < 0) || (tmp >= nindarray)) {
                    NpyErr_SetString(NpyExc_IndexError,
                                     "index out of range for array");
                    return 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_WRAP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    while (tmp < 0) {
                        tmp += nindarray;
                    }
                }
                else if (tmp >= nindarray) {
                    while (tmp >= nindarray) {
                        tmp -= nindarray;
                    }
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src+tmp*nelem+k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_CLIP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = 0;
                }
                else if (tmp >= nindarray) {
                    tmp = nindarray - 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    }
    return 0;
}

static int
FLOAT_fasttake(float *dest, float *src, npy_intp *indarray,
                    npy_intp nindarray, npy_intp n_outer,
                    npy_intp m_middle, npy_intp nelem,
                    NPY_CLIPMODE clipmode)
{
    npy_intp i, j, k, tmp;

    switch(clipmode) {
    case NPY_RAISE:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = tmp+nindarray;
                }
                if ((tmp < 0) || (tmp >= nindarray)) {
                    NpyErr_SetString(NpyExc_IndexError,
                                     "index out of range for array");
                    return 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_WRAP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    while (tmp < 0) {
                        tmp += nindarray;
                    }
                }
                else if (tmp >= nindarray) {
                    while (tmp >= nindarray) {
                        tmp -= nindarray;
                    }
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src+tmp*nelem+k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_CLIP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = 0;
                }
                else if (tmp >= nindarray) {
                    tmp = nindarray - 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    }
    return 0;
}

static int
DOUBLE_fasttake(double *dest, double *src, npy_intp *indarray,
                    npy_intp nindarray, npy_intp n_outer,
                    npy_intp m_middle, npy_intp nelem,
                    NPY_CLIPMODE clipmode)
{
    npy_intp i, j, k, tmp;

    switch(clipmode) {
    case NPY_RAISE:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = tmp+nindarray;
                }
                if ((tmp < 0) || (tmp >= nindarray)) {
                    NpyErr_SetString(NpyExc_IndexError,
                                     "index out of range for array");
                    return 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_WRAP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    while (tmp < 0) {
                        tmp += nindarray;
                    }
                }
                else if (tmp >= nindarray) {
                    while (tmp >= nindarray) {
                        tmp -= nindarray;
                    }
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src+tmp*nelem+k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_CLIP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = 0;
                }
                else if (tmp >= nindarray) {
                    tmp = nindarray - 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    }
    return 0;
}

static int
LONGDOUBLE_fasttake(longdouble *dest, longdouble *src, npy_intp *indarray,
                    npy_intp nindarray, npy_intp n_outer,
                    npy_intp m_middle, npy_intp nelem,
                    NPY_CLIPMODE clipmode)
{
    npy_intp i, j, k, tmp;

    switch(clipmode) {
    case NPY_RAISE:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = tmp+nindarray;
                }
                if ((tmp < 0) || (tmp >= nindarray)) {
                    NpyErr_SetString(NpyExc_IndexError,
                                     "index out of range for array");
                    return 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_WRAP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    while (tmp < 0) {
                        tmp += nindarray;
                    }
                }
                else if (tmp >= nindarray) {
                    while (tmp >= nindarray) {
                        tmp -= nindarray;
                    }
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src+tmp*nelem+k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_CLIP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = 0;
                }
                else if (tmp >= nindarray) {
                    tmp = nindarray - 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    }
    return 0;
}

static int
CFLOAT_fasttake(cfloat *dest, cfloat *src, npy_intp *indarray,
                    npy_intp nindarray, npy_intp n_outer,
                    npy_intp m_middle, npy_intp nelem,
                    NPY_CLIPMODE clipmode)
{
    npy_intp i, j, k, tmp;

    switch(clipmode) {
    case NPY_RAISE:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = tmp+nindarray;
                }
                if ((tmp < 0) || (tmp >= nindarray)) {
                    NpyErr_SetString(NpyExc_IndexError,
                                     "index out of range for array");
                    return 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_WRAP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    while (tmp < 0) {
                        tmp += nindarray;
                    }
                }
                else if (tmp >= nindarray) {
                    while (tmp >= nindarray) {
                        tmp -= nindarray;
                    }
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src+tmp*nelem+k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_CLIP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = 0;
                }
                else if (tmp >= nindarray) {
                    tmp = nindarray - 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    }
    return 0;
}

static int
CDOUBLE_fasttake(cdouble *dest, cdouble *src, npy_intp *indarray,
                    npy_intp nindarray, npy_intp n_outer,
                    npy_intp m_middle, npy_intp nelem,
                    NPY_CLIPMODE clipmode)
{
    npy_intp i, j, k, tmp;

    switch(clipmode) {
    case NPY_RAISE:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = tmp+nindarray;
                }
                if ((tmp < 0) || (tmp >= nindarray)) {
                    NpyErr_SetString(NpyExc_IndexError,
                                     "index out of range for array");
                    return 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_WRAP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    while (tmp < 0) {
                        tmp += nindarray;
                    }
                }
                else if (tmp >= nindarray) {
                    while (tmp >= nindarray) {
                        tmp -= nindarray;
                    }
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src+tmp*nelem+k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_CLIP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = 0;
                }
                else if (tmp >= nindarray) {
                    tmp = nindarray - 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    }
    return 0;
}

static int
CLONGDOUBLE_fasttake(clongdouble *dest, clongdouble *src, npy_intp *indarray,
                    npy_intp nindarray, npy_intp n_outer,
                    npy_intp m_middle, npy_intp nelem,
                    NPY_CLIPMODE clipmode)
{
    npy_intp i, j, k, tmp;

    switch(clipmode) {
    case NPY_RAISE:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = tmp+nindarray;
                }
                if ((tmp < 0) || (tmp >= nindarray)) {
                    NpyErr_SetString(NpyExc_IndexError,
                                     "index out of range for array");
                    return 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_WRAP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    while (tmp < 0) {
                        tmp += nindarray;
                    }
                }
                else if (tmp >= nindarray) {
                    while (tmp >= nindarray) {
                        tmp -= nindarray;
                    }
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src+tmp*nelem+k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_CLIP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = 0;
                }
                else if (tmp >= nindarray) {
                    tmp = nindarray - 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    }
    return 0;
}

static int
DATETIME_fasttake(datetime *dest, datetime *src, npy_intp *indarray,
                    npy_intp nindarray, npy_intp n_outer,
                    npy_intp m_middle, npy_intp nelem,
                    NPY_CLIPMODE clipmode)
{
    npy_intp i, j, k, tmp;

    switch(clipmode) {
    case NPY_RAISE:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = tmp+nindarray;
                }
                if ((tmp < 0) || (tmp >= nindarray)) {
                    NpyErr_SetString(NpyExc_IndexError,
                                     "index out of range for array");
                    return 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_WRAP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    while (tmp < 0) {
                        tmp += nindarray;
                    }
                }
                else if (tmp >= nindarray) {
                    while (tmp >= nindarray) {
                        tmp -= nindarray;
                    }
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src+tmp*nelem+k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_CLIP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = 0;
                }
                else if (tmp >= nindarray) {
                    tmp = nindarray - 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    }
    return 0;
}

static int
TIMEDELTA_fasttake(timedelta *dest, timedelta *src, npy_intp *indarray,
                    npy_intp nindarray, npy_intp n_outer,
                    npy_intp m_middle, npy_intp nelem,
                    NPY_CLIPMODE clipmode)
{
    npy_intp i, j, k, tmp;

    switch(clipmode) {
    case NPY_RAISE:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = tmp+nindarray;
                }
                if ((tmp < 0) || (tmp >= nindarray)) {
                    NpyErr_SetString(NpyExc_IndexError,
                                     "index out of range for array");
                    return 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_WRAP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    while (tmp < 0) {
                        tmp += nindarray;
                    }
                }
                else if (tmp >= nindarray) {
                    while (tmp >= nindarray) {
                        tmp -= nindarray;
                    }
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src+tmp*nelem+k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    case NPY_CLIP:
        for (i = 0; i < n_outer; i++) {
            for (j = 0; j < m_middle; j++) {
                tmp = indarray[j];
                if (tmp < 0) {
                    tmp = 0;
                }
                else if (tmp >= nindarray) {
                    tmp = nindarray - 1;
                }
                if (nelem == 1) {
                    *dest++ = *(src+tmp);
                }
                else {
                    for (k = 0; k < nelem; k++) {
                        *dest++ = *(src + tmp*nelem + k);
                    }
                }
            }
            src += nelem*nindarray;
        }
        break;
    }
    return 0;
}




/*
 *****************************************************************************
 **                       SETUP FUNCTION POINTERS                           **
 *****************************************************************************
 */

#define offsetof(type, member) ( (npy_intp) & ((type*)0) -> member )
#define _ALIGN(type) offsetof(struct {char c; type v;}, v)
/*
 * Disable harmless compiler warning "4116: unnamed type definition in
 * parentheses" which is caused by the _ALIGN macro.
 */
#if defined(_MSC_VER)
#pragma warning(disable:4116)
#endif


static NpyArray_ArrFuncs _NpyVoid_ArrFuncs = {
    NULL, NULL,
    (NpyArray_CopySwapNFunc*)VOID_copyswapn,
    (NpyArray_CopySwapFunc*)VOID_copyswap,
    (NpyArray_CompareFunc*)VOID_compare,
    (NpyArray_ArgFunc*)VOID_argmax,
    (NpyArray_DotFunc*)NULL,
    (NpyArray_ScanFunc*)VOID_scan,
    (NpyArray_FromStrFunc*)VOID_fromstr,
    (NpyArray_NonzeroFunc*)VOID_nonzero,
    (NpyArray_FillFunc*)NULL,
    (NpyArray_FillWithScalarFunc*)NULL,
    {
        NULL, NULL, NULL
    },
    {
        NULL, NULL, NULL
    },
    NULL,
    (NpyArray_ScalarKindFunc*)NULL,
    NULL,
    NULL,
    (NpyArray_FastClipFunc *)NULL,
    (NpyArray_FastPutmaskFunc *)NULL,
    (NpyArray_FastTakeFunc *)NULL,
    NULL, NULL, NULL, NULL,
    {
        NULL, NULL, NULL, NULL, NULL,
        NULL, NULL, NULL, NULL, NULL,
        NULL, NULL, NULL, NULL, NULL,
        NULL, NULL, NULL, NULL,
    }
};

/*
 * FIXME: check for PY3K
 */
NpyArray_Descr VOID_Descr = {
    _NpyObject_HEAD_INIT(&NpyArrayDescr_Type)
    NPY_VALID_MAGIC,
    NpyArray_VOIDLTR,
    NpyArray_VOIDLTR,
    '|',
    0,
    0,
    NpyArray_VOID,
    0,
    _ALIGN(char),
    NULL,
    NULL,
    NULL,
    &_NpyVoid_ArrFuncs,
    NULL,
};


static NpyArray_ArrFuncs _NpyString_ArrFuncs = {
    NULL, NULL,
    (NpyArray_CopySwapNFunc*)STRING_copyswapn,
    (NpyArray_CopySwapFunc*)STRING_copyswap,
    (NpyArray_CompareFunc*)STRING_compare,
    (NpyArray_ArgFunc*)STRING_argmax,
    (NpyArray_DotFunc*)NULL,
    (NpyArray_ScanFunc*)STRING_scan,
    (NpyArray_FromStrFunc*)STRING_fromstr,
    (NpyArray_NonzeroFunc*)STRING_nonzero,
    (NpyArray_FillFunc*)NULL,
    (NpyArray_FillWithScalarFunc*)NULL,
    {
        NULL, NULL, NULL
    },
    {
        NULL, NULL, NULL
    },
    NULL,
    (NpyArray_ScalarKindFunc*)NULL,
    NULL,
    NULL,
    (NpyArray_FastClipFunc *)NULL,
    (NpyArray_FastPutmaskFunc *)NULL,
    (NpyArray_FastTakeFunc *)NULL,
    NULL, NULL, NULL, NULL,
    {
        NULL, NULL, NULL, NULL, NULL,
        NULL, NULL, NULL, NULL, NULL,
        NULL, NULL, NULL, NULL, NULL,
        NULL, NULL, NULL, NULL,
    }
};

/*
 * FIXME: check for PY3K
 */
NpyArray_Descr STRING_Descr = {
    _NpyObject_HEAD_INIT(&NpyArrayDescr_Type)
    NPY_VALID_MAGIC,
    NpyArray_STRINGLTR,
    NpyArray_STRINGLTR,
    '|',
    0,
    0,
    NpyArray_STRING,
    0,
    _ALIGN(char),
    NULL,
    NULL,
    NULL,
    &_NpyString_ArrFuncs,
    NULL,
};


static NpyArray_ArrFuncs _NpyUnicode_ArrFuncs = {
    NULL, NULL,
    (NpyArray_CopySwapNFunc*)UNICODE_copyswapn,
    (NpyArray_CopySwapFunc*)UNICODE_copyswap,
    (NpyArray_CompareFunc*)UNICODE_compare,
    (NpyArray_ArgFunc*)UNICODE_argmax,
    (NpyArray_DotFunc*)NULL,
    (NpyArray_ScanFunc*)UNICODE_scan,
    (NpyArray_FromStrFunc*)UNICODE_fromstr,
    (NpyArray_NonzeroFunc*)UNICODE_nonzero,
    (NpyArray_FillFunc*)NULL,
    (NpyArray_FillWithScalarFunc*)NULL,
    {
        NULL, NULL, NULL
    },
    {
        NULL, NULL, NULL
    },
    NULL,
    (NpyArray_ScalarKindFunc*)NULL,
    NULL,
    NULL,
    (NpyArray_FastClipFunc *)NULL,
    (NpyArray_FastPutmaskFunc *)NULL,
    (NpyArray_FastTakeFunc *)NULL,
    NULL, NULL, NULL, NULL,
    {
        NULL, NULL, NULL, NULL, NULL,
        NULL, NULL, NULL, NULL, NULL,
        NULL, NULL, NULL, NULL, NULL,
        NULL, NULL, NULL, NULL,
    }
};

/*
 * FIXME: check for PY3K
 */
NpyArray_Descr UNICODE_Descr = {
    _NpyObject_HEAD_INIT(&NpyArrayDescr_Type)
    NPY_VALID_MAGIC,
    NpyArray_UNICODELTR,
    NpyArray_UNICODELTR,
    '=',
    0,
    0,
    NpyArray_UNICODE,
    0,
    _ALIGN(NpyArray_UCS4),
    NULL,
    NULL,
    NULL,
    &_NpyUnicode_ArrFuncs,
    NULL,
};




static NpyArray_ArrFuncs _NpyBool_ArrFuncs = {
    NULL, NULL,
    (NpyArray_CopySwapNFunc*)BOOL_copyswapn,
    (NpyArray_CopySwapFunc*)BOOL_copyswap,
    (NpyArray_CompareFunc*)BOOL_compare,
    (NpyArray_ArgFunc*)BOOL_argmax,
    (NpyArray_DotFunc*)BOOL_dot,
    (NpyArray_ScanFunc*)BOOL_scan,
    (NpyArray_FromStrFunc*)BOOL_fromstr,
    (NpyArray_NonzeroFunc*)BOOL_nonzero,
    (NpyArray_FillFunc*)BOOL_fill,
    (NpyArray_FillWithScalarFunc*)BOOL_fillwithscalar,
    {
        NULL, NULL, NULL
    },
    {
        NULL, NULL, NULL
    },
    NULL,
    (NpyArray_ScalarKindFunc*)NULL,
    NULL,
    NULL,
    (NpyArray_FastClipFunc*)BOOL_fastclip,
    (NpyArray_FastPutmaskFunc*)BOOL_fastputmask,
    (NpyArray_FastTakeFunc*)BOOL_fasttake,
    NULL, NULL, NULL, NULL,
    {
        (NpyArray_VectorUnaryFunc*)BOOL_to_BOOL,
        (NpyArray_VectorUnaryFunc*)BOOL_to_BYTE,
        (NpyArray_VectorUnaryFunc*)BOOL_to_UBYTE,
        (NpyArray_VectorUnaryFunc*)BOOL_to_SHORT,
        (NpyArray_VectorUnaryFunc*)BOOL_to_USHORT,
        (NpyArray_VectorUnaryFunc*)BOOL_to_INT,
        (NpyArray_VectorUnaryFunc*)BOOL_to_UINT,
        (NpyArray_VectorUnaryFunc*)BOOL_to_LONG,
        (NpyArray_VectorUnaryFunc*)BOOL_to_ULONG,
        (NpyArray_VectorUnaryFunc*)BOOL_to_LONGLONG,
        (NpyArray_VectorUnaryFunc*)BOOL_to_ULONGLONG,
        (NpyArray_VectorUnaryFunc*)BOOL_to_FLOAT,
        (NpyArray_VectorUnaryFunc*)BOOL_to_DOUBLE,
        (NpyArray_VectorUnaryFunc*)BOOL_to_LONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)BOOL_to_CFLOAT,
        (NpyArray_VectorUnaryFunc*)BOOL_to_CDOUBLE,
        (NpyArray_VectorUnaryFunc*)BOOL_to_CLONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)BOOL_to_DATETIME,
        (NpyArray_VectorUnaryFunc*)BOOL_to_TIMEDELTA,
        NULL, NULL, NULL, NULL
    }
};

/*
 * FIXME: check for PY3K
 */
NpyArray_Descr BOOL_Descr = {
    _NpyObject_HEAD_INIT(&NpyArrayDescr_Type)
    NPY_VALID_MAGIC,
    NpyArray_GENBOOLLTR,
    NpyArray_BOOLLTR,
    '|',
    0,
    0,
    NpyArray_BOOL,
    1*sizeof(Bool),
    _ALIGN(Bool),
    NULL,
    NULL,
    NULL,
    &_NpyBool_ArrFuncs,
    NULL,
};


static NpyArray_ArrFuncs _NpyByte_ArrFuncs = {
    NULL, NULL,
    (NpyArray_CopySwapNFunc*)BYTE_copyswapn,
    (NpyArray_CopySwapFunc*)BYTE_copyswap,
    (NpyArray_CompareFunc*)BYTE_compare,
    (NpyArray_ArgFunc*)BYTE_argmax,
    (NpyArray_DotFunc*)BYTE_dot,
    (NpyArray_ScanFunc*)BYTE_scan,
    (NpyArray_FromStrFunc*)BYTE_fromstr,
    (NpyArray_NonzeroFunc*)BYTE_nonzero,
    (NpyArray_FillFunc*)BYTE_fill,
    (NpyArray_FillWithScalarFunc*)BYTE_fillwithscalar,
    {
        NULL, NULL, NULL
    },
    {
        NULL, NULL, NULL
    },
    NULL,
    (NpyArray_ScalarKindFunc*)NULL,
    NULL,
    NULL,
    (NpyArray_FastClipFunc*)BYTE_fastclip,
    (NpyArray_FastPutmaskFunc*)BYTE_fastputmask,
    (NpyArray_FastTakeFunc*)BYTE_fasttake,
    NULL, NULL, NULL, NULL,
    {
        (NpyArray_VectorUnaryFunc*)BYTE_to_BOOL,
        (NpyArray_VectorUnaryFunc*)BYTE_to_BYTE,
        (NpyArray_VectorUnaryFunc*)BYTE_to_UBYTE,
        (NpyArray_VectorUnaryFunc*)BYTE_to_SHORT,
        (NpyArray_VectorUnaryFunc*)BYTE_to_USHORT,
        (NpyArray_VectorUnaryFunc*)BYTE_to_INT,
        (NpyArray_VectorUnaryFunc*)BYTE_to_UINT,
        (NpyArray_VectorUnaryFunc*)BYTE_to_LONG,
        (NpyArray_VectorUnaryFunc*)BYTE_to_ULONG,
        (NpyArray_VectorUnaryFunc*)BYTE_to_LONGLONG,
        (NpyArray_VectorUnaryFunc*)BYTE_to_ULONGLONG,
        (NpyArray_VectorUnaryFunc*)BYTE_to_FLOAT,
        (NpyArray_VectorUnaryFunc*)BYTE_to_DOUBLE,
        (NpyArray_VectorUnaryFunc*)BYTE_to_LONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)BYTE_to_CFLOAT,
        (NpyArray_VectorUnaryFunc*)BYTE_to_CDOUBLE,
        (NpyArray_VectorUnaryFunc*)BYTE_to_CLONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)BYTE_to_DATETIME,
        (NpyArray_VectorUnaryFunc*)BYTE_to_TIMEDELTA,
        NULL, NULL, NULL, NULL
    }
};

/*
 * FIXME: check for PY3K
 */
NpyArray_Descr BYTE_Descr = {
    _NpyObject_HEAD_INIT(&NpyArrayDescr_Type)
    NPY_VALID_MAGIC,
    NpyArray_SIGNEDLTR,
    NpyArray_BYTELTR,
    '|',
    0,
    0,
    NpyArray_BYTE,
    1*sizeof(byte),
    _ALIGN(byte),
    NULL,
    NULL,
    NULL,
    &_NpyByte_ArrFuncs,
    NULL,
};


static NpyArray_ArrFuncs _NpyUByte_ArrFuncs = {
    NULL, NULL,
    (NpyArray_CopySwapNFunc*)UBYTE_copyswapn,
    (NpyArray_CopySwapFunc*)UBYTE_copyswap,
    (NpyArray_CompareFunc*)UBYTE_compare,
    (NpyArray_ArgFunc*)UBYTE_argmax,
    (NpyArray_DotFunc*)UBYTE_dot,
    (NpyArray_ScanFunc*)UBYTE_scan,
    (NpyArray_FromStrFunc*)UBYTE_fromstr,
    (NpyArray_NonzeroFunc*)UBYTE_nonzero,
    (NpyArray_FillFunc*)UBYTE_fill,
    (NpyArray_FillWithScalarFunc*)UBYTE_fillwithscalar,
    {
        NULL, NULL, NULL
    },
    {
        NULL, NULL, NULL
    },
    NULL,
    (NpyArray_ScalarKindFunc*)NULL,
    NULL,
    NULL,
    (NpyArray_FastClipFunc*)UBYTE_fastclip,
    (NpyArray_FastPutmaskFunc*)UBYTE_fastputmask,
    (NpyArray_FastTakeFunc*)UBYTE_fasttake,
    NULL, NULL, NULL, NULL,
    {
        (NpyArray_VectorUnaryFunc*)UBYTE_to_BOOL,
        (NpyArray_VectorUnaryFunc*)UBYTE_to_BYTE,
        (NpyArray_VectorUnaryFunc*)UBYTE_to_UBYTE,
        (NpyArray_VectorUnaryFunc*)UBYTE_to_SHORT,
        (NpyArray_VectorUnaryFunc*)UBYTE_to_USHORT,
        (NpyArray_VectorUnaryFunc*)UBYTE_to_INT,
        (NpyArray_VectorUnaryFunc*)UBYTE_to_UINT,
        (NpyArray_VectorUnaryFunc*)UBYTE_to_LONG,
        (NpyArray_VectorUnaryFunc*)UBYTE_to_ULONG,
        (NpyArray_VectorUnaryFunc*)UBYTE_to_LONGLONG,
        (NpyArray_VectorUnaryFunc*)UBYTE_to_ULONGLONG,
        (NpyArray_VectorUnaryFunc*)UBYTE_to_FLOAT,
        (NpyArray_VectorUnaryFunc*)UBYTE_to_DOUBLE,
        (NpyArray_VectorUnaryFunc*)UBYTE_to_LONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)UBYTE_to_CFLOAT,
        (NpyArray_VectorUnaryFunc*)UBYTE_to_CDOUBLE,
        (NpyArray_VectorUnaryFunc*)UBYTE_to_CLONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)UBYTE_to_DATETIME,
        (NpyArray_VectorUnaryFunc*)UBYTE_to_TIMEDELTA,
        NULL, NULL, NULL, NULL
    }
};

/*
 * FIXME: check for PY3K
 */
NpyArray_Descr UBYTE_Descr = {
    _NpyObject_HEAD_INIT(&NpyArrayDescr_Type)
    NPY_VALID_MAGIC,
    NpyArray_UNSIGNEDLTR,
    NpyArray_UBYTELTR,
    '|',
    0,
    0,
    NpyArray_UBYTE,
    1*sizeof(ubyte),
    _ALIGN(ubyte),
    NULL,
    NULL,
    NULL,
    &_NpyUByte_ArrFuncs,
    NULL,
};


static NpyArray_ArrFuncs _NpyShort_ArrFuncs = {
    NULL, NULL,
    (NpyArray_CopySwapNFunc*)SHORT_copyswapn,
    (NpyArray_CopySwapFunc*)SHORT_copyswap,
    (NpyArray_CompareFunc*)SHORT_compare,
    (NpyArray_ArgFunc*)SHORT_argmax,
    (NpyArray_DotFunc*)SHORT_dot,
    (NpyArray_ScanFunc*)SHORT_scan,
    (NpyArray_FromStrFunc*)SHORT_fromstr,
    (NpyArray_NonzeroFunc*)SHORT_nonzero,
    (NpyArray_FillFunc*)SHORT_fill,
    (NpyArray_FillWithScalarFunc*)SHORT_fillwithscalar,
    {
        NULL, NULL, NULL
    },
    {
        NULL, NULL, NULL
    },
    NULL,
    (NpyArray_ScalarKindFunc*)NULL,
    NULL,
    NULL,
    (NpyArray_FastClipFunc*)SHORT_fastclip,
    (NpyArray_FastPutmaskFunc*)SHORT_fastputmask,
    (NpyArray_FastTakeFunc*)SHORT_fasttake,
    NULL, NULL, NULL, NULL,
    {
        (NpyArray_VectorUnaryFunc*)SHORT_to_BOOL,
        (NpyArray_VectorUnaryFunc*)SHORT_to_BYTE,
        (NpyArray_VectorUnaryFunc*)SHORT_to_UBYTE,
        (NpyArray_VectorUnaryFunc*)SHORT_to_SHORT,
        (NpyArray_VectorUnaryFunc*)SHORT_to_USHORT,
        (NpyArray_VectorUnaryFunc*)SHORT_to_INT,
        (NpyArray_VectorUnaryFunc*)SHORT_to_UINT,
        (NpyArray_VectorUnaryFunc*)SHORT_to_LONG,
        (NpyArray_VectorUnaryFunc*)SHORT_to_ULONG,
        (NpyArray_VectorUnaryFunc*)SHORT_to_LONGLONG,
        (NpyArray_VectorUnaryFunc*)SHORT_to_ULONGLONG,
        (NpyArray_VectorUnaryFunc*)SHORT_to_FLOAT,
        (NpyArray_VectorUnaryFunc*)SHORT_to_DOUBLE,
        (NpyArray_VectorUnaryFunc*)SHORT_to_LONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)SHORT_to_CFLOAT,
        (NpyArray_VectorUnaryFunc*)SHORT_to_CDOUBLE,
        (NpyArray_VectorUnaryFunc*)SHORT_to_CLONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)SHORT_to_DATETIME,
        (NpyArray_VectorUnaryFunc*)SHORT_to_TIMEDELTA,
        NULL, NULL, NULL, NULL
    }
};

/*
 * FIXME: check for PY3K
 */
NpyArray_Descr SHORT_Descr = {
    _NpyObject_HEAD_INIT(&NpyArrayDescr_Type)
    NPY_VALID_MAGIC,
    NpyArray_SIGNEDLTR,
    NpyArray_SHORTLTR,
    '=',
    0,
    0,
    NpyArray_SHORT,
    1*sizeof(short),
    _ALIGN(short),
    NULL,
    NULL,
    NULL,
    &_NpyShort_ArrFuncs,
    NULL,
};


static NpyArray_ArrFuncs _NpyUShort_ArrFuncs = {
    NULL, NULL,
    (NpyArray_CopySwapNFunc*)USHORT_copyswapn,
    (NpyArray_CopySwapFunc*)USHORT_copyswap,
    (NpyArray_CompareFunc*)USHORT_compare,
    (NpyArray_ArgFunc*)USHORT_argmax,
    (NpyArray_DotFunc*)USHORT_dot,
    (NpyArray_ScanFunc*)USHORT_scan,
    (NpyArray_FromStrFunc*)USHORT_fromstr,
    (NpyArray_NonzeroFunc*)USHORT_nonzero,
    (NpyArray_FillFunc*)USHORT_fill,
    (NpyArray_FillWithScalarFunc*)USHORT_fillwithscalar,
    {
        NULL, NULL, NULL
    },
    {
        NULL, NULL, NULL
    },
    NULL,
    (NpyArray_ScalarKindFunc*)NULL,
    NULL,
    NULL,
    (NpyArray_FastClipFunc*)USHORT_fastclip,
    (NpyArray_FastPutmaskFunc*)USHORT_fastputmask,
    (NpyArray_FastTakeFunc*)USHORT_fasttake,
    NULL, NULL, NULL, NULL,
    {
        (NpyArray_VectorUnaryFunc*)USHORT_to_BOOL,
        (NpyArray_VectorUnaryFunc*)USHORT_to_BYTE,
        (NpyArray_VectorUnaryFunc*)USHORT_to_UBYTE,
        (NpyArray_VectorUnaryFunc*)USHORT_to_SHORT,
        (NpyArray_VectorUnaryFunc*)USHORT_to_USHORT,
        (NpyArray_VectorUnaryFunc*)USHORT_to_INT,
        (NpyArray_VectorUnaryFunc*)USHORT_to_UINT,
        (NpyArray_VectorUnaryFunc*)USHORT_to_LONG,
        (NpyArray_VectorUnaryFunc*)USHORT_to_ULONG,
        (NpyArray_VectorUnaryFunc*)USHORT_to_LONGLONG,
        (NpyArray_VectorUnaryFunc*)USHORT_to_ULONGLONG,
        (NpyArray_VectorUnaryFunc*)USHORT_to_FLOAT,
        (NpyArray_VectorUnaryFunc*)USHORT_to_DOUBLE,
        (NpyArray_VectorUnaryFunc*)USHORT_to_LONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)USHORT_to_CFLOAT,
        (NpyArray_VectorUnaryFunc*)USHORT_to_CDOUBLE,
        (NpyArray_VectorUnaryFunc*)USHORT_to_CLONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)USHORT_to_DATETIME,
        (NpyArray_VectorUnaryFunc*)USHORT_to_TIMEDELTA,
        NULL, NULL, NULL, NULL
    }
};

/*
 * FIXME: check for PY3K
 */
NpyArray_Descr USHORT_Descr = {
    _NpyObject_HEAD_INIT(&NpyArrayDescr_Type)
    NPY_VALID_MAGIC,
    NpyArray_UNSIGNEDLTR,
    NpyArray_USHORTLTR,
    '=',
    0,
    0,
    NpyArray_USHORT,
    1*sizeof(ushort),
    _ALIGN(ushort),
    NULL,
    NULL,
    NULL,
    &_NpyUShort_ArrFuncs,
    NULL,
};


static NpyArray_ArrFuncs _NpyInt_ArrFuncs = {
    NULL, NULL,
    (NpyArray_CopySwapNFunc*)INT_copyswapn,
    (NpyArray_CopySwapFunc*)INT_copyswap,
    (NpyArray_CompareFunc*)INT_compare,
    (NpyArray_ArgFunc*)INT_argmax,
    (NpyArray_DotFunc*)INT_dot,
    (NpyArray_ScanFunc*)INT_scan,
    (NpyArray_FromStrFunc*)INT_fromstr,
    (NpyArray_NonzeroFunc*)INT_nonzero,
    (NpyArray_FillFunc*)INT_fill,
    (NpyArray_FillWithScalarFunc*)INT_fillwithscalar,
    {
        NULL, NULL, NULL
    },
    {
        NULL, NULL, NULL
    },
    NULL,
    (NpyArray_ScalarKindFunc*)NULL,
    NULL,
    NULL,
    (NpyArray_FastClipFunc*)INT_fastclip,
    (NpyArray_FastPutmaskFunc*)INT_fastputmask,
    (NpyArray_FastTakeFunc*)INT_fasttake,
    NULL, NULL, NULL, NULL,
    {
        (NpyArray_VectorUnaryFunc*)INT_to_BOOL,
        (NpyArray_VectorUnaryFunc*)INT_to_BYTE,
        (NpyArray_VectorUnaryFunc*)INT_to_UBYTE,
        (NpyArray_VectorUnaryFunc*)INT_to_SHORT,
        (NpyArray_VectorUnaryFunc*)INT_to_USHORT,
        (NpyArray_VectorUnaryFunc*)INT_to_INT,
        (NpyArray_VectorUnaryFunc*)INT_to_UINT,
        (NpyArray_VectorUnaryFunc*)INT_to_LONG,
        (NpyArray_VectorUnaryFunc*)INT_to_ULONG,
        (NpyArray_VectorUnaryFunc*)INT_to_LONGLONG,
        (NpyArray_VectorUnaryFunc*)INT_to_ULONGLONG,
        (NpyArray_VectorUnaryFunc*)INT_to_FLOAT,
        (NpyArray_VectorUnaryFunc*)INT_to_DOUBLE,
        (NpyArray_VectorUnaryFunc*)INT_to_LONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)INT_to_CFLOAT,
        (NpyArray_VectorUnaryFunc*)INT_to_CDOUBLE,
        (NpyArray_VectorUnaryFunc*)INT_to_CLONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)INT_to_DATETIME,
        (NpyArray_VectorUnaryFunc*)INT_to_TIMEDELTA,
        NULL, NULL, NULL, NULL
    }
};

/*
 * FIXME: check for PY3K
 */
NpyArray_Descr INT_Descr = {
    _NpyObject_HEAD_INIT(&NpyArrayDescr_Type)
    NPY_VALID_MAGIC,
    NpyArray_SIGNEDLTR,
    NpyArray_INTLTR,
    '=',
    0,
    0,
    NpyArray_INT,
    1*sizeof(int),
    _ALIGN(int),
    NULL,
    NULL,
    NULL,
    &_NpyInt_ArrFuncs,
    NULL,
};


static NpyArray_ArrFuncs _NpyUInt_ArrFuncs = {
    NULL, NULL,
    (NpyArray_CopySwapNFunc*)UINT_copyswapn,
    (NpyArray_CopySwapFunc*)UINT_copyswap,
    (NpyArray_CompareFunc*)UINT_compare,
    (NpyArray_ArgFunc*)UINT_argmax,
    (NpyArray_DotFunc*)UINT_dot,
    (NpyArray_ScanFunc*)UINT_scan,
    (NpyArray_FromStrFunc*)UINT_fromstr,
    (NpyArray_NonzeroFunc*)UINT_nonzero,
    (NpyArray_FillFunc*)UINT_fill,
    (NpyArray_FillWithScalarFunc*)UINT_fillwithscalar,
    {
        NULL, NULL, NULL
    },
    {
        NULL, NULL, NULL
    },
    NULL,
    (NpyArray_ScalarKindFunc*)NULL,
    NULL,
    NULL,
    (NpyArray_FastClipFunc*)UINT_fastclip,
    (NpyArray_FastPutmaskFunc*)UINT_fastputmask,
    (NpyArray_FastTakeFunc*)UINT_fasttake,
    NULL, NULL, NULL, NULL,
    {
        (NpyArray_VectorUnaryFunc*)UINT_to_BOOL,
        (NpyArray_VectorUnaryFunc*)UINT_to_BYTE,
        (NpyArray_VectorUnaryFunc*)UINT_to_UBYTE,
        (NpyArray_VectorUnaryFunc*)UINT_to_SHORT,
        (NpyArray_VectorUnaryFunc*)UINT_to_USHORT,
        (NpyArray_VectorUnaryFunc*)UINT_to_INT,
        (NpyArray_VectorUnaryFunc*)UINT_to_UINT,
        (NpyArray_VectorUnaryFunc*)UINT_to_LONG,
        (NpyArray_VectorUnaryFunc*)UINT_to_ULONG,
        (NpyArray_VectorUnaryFunc*)UINT_to_LONGLONG,
        (NpyArray_VectorUnaryFunc*)UINT_to_ULONGLONG,
        (NpyArray_VectorUnaryFunc*)UINT_to_FLOAT,
        (NpyArray_VectorUnaryFunc*)UINT_to_DOUBLE,
        (NpyArray_VectorUnaryFunc*)UINT_to_LONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)UINT_to_CFLOAT,
        (NpyArray_VectorUnaryFunc*)UINT_to_CDOUBLE,
        (NpyArray_VectorUnaryFunc*)UINT_to_CLONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)UINT_to_DATETIME,
        (NpyArray_VectorUnaryFunc*)UINT_to_TIMEDELTA,
        NULL, NULL, NULL, NULL
    }
};

/*
 * FIXME: check for PY3K
 */
NpyArray_Descr UINT_Descr = {
    _NpyObject_HEAD_INIT(&NpyArrayDescr_Type)
    NPY_VALID_MAGIC,
    NpyArray_UNSIGNEDLTR,
    NpyArray_UINTLTR,
    '=',
    0,
    0,
    NpyArray_UINT,
    1*sizeof(uint),
    _ALIGN(uint),
    NULL,
    NULL,
    NULL,
    &_NpyUInt_ArrFuncs,
    NULL,
};


static NpyArray_ArrFuncs _NpyLong_ArrFuncs = {
    NULL, NULL,
    (NpyArray_CopySwapNFunc*)LONG_copyswapn,
    (NpyArray_CopySwapFunc*)LONG_copyswap,
    (NpyArray_CompareFunc*)LONG_compare,
    (NpyArray_ArgFunc*)LONG_argmax,
    (NpyArray_DotFunc*)LONG_dot,
    (NpyArray_ScanFunc*)LONG_scan,
    (NpyArray_FromStrFunc*)LONG_fromstr,
    (NpyArray_NonzeroFunc*)LONG_nonzero,
    (NpyArray_FillFunc*)LONG_fill,
    (NpyArray_FillWithScalarFunc*)LONG_fillwithscalar,
    {
        NULL, NULL, NULL
    },
    {
        NULL, NULL, NULL
    },
    NULL,
    (NpyArray_ScalarKindFunc*)NULL,
    NULL,
    NULL,
    (NpyArray_FastClipFunc*)LONG_fastclip,
    (NpyArray_FastPutmaskFunc*)LONG_fastputmask,
    (NpyArray_FastTakeFunc*)LONG_fasttake,
    NULL, NULL, NULL, NULL,
    {
        (NpyArray_VectorUnaryFunc*)LONG_to_BOOL,
        (NpyArray_VectorUnaryFunc*)LONG_to_BYTE,
        (NpyArray_VectorUnaryFunc*)LONG_to_UBYTE,
        (NpyArray_VectorUnaryFunc*)LONG_to_SHORT,
        (NpyArray_VectorUnaryFunc*)LONG_to_USHORT,
        (NpyArray_VectorUnaryFunc*)LONG_to_INT,
        (NpyArray_VectorUnaryFunc*)LONG_to_UINT,
        (NpyArray_VectorUnaryFunc*)LONG_to_LONG,
        (NpyArray_VectorUnaryFunc*)LONG_to_ULONG,
        (NpyArray_VectorUnaryFunc*)LONG_to_LONGLONG,
        (NpyArray_VectorUnaryFunc*)LONG_to_ULONGLONG,
        (NpyArray_VectorUnaryFunc*)LONG_to_FLOAT,
        (NpyArray_VectorUnaryFunc*)LONG_to_DOUBLE,
        (NpyArray_VectorUnaryFunc*)LONG_to_LONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)LONG_to_CFLOAT,
        (NpyArray_VectorUnaryFunc*)LONG_to_CDOUBLE,
        (NpyArray_VectorUnaryFunc*)LONG_to_CLONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)LONG_to_DATETIME,
        (NpyArray_VectorUnaryFunc*)LONG_to_TIMEDELTA,
        NULL, NULL, NULL, NULL
    }
};

/*
 * FIXME: check for PY3K
 */
NpyArray_Descr LONG_Descr = {
    _NpyObject_HEAD_INIT(&NpyArrayDescr_Type)
    NPY_VALID_MAGIC,
    NpyArray_SIGNEDLTR,
    NpyArray_LONGLTR,
    '=',
    0,
    0,
    NpyArray_LONG,
    1*sizeof(long),
    _ALIGN(long),
    NULL,
    NULL,
    NULL,
    &_NpyLong_ArrFuncs,
    NULL,
};


static NpyArray_ArrFuncs _NpyULong_ArrFuncs = {
    NULL, NULL,
    (NpyArray_CopySwapNFunc*)ULONG_copyswapn,
    (NpyArray_CopySwapFunc*)ULONG_copyswap,
    (NpyArray_CompareFunc*)ULONG_compare,
    (NpyArray_ArgFunc*)ULONG_argmax,
    (NpyArray_DotFunc*)ULONG_dot,
    (NpyArray_ScanFunc*)ULONG_scan,
    (NpyArray_FromStrFunc*)ULONG_fromstr,
    (NpyArray_NonzeroFunc*)ULONG_nonzero,
    (NpyArray_FillFunc*)ULONG_fill,
    (NpyArray_FillWithScalarFunc*)ULONG_fillwithscalar,
    {
        NULL, NULL, NULL
    },
    {
        NULL, NULL, NULL
    },
    NULL,
    (NpyArray_ScalarKindFunc*)NULL,
    NULL,
    NULL,
    (NpyArray_FastClipFunc*)ULONG_fastclip,
    (NpyArray_FastPutmaskFunc*)ULONG_fastputmask,
    (NpyArray_FastTakeFunc*)ULONG_fasttake,
    NULL, NULL, NULL, NULL,
    {
        (NpyArray_VectorUnaryFunc*)ULONG_to_BOOL,
        (NpyArray_VectorUnaryFunc*)ULONG_to_BYTE,
        (NpyArray_VectorUnaryFunc*)ULONG_to_UBYTE,
        (NpyArray_VectorUnaryFunc*)ULONG_to_SHORT,
        (NpyArray_VectorUnaryFunc*)ULONG_to_USHORT,
        (NpyArray_VectorUnaryFunc*)ULONG_to_INT,
        (NpyArray_VectorUnaryFunc*)ULONG_to_UINT,
        (NpyArray_VectorUnaryFunc*)ULONG_to_LONG,
        (NpyArray_VectorUnaryFunc*)ULONG_to_ULONG,
        (NpyArray_VectorUnaryFunc*)ULONG_to_LONGLONG,
        (NpyArray_VectorUnaryFunc*)ULONG_to_ULONGLONG,
        (NpyArray_VectorUnaryFunc*)ULONG_to_FLOAT,
        (NpyArray_VectorUnaryFunc*)ULONG_to_DOUBLE,
        (NpyArray_VectorUnaryFunc*)ULONG_to_LONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)ULONG_to_CFLOAT,
        (NpyArray_VectorUnaryFunc*)ULONG_to_CDOUBLE,
        (NpyArray_VectorUnaryFunc*)ULONG_to_CLONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)ULONG_to_DATETIME,
        (NpyArray_VectorUnaryFunc*)ULONG_to_TIMEDELTA,
        NULL, NULL, NULL, NULL
    }
};

/*
 * FIXME: check for PY3K
 */
NpyArray_Descr ULONG_Descr = {
    _NpyObject_HEAD_INIT(&NpyArrayDescr_Type)
    NPY_VALID_MAGIC,
    NpyArray_UNSIGNEDLTR,
    NpyArray_ULONGLTR,
    '=',
    0,
    0,
    NpyArray_ULONG,
    1*sizeof(ulong),
    _ALIGN(ulong),
    NULL,
    NULL,
    NULL,
    &_NpyULong_ArrFuncs,
    NULL,
};


static NpyArray_ArrFuncs _NpyLongLong_ArrFuncs = {
    NULL, NULL,
    (NpyArray_CopySwapNFunc*)LONGLONG_copyswapn,
    (NpyArray_CopySwapFunc*)LONGLONG_copyswap,
    (NpyArray_CompareFunc*)LONGLONG_compare,
    (NpyArray_ArgFunc*)LONGLONG_argmax,
    (NpyArray_DotFunc*)LONGLONG_dot,
    (NpyArray_ScanFunc*)LONGLONG_scan,
    (NpyArray_FromStrFunc*)LONGLONG_fromstr,
    (NpyArray_NonzeroFunc*)LONGLONG_nonzero,
    (NpyArray_FillFunc*)LONGLONG_fill,
    (NpyArray_FillWithScalarFunc*)LONGLONG_fillwithscalar,
    {
        NULL, NULL, NULL
    },
    {
        NULL, NULL, NULL
    },
    NULL,
    (NpyArray_ScalarKindFunc*)NULL,
    NULL,
    NULL,
    (NpyArray_FastClipFunc*)LONGLONG_fastclip,
    (NpyArray_FastPutmaskFunc*)LONGLONG_fastputmask,
    (NpyArray_FastTakeFunc*)LONGLONG_fasttake,
    NULL, NULL, NULL, NULL,
    {
        (NpyArray_VectorUnaryFunc*)LONGLONG_to_BOOL,
        (NpyArray_VectorUnaryFunc*)LONGLONG_to_BYTE,
        (NpyArray_VectorUnaryFunc*)LONGLONG_to_UBYTE,
        (NpyArray_VectorUnaryFunc*)LONGLONG_to_SHORT,
        (NpyArray_VectorUnaryFunc*)LONGLONG_to_USHORT,
        (NpyArray_VectorUnaryFunc*)LONGLONG_to_INT,
        (NpyArray_VectorUnaryFunc*)LONGLONG_to_UINT,
        (NpyArray_VectorUnaryFunc*)LONGLONG_to_LONG,
        (NpyArray_VectorUnaryFunc*)LONGLONG_to_ULONG,
        (NpyArray_VectorUnaryFunc*)LONGLONG_to_LONGLONG,
        (NpyArray_VectorUnaryFunc*)LONGLONG_to_ULONGLONG,
        (NpyArray_VectorUnaryFunc*)LONGLONG_to_FLOAT,
        (NpyArray_VectorUnaryFunc*)LONGLONG_to_DOUBLE,
        (NpyArray_VectorUnaryFunc*)LONGLONG_to_LONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)LONGLONG_to_CFLOAT,
        (NpyArray_VectorUnaryFunc*)LONGLONG_to_CDOUBLE,
        (NpyArray_VectorUnaryFunc*)LONGLONG_to_CLONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)LONGLONG_to_DATETIME,
        (NpyArray_VectorUnaryFunc*)LONGLONG_to_TIMEDELTA,
        NULL, NULL, NULL, NULL
    }
};

/*
 * FIXME: check for PY3K
 */
NpyArray_Descr LONGLONG_Descr = {
    _NpyObject_HEAD_INIT(&NpyArrayDescr_Type)
    NPY_VALID_MAGIC,
    NpyArray_SIGNEDLTR,
    NpyArray_LONGLONGLTR,
    '=',
    0,
    0,
    NpyArray_LONGLONG,
    1*sizeof(longlong),
    _ALIGN(longlong),
    NULL,
    NULL,
    NULL,
    &_NpyLongLong_ArrFuncs,
    NULL,
};


static NpyArray_ArrFuncs _NpyULongLong_ArrFuncs = {
    NULL, NULL,
    (NpyArray_CopySwapNFunc*)ULONGLONG_copyswapn,
    (NpyArray_CopySwapFunc*)ULONGLONG_copyswap,
    (NpyArray_CompareFunc*)ULONGLONG_compare,
    (NpyArray_ArgFunc*)ULONGLONG_argmax,
    (NpyArray_DotFunc*)ULONGLONG_dot,
    (NpyArray_ScanFunc*)ULONGLONG_scan,
    (NpyArray_FromStrFunc*)ULONGLONG_fromstr,
    (NpyArray_NonzeroFunc*)ULONGLONG_nonzero,
    (NpyArray_FillFunc*)ULONGLONG_fill,
    (NpyArray_FillWithScalarFunc*)ULONGLONG_fillwithscalar,
    {
        NULL, NULL, NULL
    },
    {
        NULL, NULL, NULL
    },
    NULL,
    (NpyArray_ScalarKindFunc*)NULL,
    NULL,
    NULL,
    (NpyArray_FastClipFunc*)ULONGLONG_fastclip,
    (NpyArray_FastPutmaskFunc*)ULONGLONG_fastputmask,
    (NpyArray_FastTakeFunc*)ULONGLONG_fasttake,
    NULL, NULL, NULL, NULL,
    {
        (NpyArray_VectorUnaryFunc*)ULONGLONG_to_BOOL,
        (NpyArray_VectorUnaryFunc*)ULONGLONG_to_BYTE,
        (NpyArray_VectorUnaryFunc*)ULONGLONG_to_UBYTE,
        (NpyArray_VectorUnaryFunc*)ULONGLONG_to_SHORT,
        (NpyArray_VectorUnaryFunc*)ULONGLONG_to_USHORT,
        (NpyArray_VectorUnaryFunc*)ULONGLONG_to_INT,
        (NpyArray_VectorUnaryFunc*)ULONGLONG_to_UINT,
        (NpyArray_VectorUnaryFunc*)ULONGLONG_to_LONG,
        (NpyArray_VectorUnaryFunc*)ULONGLONG_to_ULONG,
        (NpyArray_VectorUnaryFunc*)ULONGLONG_to_LONGLONG,
        (NpyArray_VectorUnaryFunc*)ULONGLONG_to_ULONGLONG,
        (NpyArray_VectorUnaryFunc*)ULONGLONG_to_FLOAT,
        (NpyArray_VectorUnaryFunc*)ULONGLONG_to_DOUBLE,
        (NpyArray_VectorUnaryFunc*)ULONGLONG_to_LONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)ULONGLONG_to_CFLOAT,
        (NpyArray_VectorUnaryFunc*)ULONGLONG_to_CDOUBLE,
        (NpyArray_VectorUnaryFunc*)ULONGLONG_to_CLONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)ULONGLONG_to_DATETIME,
        (NpyArray_VectorUnaryFunc*)ULONGLONG_to_TIMEDELTA,
        NULL, NULL, NULL, NULL
    }
};

/*
 * FIXME: check for PY3K
 */
NpyArray_Descr ULONGLONG_Descr = {
    _NpyObject_HEAD_INIT(&NpyArrayDescr_Type)
    NPY_VALID_MAGIC,
    NpyArray_UNSIGNEDLTR,
    NpyArray_ULONGLONGLTR,
    '=',
    0,
    0,
    NpyArray_ULONGLONG,
    1*sizeof(ulonglong),
    _ALIGN(ulonglong),
    NULL,
    NULL,
    NULL,
    &_NpyULongLong_ArrFuncs,
    NULL,
};


static NpyArray_ArrFuncs _NpyFloat_ArrFuncs = {
    NULL, NULL,
    (NpyArray_CopySwapNFunc*)FLOAT_copyswapn,
    (NpyArray_CopySwapFunc*)FLOAT_copyswap,
    (NpyArray_CompareFunc*)FLOAT_compare,
    (NpyArray_ArgFunc*)FLOAT_argmax,
    (NpyArray_DotFunc*)FLOAT_dot,
    (NpyArray_ScanFunc*)FLOAT_scan,
    (NpyArray_FromStrFunc*)FLOAT_fromstr,
    (NpyArray_NonzeroFunc*)FLOAT_nonzero,
    (NpyArray_FillFunc*)FLOAT_fill,
    (NpyArray_FillWithScalarFunc*)FLOAT_fillwithscalar,
    {
        NULL, NULL, NULL
    },
    {
        NULL, NULL, NULL
    },
    NULL,
    (NpyArray_ScalarKindFunc*)NULL,
    NULL,
    NULL,
    (NpyArray_FastClipFunc*)FLOAT_fastclip,
    (NpyArray_FastPutmaskFunc*)FLOAT_fastputmask,
    (NpyArray_FastTakeFunc*)FLOAT_fasttake,
    NULL, NULL, NULL, NULL,
    {
        (NpyArray_VectorUnaryFunc*)FLOAT_to_BOOL,
        (NpyArray_VectorUnaryFunc*)FLOAT_to_BYTE,
        (NpyArray_VectorUnaryFunc*)FLOAT_to_UBYTE,
        (NpyArray_VectorUnaryFunc*)FLOAT_to_SHORT,
        (NpyArray_VectorUnaryFunc*)FLOAT_to_USHORT,
        (NpyArray_VectorUnaryFunc*)FLOAT_to_INT,
        (NpyArray_VectorUnaryFunc*)FLOAT_to_UINT,
        (NpyArray_VectorUnaryFunc*)FLOAT_to_LONG,
        (NpyArray_VectorUnaryFunc*)FLOAT_to_ULONG,
        (NpyArray_VectorUnaryFunc*)FLOAT_to_LONGLONG,
        (NpyArray_VectorUnaryFunc*)FLOAT_to_ULONGLONG,
        (NpyArray_VectorUnaryFunc*)FLOAT_to_FLOAT,
        (NpyArray_VectorUnaryFunc*)FLOAT_to_DOUBLE,
        (NpyArray_VectorUnaryFunc*)FLOAT_to_LONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)FLOAT_to_CFLOAT,
        (NpyArray_VectorUnaryFunc*)FLOAT_to_CDOUBLE,
        (NpyArray_VectorUnaryFunc*)FLOAT_to_CLONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)FLOAT_to_DATETIME,
        (NpyArray_VectorUnaryFunc*)FLOAT_to_TIMEDELTA,
        NULL, NULL, NULL, NULL
    }
};

/*
 * FIXME: check for PY3K
 */
NpyArray_Descr FLOAT_Descr = {
    _NpyObject_HEAD_INIT(&NpyArrayDescr_Type)
    NPY_VALID_MAGIC,
    NpyArray_FLOATINGLTR,
    NpyArray_FLOATLTR,
    '=',
    0,
    0,
    NpyArray_FLOAT,
    1*sizeof(float),
    _ALIGN(float),
    NULL,
    NULL,
    NULL,
    &_NpyFloat_ArrFuncs,
    NULL,
};


static NpyArray_ArrFuncs _NpyDouble_ArrFuncs = {
    NULL, NULL,
    (NpyArray_CopySwapNFunc*)DOUBLE_copyswapn,
    (NpyArray_CopySwapFunc*)DOUBLE_copyswap,
    (NpyArray_CompareFunc*)DOUBLE_compare,
    (NpyArray_ArgFunc*)DOUBLE_argmax,
    (NpyArray_DotFunc*)DOUBLE_dot,
    (NpyArray_ScanFunc*)DOUBLE_scan,
    (NpyArray_FromStrFunc*)DOUBLE_fromstr,
    (NpyArray_NonzeroFunc*)DOUBLE_nonzero,
    (NpyArray_FillFunc*)DOUBLE_fill,
    (NpyArray_FillWithScalarFunc*)DOUBLE_fillwithscalar,
    {
        NULL, NULL, NULL
    },
    {
        NULL, NULL, NULL
    },
    NULL,
    (NpyArray_ScalarKindFunc*)NULL,
    NULL,
    NULL,
    (NpyArray_FastClipFunc*)DOUBLE_fastclip,
    (NpyArray_FastPutmaskFunc*)DOUBLE_fastputmask,
    (NpyArray_FastTakeFunc*)DOUBLE_fasttake,
    NULL, NULL, NULL, NULL,
    {
        (NpyArray_VectorUnaryFunc*)DOUBLE_to_BOOL,
        (NpyArray_VectorUnaryFunc*)DOUBLE_to_BYTE,
        (NpyArray_VectorUnaryFunc*)DOUBLE_to_UBYTE,
        (NpyArray_VectorUnaryFunc*)DOUBLE_to_SHORT,
        (NpyArray_VectorUnaryFunc*)DOUBLE_to_USHORT,
        (NpyArray_VectorUnaryFunc*)DOUBLE_to_INT,
        (NpyArray_VectorUnaryFunc*)DOUBLE_to_UINT,
        (NpyArray_VectorUnaryFunc*)DOUBLE_to_LONG,
        (NpyArray_VectorUnaryFunc*)DOUBLE_to_ULONG,
        (NpyArray_VectorUnaryFunc*)DOUBLE_to_LONGLONG,
        (NpyArray_VectorUnaryFunc*)DOUBLE_to_ULONGLONG,
        (NpyArray_VectorUnaryFunc*)DOUBLE_to_FLOAT,
        (NpyArray_VectorUnaryFunc*)DOUBLE_to_DOUBLE,
        (NpyArray_VectorUnaryFunc*)DOUBLE_to_LONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)DOUBLE_to_CFLOAT,
        (NpyArray_VectorUnaryFunc*)DOUBLE_to_CDOUBLE,
        (NpyArray_VectorUnaryFunc*)DOUBLE_to_CLONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)DOUBLE_to_DATETIME,
        (NpyArray_VectorUnaryFunc*)DOUBLE_to_TIMEDELTA,
        NULL, NULL, NULL, NULL
    }
};

/*
 * FIXME: check for PY3K
 */
NpyArray_Descr DOUBLE_Descr = {
    _NpyObject_HEAD_INIT(&NpyArrayDescr_Type)
    NPY_VALID_MAGIC,
    NpyArray_FLOATINGLTR,
    NpyArray_DOUBLELTR,
    '=',
    0,
    0,
    NpyArray_DOUBLE,
    1*sizeof(double),
    _ALIGN(double),
    NULL,
    NULL,
    NULL,
    &_NpyDouble_ArrFuncs,
    NULL,
};


static NpyArray_ArrFuncs _NpyLongDouble_ArrFuncs = {
    NULL, NULL,
    (NpyArray_CopySwapNFunc*)LONGDOUBLE_copyswapn,
    (NpyArray_CopySwapFunc*)LONGDOUBLE_copyswap,
    (NpyArray_CompareFunc*)LONGDOUBLE_compare,
    (NpyArray_ArgFunc*)LONGDOUBLE_argmax,
    (NpyArray_DotFunc*)LONGDOUBLE_dot,
    (NpyArray_ScanFunc*)LONGDOUBLE_scan,
    (NpyArray_FromStrFunc*)LONGDOUBLE_fromstr,
    (NpyArray_NonzeroFunc*)LONGDOUBLE_nonzero,
    (NpyArray_FillFunc*)LONGDOUBLE_fill,
    (NpyArray_FillWithScalarFunc*)LONGDOUBLE_fillwithscalar,
    {
        NULL, NULL, NULL
    },
    {
        NULL, NULL, NULL
    },
    NULL,
    (NpyArray_ScalarKindFunc*)NULL,
    NULL,
    NULL,
    (NpyArray_FastClipFunc*)LONGDOUBLE_fastclip,
    (NpyArray_FastPutmaskFunc*)LONGDOUBLE_fastputmask,
    (NpyArray_FastTakeFunc*)LONGDOUBLE_fasttake,
    NULL, NULL, NULL, NULL,
    {
        (NpyArray_VectorUnaryFunc*)LONGDOUBLE_to_BOOL,
        (NpyArray_VectorUnaryFunc*)LONGDOUBLE_to_BYTE,
        (NpyArray_VectorUnaryFunc*)LONGDOUBLE_to_UBYTE,
        (NpyArray_VectorUnaryFunc*)LONGDOUBLE_to_SHORT,
        (NpyArray_VectorUnaryFunc*)LONGDOUBLE_to_USHORT,
        (NpyArray_VectorUnaryFunc*)LONGDOUBLE_to_INT,
        (NpyArray_VectorUnaryFunc*)LONGDOUBLE_to_UINT,
        (NpyArray_VectorUnaryFunc*)LONGDOUBLE_to_LONG,
        (NpyArray_VectorUnaryFunc*)LONGDOUBLE_to_ULONG,
        (NpyArray_VectorUnaryFunc*)LONGDOUBLE_to_LONGLONG,
        (NpyArray_VectorUnaryFunc*)LONGDOUBLE_to_ULONGLONG,
        (NpyArray_VectorUnaryFunc*)LONGDOUBLE_to_FLOAT,
        (NpyArray_VectorUnaryFunc*)LONGDOUBLE_to_DOUBLE,
        (NpyArray_VectorUnaryFunc*)LONGDOUBLE_to_LONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)LONGDOUBLE_to_CFLOAT,
        (NpyArray_VectorUnaryFunc*)LONGDOUBLE_to_CDOUBLE,
        (NpyArray_VectorUnaryFunc*)LONGDOUBLE_to_CLONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)LONGDOUBLE_to_DATETIME,
        (NpyArray_VectorUnaryFunc*)LONGDOUBLE_to_TIMEDELTA,
        NULL, NULL, NULL, NULL
    }
};

/*
 * FIXME: check for PY3K
 */
NpyArray_Descr LONGDOUBLE_Descr = {
    _NpyObject_HEAD_INIT(&NpyArrayDescr_Type)
    NPY_VALID_MAGIC,
    NpyArray_FLOATINGLTR,
    NpyArray_LONGDOUBLELTR,
    '=',
    0,
    0,
    NpyArray_LONGDOUBLE,
    1*sizeof(longdouble),
    _ALIGN(longdouble),
    NULL,
    NULL,
    NULL,
    &_NpyLongDouble_ArrFuncs,
    NULL,
};


static NpyArray_ArrFuncs _NpyCFloat_ArrFuncs = {
    NULL, NULL,
    (NpyArray_CopySwapNFunc*)CFLOAT_copyswapn,
    (NpyArray_CopySwapFunc*)CFLOAT_copyswap,
    (NpyArray_CompareFunc*)CFLOAT_compare,
    (NpyArray_ArgFunc*)CFLOAT_argmax,
    (NpyArray_DotFunc*)CFLOAT_dot,
    (NpyArray_ScanFunc*)CFLOAT_scan,
    (NpyArray_FromStrFunc*)CFLOAT_fromstr,
    (NpyArray_NonzeroFunc*)CFLOAT_nonzero,
    (NpyArray_FillFunc*)CFLOAT_fill,
    (NpyArray_FillWithScalarFunc*)CFLOAT_fillwithscalar,
    {
        NULL, NULL, NULL
    },
    {
        NULL, NULL, NULL
    },
    NULL,
    (NpyArray_ScalarKindFunc*)NULL,
    NULL,
    NULL,
    (NpyArray_FastClipFunc*)CFLOAT_fastclip,
    (NpyArray_FastPutmaskFunc*)CFLOAT_fastputmask,
    (NpyArray_FastTakeFunc*)CFLOAT_fasttake,
    NULL, NULL, NULL, NULL,
    {
        (NpyArray_VectorUnaryFunc*)CFLOAT_to_BOOL,
        (NpyArray_VectorUnaryFunc*)CFLOAT_to_BYTE,
        (NpyArray_VectorUnaryFunc*)CFLOAT_to_UBYTE,
        (NpyArray_VectorUnaryFunc*)CFLOAT_to_SHORT,
        (NpyArray_VectorUnaryFunc*)CFLOAT_to_USHORT,
        (NpyArray_VectorUnaryFunc*)CFLOAT_to_INT,
        (NpyArray_VectorUnaryFunc*)CFLOAT_to_UINT,
        (NpyArray_VectorUnaryFunc*)CFLOAT_to_LONG,
        (NpyArray_VectorUnaryFunc*)CFLOAT_to_ULONG,
        (NpyArray_VectorUnaryFunc*)CFLOAT_to_LONGLONG,
        (NpyArray_VectorUnaryFunc*)CFLOAT_to_ULONGLONG,
        (NpyArray_VectorUnaryFunc*)CFLOAT_to_FLOAT,
        (NpyArray_VectorUnaryFunc*)CFLOAT_to_DOUBLE,
        (NpyArray_VectorUnaryFunc*)CFLOAT_to_LONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)CFLOAT_to_CFLOAT,
        (NpyArray_VectorUnaryFunc*)CFLOAT_to_CDOUBLE,
        (NpyArray_VectorUnaryFunc*)CFLOAT_to_CLONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)CFLOAT_to_DATETIME,
        (NpyArray_VectorUnaryFunc*)CFLOAT_to_TIMEDELTA,
        NULL, NULL, NULL, NULL
    }
};

/*
 * FIXME: check for PY3K
 */
NpyArray_Descr CFLOAT_Descr = {
    _NpyObject_HEAD_INIT(&NpyArrayDescr_Type)
    NPY_VALID_MAGIC,
    NpyArray_COMPLEXLTR,
    NpyArray_CFLOATLTR,
    '=',
    0,
    0,
    NpyArray_CFLOAT,
    2*sizeof(float),
    _ALIGN(float),
    NULL,
    NULL,
    NULL,
    &_NpyCFloat_ArrFuncs,
    NULL,
};


static NpyArray_ArrFuncs _NpyCDouble_ArrFuncs = {
    NULL, NULL,
    (NpyArray_CopySwapNFunc*)CDOUBLE_copyswapn,
    (NpyArray_CopySwapFunc*)CDOUBLE_copyswap,
    (NpyArray_CompareFunc*)CDOUBLE_compare,
    (NpyArray_ArgFunc*)CDOUBLE_argmax,
    (NpyArray_DotFunc*)CDOUBLE_dot,
    (NpyArray_ScanFunc*)CDOUBLE_scan,
    (NpyArray_FromStrFunc*)CDOUBLE_fromstr,
    (NpyArray_NonzeroFunc*)CDOUBLE_nonzero,
    (NpyArray_FillFunc*)CDOUBLE_fill,
    (NpyArray_FillWithScalarFunc*)CDOUBLE_fillwithscalar,
    {
        NULL, NULL, NULL
    },
    {
        NULL, NULL, NULL
    },
    NULL,
    (NpyArray_ScalarKindFunc*)NULL,
    NULL,
    NULL,
    (NpyArray_FastClipFunc*)CDOUBLE_fastclip,
    (NpyArray_FastPutmaskFunc*)CDOUBLE_fastputmask,
    (NpyArray_FastTakeFunc*)CDOUBLE_fasttake,
    NULL, NULL, NULL, NULL,
    {
        (NpyArray_VectorUnaryFunc*)CDOUBLE_to_BOOL,
        (NpyArray_VectorUnaryFunc*)CDOUBLE_to_BYTE,
        (NpyArray_VectorUnaryFunc*)CDOUBLE_to_UBYTE,
        (NpyArray_VectorUnaryFunc*)CDOUBLE_to_SHORT,
        (NpyArray_VectorUnaryFunc*)CDOUBLE_to_USHORT,
        (NpyArray_VectorUnaryFunc*)CDOUBLE_to_INT,
        (NpyArray_VectorUnaryFunc*)CDOUBLE_to_UINT,
        (NpyArray_VectorUnaryFunc*)CDOUBLE_to_LONG,
        (NpyArray_VectorUnaryFunc*)CDOUBLE_to_ULONG,
        (NpyArray_VectorUnaryFunc*)CDOUBLE_to_LONGLONG,
        (NpyArray_VectorUnaryFunc*)CDOUBLE_to_ULONGLONG,
        (NpyArray_VectorUnaryFunc*)CDOUBLE_to_FLOAT,
        (NpyArray_VectorUnaryFunc*)CDOUBLE_to_DOUBLE,
        (NpyArray_VectorUnaryFunc*)CDOUBLE_to_LONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)CDOUBLE_to_CFLOAT,
        (NpyArray_VectorUnaryFunc*)CDOUBLE_to_CDOUBLE,
        (NpyArray_VectorUnaryFunc*)CDOUBLE_to_CLONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)CDOUBLE_to_DATETIME,
        (NpyArray_VectorUnaryFunc*)CDOUBLE_to_TIMEDELTA,
        NULL, NULL, NULL, NULL
    }
};

/*
 * FIXME: check for PY3K
 */
NpyArray_Descr CDOUBLE_Descr = {
    _NpyObject_HEAD_INIT(&NpyArrayDescr_Type)
    NPY_VALID_MAGIC,
    NpyArray_COMPLEXLTR,
    NpyArray_CDOUBLELTR,
    '=',
    0,
    0,
    NpyArray_CDOUBLE,
    2*sizeof(double),
    _ALIGN(double),
    NULL,
    NULL,
    NULL,
    &_NpyCDouble_ArrFuncs,
    NULL,
};


static NpyArray_ArrFuncs _NpyCLongDouble_ArrFuncs = {
    NULL, NULL,
    (NpyArray_CopySwapNFunc*)CLONGDOUBLE_copyswapn,
    (NpyArray_CopySwapFunc*)CLONGDOUBLE_copyswap,
    (NpyArray_CompareFunc*)CLONGDOUBLE_compare,
    (NpyArray_ArgFunc*)CLONGDOUBLE_argmax,
    (NpyArray_DotFunc*)CLONGDOUBLE_dot,
    (NpyArray_ScanFunc*)CLONGDOUBLE_scan,
    (NpyArray_FromStrFunc*)CLONGDOUBLE_fromstr,
    (NpyArray_NonzeroFunc*)CLONGDOUBLE_nonzero,
    (NpyArray_FillFunc*)CLONGDOUBLE_fill,
    (NpyArray_FillWithScalarFunc*)CLONGDOUBLE_fillwithscalar,
    {
        NULL, NULL, NULL
    },
    {
        NULL, NULL, NULL
    },
    NULL,
    (NpyArray_ScalarKindFunc*)NULL,
    NULL,
    NULL,
    (NpyArray_FastClipFunc*)CLONGDOUBLE_fastclip,
    (NpyArray_FastPutmaskFunc*)CLONGDOUBLE_fastputmask,
    (NpyArray_FastTakeFunc*)CLONGDOUBLE_fasttake,
    NULL, NULL, NULL, NULL,
    {
        (NpyArray_VectorUnaryFunc*)CLONGDOUBLE_to_BOOL,
        (NpyArray_VectorUnaryFunc*)CLONGDOUBLE_to_BYTE,
        (NpyArray_VectorUnaryFunc*)CLONGDOUBLE_to_UBYTE,
        (NpyArray_VectorUnaryFunc*)CLONGDOUBLE_to_SHORT,
        (NpyArray_VectorUnaryFunc*)CLONGDOUBLE_to_USHORT,
        (NpyArray_VectorUnaryFunc*)CLONGDOUBLE_to_INT,
        (NpyArray_VectorUnaryFunc*)CLONGDOUBLE_to_UINT,
        (NpyArray_VectorUnaryFunc*)CLONGDOUBLE_to_LONG,
        (NpyArray_VectorUnaryFunc*)CLONGDOUBLE_to_ULONG,
        (NpyArray_VectorUnaryFunc*)CLONGDOUBLE_to_LONGLONG,
        (NpyArray_VectorUnaryFunc*)CLONGDOUBLE_to_ULONGLONG,
        (NpyArray_VectorUnaryFunc*)CLONGDOUBLE_to_FLOAT,
        (NpyArray_VectorUnaryFunc*)CLONGDOUBLE_to_DOUBLE,
        (NpyArray_VectorUnaryFunc*)CLONGDOUBLE_to_LONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)CLONGDOUBLE_to_CFLOAT,
        (NpyArray_VectorUnaryFunc*)CLONGDOUBLE_to_CDOUBLE,
        (NpyArray_VectorUnaryFunc*)CLONGDOUBLE_to_CLONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)CLONGDOUBLE_to_DATETIME,
        (NpyArray_VectorUnaryFunc*)CLONGDOUBLE_to_TIMEDELTA,
        NULL, NULL, NULL, NULL
    }
};

/*
 * FIXME: check for PY3K
 */
NpyArray_Descr CLONGDOUBLE_Descr = {
    _NpyObject_HEAD_INIT(&NpyArrayDescr_Type)
    NPY_VALID_MAGIC,
    NpyArray_COMPLEXLTR,
    NpyArray_CLONGDOUBLELTR,
    '=',
    0,
    0,
    NpyArray_CLONGDOUBLE,
    2*sizeof(longdouble),
    _ALIGN(longdouble),
    NULL,
    NULL,
    NULL,
    &_NpyCLongDouble_ArrFuncs,
    NULL,
};


static NpyArray_ArrFuncs _NpyDatetime_ArrFuncs = {
    NULL, NULL,
    (NpyArray_CopySwapNFunc*)DATETIME_copyswapn,
    (NpyArray_CopySwapFunc*)DATETIME_copyswap,
    (NpyArray_CompareFunc*)DATETIME_compare,
    (NpyArray_ArgFunc*)DATETIME_argmax,
    (NpyArray_DotFunc*)DATETIME_dot,
    (NpyArray_ScanFunc*)DATETIME_scan,
    (NpyArray_FromStrFunc*)DATETIME_fromstr,
    (NpyArray_NonzeroFunc*)DATETIME_nonzero,
    (NpyArray_FillFunc*)DATETIME_fill,
    (NpyArray_FillWithScalarFunc*)DATETIME_fillwithscalar,
    {
        NULL, NULL, NULL
    },
    {
        NULL, NULL, NULL
    },
    NULL,
    (NpyArray_ScalarKindFunc*)NULL,
    NULL,
    NULL,
    (NpyArray_FastClipFunc*)DATETIME_fastclip,
    (NpyArray_FastPutmaskFunc*)DATETIME_fastputmask,
    (NpyArray_FastTakeFunc*)DATETIME_fasttake,
    NULL, NULL, NULL, NULL,
    {
        (NpyArray_VectorUnaryFunc*)DATETIME_to_BOOL,
        (NpyArray_VectorUnaryFunc*)DATETIME_to_BYTE,
        (NpyArray_VectorUnaryFunc*)DATETIME_to_UBYTE,
        (NpyArray_VectorUnaryFunc*)DATETIME_to_SHORT,
        (NpyArray_VectorUnaryFunc*)DATETIME_to_USHORT,
        (NpyArray_VectorUnaryFunc*)DATETIME_to_INT,
        (NpyArray_VectorUnaryFunc*)DATETIME_to_UINT,
        (NpyArray_VectorUnaryFunc*)DATETIME_to_LONG,
        (NpyArray_VectorUnaryFunc*)DATETIME_to_ULONG,
        (NpyArray_VectorUnaryFunc*)DATETIME_to_LONGLONG,
        (NpyArray_VectorUnaryFunc*)DATETIME_to_ULONGLONG,
        (NpyArray_VectorUnaryFunc*)DATETIME_to_FLOAT,
        (NpyArray_VectorUnaryFunc*)DATETIME_to_DOUBLE,
        (NpyArray_VectorUnaryFunc*)DATETIME_to_LONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)DATETIME_to_CFLOAT,
        (NpyArray_VectorUnaryFunc*)DATETIME_to_CDOUBLE,
        (NpyArray_VectorUnaryFunc*)DATETIME_to_CLONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)DATETIME_to_DATETIME,
        (NpyArray_VectorUnaryFunc*)DATETIME_to_TIMEDELTA,
        NULL, NULL, NULL, NULL
    }
};

/*
 * FIXME: check for PY3K
 */
NpyArray_Descr DATETIME_Descr = {
    _NpyObject_HEAD_INIT(&NpyArrayDescr_Type)
    NPY_VALID_MAGIC,
    NpyArray_DATETIMELTR,
    NpyArray_DATETIMELTR,
    '=',
    0,
    0,
    NpyArray_DATETIME,
    1*sizeof(datetime),
    _ALIGN(datetime),
    NULL,
    NULL,
    NULL,
    &_NpyDatetime_ArrFuncs,
    NULL,
};


static NpyArray_ArrFuncs _NpyTimedelta_ArrFuncs = {
    NULL, NULL,
    (NpyArray_CopySwapNFunc*)TIMEDELTA_copyswapn,
    (NpyArray_CopySwapFunc*)TIMEDELTA_copyswap,
    (NpyArray_CompareFunc*)TIMEDELTA_compare,
    (NpyArray_ArgFunc*)TIMEDELTA_argmax,
    (NpyArray_DotFunc*)TIMEDELTA_dot,
    (NpyArray_ScanFunc*)TIMEDELTA_scan,
    (NpyArray_FromStrFunc*)TIMEDELTA_fromstr,
    (NpyArray_NonzeroFunc*)TIMEDELTA_nonzero,
    (NpyArray_FillFunc*)TIMEDELTA_fill,
    (NpyArray_FillWithScalarFunc*)TIMEDELTA_fillwithscalar,
    {
        NULL, NULL, NULL
    },
    {
        NULL, NULL, NULL
    },
    NULL,
    (NpyArray_ScalarKindFunc*)NULL,
    NULL,
    NULL,
    (NpyArray_FastClipFunc*)TIMEDELTA_fastclip,
    (NpyArray_FastPutmaskFunc*)TIMEDELTA_fastputmask,
    (NpyArray_FastTakeFunc*)TIMEDELTA_fasttake,
    NULL, NULL, NULL, NULL,
    {
        (NpyArray_VectorUnaryFunc*)TIMEDELTA_to_BOOL,
        (NpyArray_VectorUnaryFunc*)TIMEDELTA_to_BYTE,
        (NpyArray_VectorUnaryFunc*)TIMEDELTA_to_UBYTE,
        (NpyArray_VectorUnaryFunc*)TIMEDELTA_to_SHORT,
        (NpyArray_VectorUnaryFunc*)TIMEDELTA_to_USHORT,
        (NpyArray_VectorUnaryFunc*)TIMEDELTA_to_INT,
        (NpyArray_VectorUnaryFunc*)TIMEDELTA_to_UINT,
        (NpyArray_VectorUnaryFunc*)TIMEDELTA_to_LONG,
        (NpyArray_VectorUnaryFunc*)TIMEDELTA_to_ULONG,
        (NpyArray_VectorUnaryFunc*)TIMEDELTA_to_LONGLONG,
        (NpyArray_VectorUnaryFunc*)TIMEDELTA_to_ULONGLONG,
        (NpyArray_VectorUnaryFunc*)TIMEDELTA_to_FLOAT,
        (NpyArray_VectorUnaryFunc*)TIMEDELTA_to_DOUBLE,
        (NpyArray_VectorUnaryFunc*)TIMEDELTA_to_LONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)TIMEDELTA_to_CFLOAT,
        (NpyArray_VectorUnaryFunc*)TIMEDELTA_to_CDOUBLE,
        (NpyArray_VectorUnaryFunc*)TIMEDELTA_to_CLONGDOUBLE,
        (NpyArray_VectorUnaryFunc*)TIMEDELTA_to_DATETIME,
        (NpyArray_VectorUnaryFunc*)TIMEDELTA_to_TIMEDELTA,
        NULL, NULL, NULL, NULL
    }
};

/*
 * FIXME: check for PY3K
 */
NpyArray_Descr TIMEDELTA_Descr = {
    _NpyObject_HEAD_INIT(&NpyArrayDescr_Type)
    NPY_VALID_MAGIC,
    NpyArray_TIMEDELTALTR,
    NpyArray_TIMEDELTALTR,
    '=',
    0,
    0,
    NpyArray_TIMEDELTA,
    1*sizeof(timedelta),
    _ALIGN(timedelta),
    NULL,
    NULL,
    NULL,
    &_NpyTimedelta_ArrFuncs,
    NULL,
};



static NpyArray_ArrFuncs _NpyObject_ArrFuncs = {
    NULL, NULL, NULL, NULL, NULL,
    NULL, NULL, NULL, NULL, NULL,
    NULL, NULL,
    {
        NULL, NULL, NULL
    },
    {
        NULL, NULL, NULL
    },
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL, NULL, NULL, NULL,
    {
        NULL, NULL, NULL, NULL, NULL,
        NULL, NULL, NULL, NULL, NULL,
        NULL, NULL, NULL, NULL, NULL,
        NULL, NULL, NULL, NULL, NULL,
        NULL, NULL, NULL
    }
};

NpyArray_Descr OBJECT_Descr = {
    _NpyObject_HEAD_INIT(&NpyArrayDescr_Type)
    NPY_VALID_MAGIC,
    NpyArray_OBJECTLTR,
    NpyArray_OBJECTLTR,
    '|',
    0,
    NPY_OBJECT_DTYPE_FLAGS,
    NpyArray_OBJECT,
    sizeof(void *),
    _ALIGN(void *),
    NULL,
    NULL,
    NULL,
    &_NpyObject_ArrFuncs,
    NULL,
};




static void
_init_datetime_descr(NpyArray_Descr *descr)
{
    NpyArray_DateTimeInfo *dt_data;

    dt_data = NpyArray_malloc(sizeof(NpyArray_DateTimeInfo));
    dt_data->base = NPY_FR_us;
    dt_data->num = 1;
    dt_data->den = 1;
    dt_data->events = 1;

    /* FIXME
     * There is no error check here and no way to indicate an error
     * until the metadata turns up NULL.
     */
    descr->dtinfo = dt_data;
}




#define _MAX_LETTER 128
char _npy_letter_to_num[_MAX_LETTER];

static NpyArray_Descr *_builtin_descrs[] = {
    &BOOL_Descr,
    &BYTE_Descr,
    &UBYTE_Descr,
    &SHORT_Descr,
    &USHORT_Descr,
    &INT_Descr,
    &UINT_Descr,
    &LONG_Descr,
    &ULONG_Descr,
    &LONGLONG_Descr,
    &ULONGLONG_Descr,
    &FLOAT_Descr,
    &DOUBLE_Descr,
    &LONGDOUBLE_Descr,
    &CFLOAT_Descr,
    &CDOUBLE_Descr,
    &CLONGDOUBLE_Descr,
    &DATETIME_Descr,
    &TIMEDELTA_Descr,
    &OBJECT_Descr,
    &STRING_Descr,
    &UNICODE_Descr,
    &VOID_Descr,
};



/* The interface layer needs to be given the opportunity to provide a wrapper
 for each built-in type descr before it ever gets returned to the interface
 layer.  This should only ever be performed once. */
void _init_builtin_descr_wrappers(struct NpyArray_FunctionDefs *externDefs)
{
    int type;

    /* Set the gettime, setitem methods on each type's array functions. */

        _NpyBool_ArrFuncs.getitem = externDefs-> BOOL_getitem;
    _NpyBool_ArrFuncs.setitem = externDefs-> BOOL_setitem;

    
    _NpyByte_ArrFuncs.getitem = externDefs-> BYTE_getitem;
    _NpyByte_ArrFuncs.setitem = externDefs-> BYTE_setitem;

    
    _NpyUByte_ArrFuncs.getitem = externDefs-> UBYTE_getitem;
    _NpyUByte_ArrFuncs.setitem = externDefs-> UBYTE_setitem;

    
    _NpyShort_ArrFuncs.getitem = externDefs-> SHORT_getitem;
    _NpyShort_ArrFuncs.setitem = externDefs-> SHORT_setitem;

    
    _NpyUShort_ArrFuncs.getitem = externDefs-> USHORT_getitem;
    _NpyUShort_ArrFuncs.setitem = externDefs-> USHORT_setitem;

    
    _NpyInt_ArrFuncs.getitem = externDefs-> INT_getitem;
    _NpyInt_ArrFuncs.setitem = externDefs-> INT_setitem;

    
    _NpyUInt_ArrFuncs.getitem = externDefs-> UINT_getitem;
    _NpyUInt_ArrFuncs.setitem = externDefs-> UINT_setitem;

    
    _NpyLong_ArrFuncs.getitem = externDefs-> LONG_getitem;
    _NpyLong_ArrFuncs.setitem = externDefs-> LONG_setitem;

    
    _NpyULong_ArrFuncs.getitem = externDefs-> ULONG_getitem;
    _NpyULong_ArrFuncs.setitem = externDefs-> ULONG_setitem;

    
    _NpyLongLong_ArrFuncs.getitem = externDefs-> LONGLONG_getitem;
    _NpyLongLong_ArrFuncs.setitem = externDefs-> LONGLONG_setitem;

    
    _NpyULongLong_ArrFuncs.getitem = externDefs-> ULONGLONG_getitem;
    _NpyULongLong_ArrFuncs.setitem = externDefs-> ULONGLONG_setitem;

    
    _NpyFloat_ArrFuncs.getitem = externDefs-> FLOAT_getitem;
    _NpyFloat_ArrFuncs.setitem = externDefs-> FLOAT_setitem;

    
    _NpyDouble_ArrFuncs.getitem = externDefs-> DOUBLE_getitem;
    _NpyDouble_ArrFuncs.setitem = externDefs-> DOUBLE_setitem;

    
    _NpyLongDouble_ArrFuncs.getitem = externDefs-> LONGDOUBLE_getitem;
    _NpyLongDouble_ArrFuncs.setitem = externDefs-> LONGDOUBLE_setitem;

    
    _NpyCFloat_ArrFuncs.getitem = externDefs-> CFLOAT_getitem;
    _NpyCFloat_ArrFuncs.setitem = externDefs-> CFLOAT_setitem;

    
    _NpyCDouble_ArrFuncs.getitem = externDefs-> CDOUBLE_getitem;
    _NpyCDouble_ArrFuncs.setitem = externDefs-> CDOUBLE_setitem;

    
    _NpyCLongDouble_ArrFuncs.getitem = externDefs-> CLONGDOUBLE_getitem;
    _NpyCLongDouble_ArrFuncs.setitem = externDefs-> CLONGDOUBLE_setitem;

    
    _NpyObject_ArrFuncs.getitem = externDefs-> OBJECT_getitem;
    _NpyObject_ArrFuncs.setitem = externDefs-> OBJECT_setitem;

    
    _NpyString_ArrFuncs.getitem = externDefs-> STRING_getitem;
    _NpyString_ArrFuncs.setitem = externDefs-> STRING_setitem;

    
    _NpyUnicode_ArrFuncs.getitem = externDefs-> UNICODE_getitem;
    _NpyUnicode_ArrFuncs.setitem = externDefs-> UNICODE_setitem;

    
    _NpyVoid_ArrFuncs.getitem = externDefs-> VOID_getitem;
    _NpyVoid_ArrFuncs.setitem = externDefs-> VOID_setitem;

    
    _NpyDatetime_ArrFuncs.getitem = externDefs-> DATETIME_getitem;
    _NpyDatetime_ArrFuncs.setitem = externDefs-> DATETIME_setitem;

    
    _NpyTimedelta_ArrFuncs.getitem = externDefs-> TIMEDELTA_getitem;
    _NpyTimedelta_ArrFuncs.setitem = externDefs-> TIMEDELTA_setitem;

    


    /* All of the functions for dealing with objects are specified externally. */
        _NpyBool_ArrFuncs.cast[NPY_OBJECT] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_obj[NPY_BOOL];
    _NpyBool_ArrFuncs.cast[NPY_STRING] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_string[NPY_BOOL];
    _NpyBool_ArrFuncs.cast[NPY_UNICODE] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_unicode[NPY_BOOL];
    _NpyBool_ArrFuncs.cast[NPY_VOID] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_void[NPY_BOOL];
    
    _NpyByte_ArrFuncs.cast[NPY_OBJECT] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_obj[NPY_BYTE];
    _NpyByte_ArrFuncs.cast[NPY_STRING] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_string[NPY_BYTE];
    _NpyByte_ArrFuncs.cast[NPY_UNICODE] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_unicode[NPY_BYTE];
    _NpyByte_ArrFuncs.cast[NPY_VOID] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_void[NPY_BYTE];
    
    _NpyUByte_ArrFuncs.cast[NPY_OBJECT] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_obj[NPY_UBYTE];
    _NpyUByte_ArrFuncs.cast[NPY_STRING] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_string[NPY_UBYTE];
    _NpyUByte_ArrFuncs.cast[NPY_UNICODE] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_unicode[NPY_UBYTE];
    _NpyUByte_ArrFuncs.cast[NPY_VOID] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_void[NPY_UBYTE];
    
    _NpyShort_ArrFuncs.cast[NPY_OBJECT] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_obj[NPY_SHORT];
    _NpyShort_ArrFuncs.cast[NPY_STRING] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_string[NPY_SHORT];
    _NpyShort_ArrFuncs.cast[NPY_UNICODE] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_unicode[NPY_SHORT];
    _NpyShort_ArrFuncs.cast[NPY_VOID] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_void[NPY_SHORT];
    
    _NpyUShort_ArrFuncs.cast[NPY_OBJECT] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_obj[NPY_USHORT];
    _NpyUShort_ArrFuncs.cast[NPY_STRING] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_string[NPY_USHORT];
    _NpyUShort_ArrFuncs.cast[NPY_UNICODE] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_unicode[NPY_USHORT];
    _NpyUShort_ArrFuncs.cast[NPY_VOID] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_void[NPY_USHORT];
    
    _NpyInt_ArrFuncs.cast[NPY_OBJECT] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_obj[NPY_INT];
    _NpyInt_ArrFuncs.cast[NPY_STRING] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_string[NPY_INT];
    _NpyInt_ArrFuncs.cast[NPY_UNICODE] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_unicode[NPY_INT];
    _NpyInt_ArrFuncs.cast[NPY_VOID] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_void[NPY_INT];
    
    _NpyUInt_ArrFuncs.cast[NPY_OBJECT] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_obj[NPY_UINT];
    _NpyUInt_ArrFuncs.cast[NPY_STRING] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_string[NPY_UINT];
    _NpyUInt_ArrFuncs.cast[NPY_UNICODE] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_unicode[NPY_UINT];
    _NpyUInt_ArrFuncs.cast[NPY_VOID] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_void[NPY_UINT];
    
    _NpyLong_ArrFuncs.cast[NPY_OBJECT] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_obj[NPY_LONG];
    _NpyLong_ArrFuncs.cast[NPY_STRING] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_string[NPY_LONG];
    _NpyLong_ArrFuncs.cast[NPY_UNICODE] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_unicode[NPY_LONG];
    _NpyLong_ArrFuncs.cast[NPY_VOID] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_void[NPY_LONG];
    
    _NpyULong_ArrFuncs.cast[NPY_OBJECT] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_obj[NPY_ULONG];
    _NpyULong_ArrFuncs.cast[NPY_STRING] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_string[NPY_ULONG];
    _NpyULong_ArrFuncs.cast[NPY_UNICODE] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_unicode[NPY_ULONG];
    _NpyULong_ArrFuncs.cast[NPY_VOID] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_void[NPY_ULONG];
    
    _NpyLongLong_ArrFuncs.cast[NPY_OBJECT] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_obj[NPY_LONGLONG];
    _NpyLongLong_ArrFuncs.cast[NPY_STRING] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_string[NPY_LONGLONG];
    _NpyLongLong_ArrFuncs.cast[NPY_UNICODE] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_unicode[NPY_LONGLONG];
    _NpyLongLong_ArrFuncs.cast[NPY_VOID] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_void[NPY_LONGLONG];
    
    _NpyULongLong_ArrFuncs.cast[NPY_OBJECT] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_obj[NPY_ULONGLONG];
    _NpyULongLong_ArrFuncs.cast[NPY_STRING] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_string[NPY_ULONGLONG];
    _NpyULongLong_ArrFuncs.cast[NPY_UNICODE] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_unicode[NPY_ULONGLONG];
    _NpyULongLong_ArrFuncs.cast[NPY_VOID] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_void[NPY_ULONGLONG];
    
    _NpyFloat_ArrFuncs.cast[NPY_OBJECT] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_obj[NPY_FLOAT];
    _NpyFloat_ArrFuncs.cast[NPY_STRING] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_string[NPY_FLOAT];
    _NpyFloat_ArrFuncs.cast[NPY_UNICODE] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_unicode[NPY_FLOAT];
    _NpyFloat_ArrFuncs.cast[NPY_VOID] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_void[NPY_FLOAT];
    
    _NpyDouble_ArrFuncs.cast[NPY_OBJECT] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_obj[NPY_DOUBLE];
    _NpyDouble_ArrFuncs.cast[NPY_STRING] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_string[NPY_DOUBLE];
    _NpyDouble_ArrFuncs.cast[NPY_UNICODE] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_unicode[NPY_DOUBLE];
    _NpyDouble_ArrFuncs.cast[NPY_VOID] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_void[NPY_DOUBLE];
    
    _NpyLongDouble_ArrFuncs.cast[NPY_OBJECT] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_obj[NPY_LONGDOUBLE];
    _NpyLongDouble_ArrFuncs.cast[NPY_STRING] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_string[NPY_LONGDOUBLE];
    _NpyLongDouble_ArrFuncs.cast[NPY_UNICODE] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_unicode[NPY_LONGDOUBLE];
    _NpyLongDouble_ArrFuncs.cast[NPY_VOID] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_void[NPY_LONGDOUBLE];
    
    _NpyCFloat_ArrFuncs.cast[NPY_OBJECT] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_obj[NPY_CFLOAT];
    _NpyCFloat_ArrFuncs.cast[NPY_STRING] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_string[NPY_CFLOAT];
    _NpyCFloat_ArrFuncs.cast[NPY_UNICODE] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_unicode[NPY_CFLOAT];
    _NpyCFloat_ArrFuncs.cast[NPY_VOID] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_void[NPY_CFLOAT];
    
    _NpyCDouble_ArrFuncs.cast[NPY_OBJECT] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_obj[NPY_CDOUBLE];
    _NpyCDouble_ArrFuncs.cast[NPY_STRING] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_string[NPY_CDOUBLE];
    _NpyCDouble_ArrFuncs.cast[NPY_UNICODE] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_unicode[NPY_CDOUBLE];
    _NpyCDouble_ArrFuncs.cast[NPY_VOID] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_void[NPY_CDOUBLE];
    
    _NpyCLongDouble_ArrFuncs.cast[NPY_OBJECT] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_obj[NPY_CLONGDOUBLE];
    _NpyCLongDouble_ArrFuncs.cast[NPY_STRING] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_string[NPY_CLONGDOUBLE];
    _NpyCLongDouble_ArrFuncs.cast[NPY_UNICODE] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_unicode[NPY_CLONGDOUBLE];
    _NpyCLongDouble_ArrFuncs.cast[NPY_VOID] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_void[NPY_CLONGDOUBLE];
    
    _NpyString_ArrFuncs.cast[NPY_OBJECT] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_obj[NPY_STRING];
    _NpyString_ArrFuncs.cast[NPY_STRING] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_string[NPY_STRING];
    _NpyString_ArrFuncs.cast[NPY_UNICODE] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_unicode[NPY_STRING];
    _NpyString_ArrFuncs.cast[NPY_VOID] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_void[NPY_STRING];
    
    _NpyUnicode_ArrFuncs.cast[NPY_OBJECT] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_obj[NPY_UNICODE];
    _NpyUnicode_ArrFuncs.cast[NPY_STRING] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_string[NPY_UNICODE];
    _NpyUnicode_ArrFuncs.cast[NPY_UNICODE] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_unicode[NPY_UNICODE];
    _NpyUnicode_ArrFuncs.cast[NPY_VOID] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_void[NPY_UNICODE];
    
    _NpyVoid_ArrFuncs.cast[NPY_OBJECT] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_obj[NPY_VOID];
    _NpyVoid_ArrFuncs.cast[NPY_STRING] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_string[NPY_VOID];
    _NpyVoid_ArrFuncs.cast[NPY_UNICODE] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_unicode[NPY_VOID];
    _NpyVoid_ArrFuncs.cast[NPY_VOID] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_void[NPY_VOID];
    
    _NpyDatetime_ArrFuncs.cast[NPY_OBJECT] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_obj[NPY_DATETIME];
    _NpyDatetime_ArrFuncs.cast[NPY_STRING] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_string[NPY_DATETIME];
    _NpyDatetime_ArrFuncs.cast[NPY_UNICODE] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_unicode[NPY_DATETIME];
    _NpyDatetime_ArrFuncs.cast[NPY_VOID] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_void[NPY_DATETIME];
    
    _NpyTimedelta_ArrFuncs.cast[NPY_OBJECT] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_obj[NPY_TIMEDELTA];
    _NpyTimedelta_ArrFuncs.cast[NPY_STRING] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_string[NPY_TIMEDELTA];
    _NpyTimedelta_ArrFuncs.cast[NPY_UNICODE] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_unicode[NPY_TIMEDELTA];
    _NpyTimedelta_ArrFuncs.cast[NPY_VOID] =
        (NpyArray_VectorUnaryFunc *)externDefs->cast_to_void[NPY_TIMEDELTA];
    


    /* Just copy the provided function arrays into the descriptors. */
    memmove(_NpyObject_ArrFuncs.cast, externDefs->cast_from_obj, NPY_NTYPES * sizeof(void *));
    memmove(_NpyString_ArrFuncs.cast, externDefs->cast_from_string, NPY_NTYPES * sizeof(void *));
    memmove(_NpyUnicode_ArrFuncs.cast, externDefs->cast_from_unicode, NPY_NTYPES * sizeof(void *));
    memmove(_NpyVoid_ArrFuncs.cast, externDefs->cast_from_void, NPY_NTYPES * sizeof(void *));

    /* All object methods must be provided by the interface. */
    _NpyObject_ArrFuncs.copyswapn = externDefs->OBJECT_copyswapn;
    _NpyObject_ArrFuncs.copyswap = externDefs->OBJECT_copyswap;
    _NpyObject_ArrFuncs.compare = externDefs->OBJECT_compare;
    _NpyObject_ArrFuncs.argmax = externDefs->OBJECT_argmax;
    _NpyObject_ArrFuncs.dotfunc = externDefs->OBJECT_dotfunc;
    _NpyObject_ArrFuncs.scanfunc = externDefs->OBJECT_scanfunc;
    _NpyObject_ArrFuncs.fromstr = externDefs->OBJECT_fromstr;
    _NpyObject_ArrFuncs.nonzero = externDefs->OBJECT_nonzero;
    _NpyObject_ArrFuncs.fill = externDefs->OBJECT_fill;
    _NpyObject_ArrFuncs.fillwithscalar = externDefs->OBJECT_fillwithscalar;
    _NpyObject_ArrFuncs.scalarkind = externDefs->OBJECT_scalarkind;
    _NpyObject_ArrFuncs.fastclip = externDefs->OBJECT_fastclip;
    _NpyObject_ArrFuncs.fastputmask = externDefs->OBJECT_fastputmask;
    _NpyObject_ArrFuncs.fasttake = externDefs->OBJECT_fasttake;



    for (type=0; type < NPY_NTYPES; type++) {
        assert( NULL == Npy_INTERFACE(_builtin_descrs[type]) ); /* Should only ever be called once. */
        NpyInterface_DescrNewFromType(type, _builtin_descrs[type], &_builtin_descrs[type]->nob_interface);
    }
}



/* Get the NpyArray_Descr structure for a type.
 */
NpyArray_Descr *
NpyArray_DescrFromType(int type)
{
    NpyArray_Descr *ret = NULL;

    if (type < NPY_NTYPES) {
        ret = _builtin_descrs[type];
    }
    else if (type == NPY_NOTYPE) {
        /*
         * This needs to not raise an error so
         * that NpyArray_DescrFromType(NpyArray_NOTYPE)
         * works for backwards-compatible C-API
         */
        return NULL;
    }
    else if ((type == NPY_CHAR) || (type == NPY_CHARLTR)) {
        ret = NpyArray_DescrNew(_builtin_descrs[NPY_STRING]);
        if (ret == NULL) {
            return NULL;
        }
        ret->elsize = 1;
        ret->type = NPY_CHARLTR;
        return ret;
    }
    else if (NpyTypeNum_ISUSERDEF(type)) {
        ret = NpyArray_UserDescrFromTypeNum(type);
    }
    else {
        int num = NPY_NTYPES;
        if (type < _MAX_LETTER) {
            num = (int) _npy_letter_to_num[type];
        }
        if (num >= NPY_NTYPES) {
            ret = NULL;
        }
        else {
            ret = _builtin_descrs[num];
        }
    }
    if (ret == NULL) {
        NpyErr_SetString(NpyExc_ValueError,
                "Invalid data-type for array");
    }
    else {
        _Npy_INCREF(ret);
    }

    /* Make sure dtype metadata is initialized for DATETIME */
    if (NpyTypeNum_ISDATETIME(type)) {
        if (ret->dtinfo == NULL) {
            _init_datetime_descr(ret);
        }
    }

    return ret;
}


#undef _MAX_LETTER


